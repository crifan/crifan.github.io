{"./":{"url":"./","title":"å‰è¨€","keywords":"","body":"é€†å‘è°ƒè¯•åˆ©å™¨ï¼šFrida æœ€æ–°ç‰ˆæœ¬ï¼šv4.3.0 æ›´æ–°æ—¶é—´ï¼š20241122 ç®€ä»‹ ä»‹ç»æ”¯æŒAndroidã€iOSç­‰å¤šä¸ªå¹³å°çš„é€šç”¨é€†å‘å·¥å…·ï¼šFridaã€‚å…ˆæ˜¯Fridaæ¦‚è§ˆï¼ŒåŒ…æ‹¬Fridaçš„ä»£ç å’Œæ¶æ„ï¼Œä»¥åŠç›¸å…³æ–‡æ¡£å’Œæ¡ˆä¾‹å’Œèµ„æ–™ã€‚å†ä»‹ç»å¦‚ä½•åœ¨PCç«¯å’Œç§»åŠ¨ç«¯å³iOSå’Œå®‰å“ç«¯çš„å®‰è£…å’Œå‡çº§Fridaã€‚ç„¶åæ˜¯å¦‚ä½•ä½¿ç”¨Fridaï¼Œå…ˆä»‹ç»Fridaçš„å…¸å‹ä½¿ç”¨é€»è¾‘ï¼Œç„¶åå†å»ä»‹ç»fridaå‘½ä»¤è¡Œå·¥å…·ï¼Œå…¶ä¸­åŒ…æ‹¬é€šç”¨çš„é€»è¾‘ï¼Œæ¯”å¦‚è°ƒè¯•ç›®æ ‡çš„æ–¹å¼ï¼Œä»¥åŠå†™jsè„šæœ¬ï¼›ç„¶åæ˜¯å…¸å‹çš„ä½¿ç”¨æ–¹å¼ï¼Œä»¥åŠæ­¤å¤„iOSé€†å‘æ¶‰åŠåˆ°çš„ObjCçš„å†…å®¹ï¼ŒåŒ…æ‹¬ObjCçš„å‚æ•°å’Œå˜é‡ç±»å‹ï¼›æ¥ç€æ˜¯æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬NativePointerã€‚æ¥ç€æ˜¯é«˜çº§çš„Stalkerã€‚æ¥ç€ä»‹ç»frida-traceï¼Œä»¥åŠfrida-toolså·¥å…·é›†åˆï¼ŒåŒ…æ‹¬frida-psã€frida-lsã€frida-ls-devicesç­‰ï¼›æ¥ç€ä»‹ç»å…¶ä»–ç›¸å…³çš„å†…å®¹ï¼ŒåŒ…æ‹¬frida-serverç­‰ã€‚æ¥ç€æ•´ç†ä¸€äº›Fridaå¼€å‘æœŸé—´çš„ç»éªŒå’Œå¿ƒå¾—ï¼ŒåŒ…æ‹¬hookå‡½æ•°æ–¹é¢çš„ï¼ŒåŒ…æ‹¬fridaå’Œfrida-traceï¼Œfridaä¸­çš„Interceptorã€Stalkerã€å¸¸ç”¨iOSå‡½æ•°ç­‰ã€‚å…¶ä»–è¿˜æœ‰å·¥å…·ç±»çš„å‡½æ•°ã€jsä»¥åŠå…¶ä¸­çš„console.logï¼Œå’Œè‡ªå·±ç¼–è¯‘frida-serverï¼Œå’Œå…¶ä»–å¸¸è§é—®é¢˜å’ŒæŠ¥é”™ã€‚æ¥ç€æ•´ç†åŸºäºFridaçš„å·¥å…·ã€‚ä»¥åŠFridaçš„ä¸€äº›å¸¸è§ç”¨é€”ï¼ŒåŒ…æ‹¬åè°ƒè¯•ã€è¾…åŠ©åæ··æ·†ã€ç»•è¿‡å‚æ•°åŠ å¯†ã€é€†å‘å„ç§appç­‰ã€‚æœ€åè´´å‡ºå‚è€ƒèµ„æ–™ã€‚ æºç +æµè§ˆ+ä¸‹è½½ æœ¬ä¹¦çš„å„ç§æºç ã€åœ¨çº¿æµè§ˆåœ°å€ã€å¤šç§æ ¼å¼æ–‡ä»¶ä¸‹è½½å¦‚ä¸‹ï¼š HonKitæºç  crifan/reverse_debug_frida: é€†å‘è°ƒè¯•åˆ©å™¨ï¼šFrida å¦‚ä½•ä½¿ç”¨æ­¤HonKitæºç å»ç”Ÿæˆå‘å¸ƒä¸ºç”µå­ä¹¦ è¯¦è§ï¼šcrifan/honkit_template: demo how to use crifan honkit template and demo åœ¨çº¿æµè§ˆ é€†å‘è°ƒè¯•åˆ©å™¨ï¼šFrida book.crifan.org é€†å‘è°ƒè¯•åˆ©å™¨ï¼šFrida crifan.github.io ç¦»çº¿ä¸‹è½½é˜…è¯» é€†å‘è°ƒè¯•åˆ©å™¨ï¼šFrida PDF é€†å‘è°ƒè¯•åˆ©å™¨ï¼šFrida ePub é€†å‘è°ƒè¯•åˆ©å™¨ï¼šFrida Mobi ç‰ˆæƒå’Œç”¨é€”è¯´æ˜ æ­¤ç”µå­ä¹¦æ•™ç¨‹çš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚æ— ç‰¹åˆ«è¯´æ˜ï¼Œå‡ä¸ºæœ¬äººåŸåˆ›ã€‚å…¶ä¸­éƒ¨åˆ†å†…å®¹å‚è€ƒè‡ªç½‘ç»œï¼Œå‡å·²å¤‡æ³¨äº†å‡ºå¤„ã€‚å¦‚å‘ç°æœ‰ä¾µæƒï¼Œè¯·é€šè¿‡é‚®ç®±è”ç³»æˆ‘ admin è‰¾ç‰¹ crifan.comï¼Œæˆ‘ä¼šå°½å¿«åˆ é™¤ã€‚è°¢è°¢åˆä½œã€‚ å„ç§æŠ€æœ¯ç±»æ•™ç¨‹ï¼Œä»…ä½œä¸ºå­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚è¯·å‹¿ç”¨äºä»»ä½•éæ³•ç”¨é€”ã€‚å¦‚æœ‰éæ³•ç”¨é€”ï¼Œå‡ä¸æœ¬äººæ— å…³ã€‚ é¸£è°¢ æ„Ÿè°¢æˆ‘çš„è€å©†é™ˆé›ªçš„åŒ…å®¹ç†è§£å’Œæ‚‰å¿ƒç…§æ–™ï¼Œæ‰ä½¿å¾—æˆ‘crifanæœ‰æ›´å¤šç²¾åŠ›å»ä¸“æ³¨æŠ€æœ¯ä¸“ç ”å’Œæ•´ç†å½’çº³å‡ºè¿™äº›ç”µå­ä¹¦å’ŒæŠ€æœ¯æ•™ç¨‹ï¼Œç‰¹æ­¤é¸£è°¢ã€‚ å…¶ä»– ä½œè€…çš„å…¶ä»–ç”µå­ä¹¦ æœ¬äººcrifanè¿˜å†™äº†å…¶ä»–150+æœ¬ç”µå­ä¹¦æ•™ç¨‹ï¼Œæ„Ÿå…´è¶£å¯ç§»æ­¥è‡³ï¼š crifan/crifan_ebook_readme: Crifançš„ç”µå­ä¹¦çš„ä½¿ç”¨è¯´æ˜ å…³äºä½œè€… å…³äºä½œè€…æ›´å¤šä»‹ç»ï¼Œè¯¦è§ï¼š å…³äºCrifanLiæèŒ‚ â€“ åœ¨è·¯ä¸Š crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-11-22 16:46:20 "},"frida_overview/":{"url":"frida_overview/","title":"Fridaæ¦‚è§ˆ","keywords":"","body":"Fridaæ¦‚è§ˆ Frida æ¦‚è¿° ä¸€æ¬¾åŸºäºpython + javascriptçš„hookæ¡†æ¶ Androidã€iOSçš„appé€†å‘ç­‰é¢†åŸŸä¸­ï¼Œæœ€å¸¸ç”¨çš„å·¥å…·ä¹‹ä¸€ A world-class Dynamic instrumentation toolkit for developers, reverse-engineers, and security researchers Inject JavaScript to observe and reprogram running programs on Windows, macOS, GNU/Linux, iOS, watchOS, tvOS, Android, FreeBSD, and QNX ä¸»è¦ç”¨æ³•ï¼šiOSé€†å‘æœŸé—´ï¼Œç”¨frida+jsè„šæœ¬å’Œfrida-traceã€Fridaçš„Stalkerç­‰å·¥å…·ï¼Œå»åŠ¨æ€è°ƒè¯•ä»£ç é€»è¾‘ æ ¸å¿ƒåŸç† ä¸»è¦ä½¿ç”¨åŠ¨æ€äºŒè¿›åˆ¶æ’æ¡©(DBI)æŠ€æœ¯ å°†å¤–éƒ¨ä»£ç æ³¨å…¥åˆ°ç°æœ‰çš„æ­£åœ¨è¿è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œä»è€Œè®©å®ƒæ‰§è¡Œé¢å¤–æ“ä½œ æ”¯æŒå“ªäº›é¢å¤–æ“ä½œ è®¿é—®è¿›ç¨‹å†…å­˜ åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶è¦†ç›–å‡½æ•° ä»å¯¼å…¥çš„ç±»è°ƒç”¨å‡½æ•° åœ¨å †ä¸ŠæŸ¥æ‰¾å¯¹è±¡å®ä¾‹å¹¶ä½¿ç”¨ Hookã€è·Ÿè¸ªå’Œæ‹¦æˆªå‡½æ•°ç­‰ æ³¨ï¼šè°ƒè¯•å™¨ä¹Ÿèƒ½å®Œæˆç›¸åº”å·¥ä½œï¼Œä¸è¿‡éå¸¸éº»çƒ¦ï¼Œæ¯”å¦‚å„ç§åè°ƒè¯• åŠŸèƒ½å’Œç‰¹ç‚¹ Scriptable Inject your own scripts into black box processes. Hook any function, spy on crypto APIs or trace private application code, no source code needed. Edit, hit save, and instantly see the results. All without compilation steps or program restarts. Portable æ”¯æŒå¤šç§è¿è¡Œå¹³å°/ç³»ç»Ÿï¼šAndroid/iOS/Linux/Win/macOSç­‰ Works on Windows, macOS, GNU/Linux, iOS, Android, and QNX. Install the Node.js bindings from npm, grab a Python package from PyPI, or use Frida through its Swift bindings, .NET bindings, Qt/Qml bindings, or C API. Free Frida is and will always be free software (free as in freedom). We want to empower the next generation of developer tools, and help other free software developers achieve interoperability through reverse engineering. Battle-tested We are proud that NowSecure is using Frida to do fast, deep analysis of mobile apps at scale. Frida has a comprehensive test-suite and has gone through years of rigorous testing across a broad range of use-cases. ä¸»é¡µ å®˜ç½‘ https://frida.re/ æ–‡æ¡£ https://frida.re/docs/home/ Github https://github.com/frida/frida ä½œè€…ï¼šoleavr=Ole AndrÃ© Vadla RavnÃ¥s Github https://github.com/oleavr æ‰€å±å…¬å¸ NowSecure https://www.nowsecure.com/ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-07-13 14:53:50 "},"frida_overview/code_arch.html":{"url":"frida_overview/code_arch.html","title":"ä»£ç å’Œæ¶æ„","keywords":"","body":"ä»£ç å’Œæ¶æ„ Fridaçš„æ¶æ„ æ€»ä½“æ¶æ„ client=å®¢æˆ·ç«¯ fridaçš„å„ç§å·¥å…· fridaï¼šfridaä¸»ä½“å·¥å…·æœ¬èº«ï¼Œç”¨çš„æœ€å¤šã€‚ frida-toolsï¼šï¼ˆWin/Macç­‰ï¼‰PCç«¯å¸¸ç”¨åˆ°çš„ï¼Œé™¤äº†fridaä¹‹å¤–çš„ï¼Œfrida-traceã€frida-psã€frida-lsç­‰å‘½ä»¤è¡Œå·¥å…· frida-traceï¼šæŒ‰é¡ºåºå’Œå¸¦ç¼©è¿›çš„æ‰“å°æ‰€æœ‰å‡½æ•°è°ƒç”¨å †æ ˆï¼Œæå¤§åœ°æ–¹ä¾¿è°ƒè¯•å†…éƒ¨é€»è¾‘ server=æœåŠ¡ç«¯ frida-server åŸç†å›¾=æ¶æ„å›¾ å…¶ä¸­å¯è§å¾ˆå¤šå…³é”®çš„ç‚¹=fridaä¸­çš„å­é¡¹ frida-code frida-node frida-agent frida-gum GumJS å¯¹åº”ç€æºç ä¸­çš„å„ä¸ªå­é¡¹ç›®ï¼šè¯¦è§ä¸‹é¢å†…å®¹ã€‚ Fridaæºç  Fridaæºç  æ€»å…¥å£: https://github.com/frida/frida core: frida-core Frida core library intended for static linking into bindings gum: frida-gum Cross-platform instrumentation and introspection library written in C This library is consumed by frida-core through its JavaScript bindings, GumJS. tools: frida-tools Frida CLI tools bindings python -> frida-python Node.js -> frida-node Swift -> frida-swift .NET -> frida-clr GO -> frida-go Rust -> frida-rust QT/qml -> frida-qml å…¶ä»– Fridaæ”¯æŒå¤šä¸ªç§»åŠ¨ç«¯çš„äº’æ“ä½œï¼Œæ‰€ä»¥æœ‰åˆ†åˆ«çš„å†…éƒ¨çš„äº’æ“ä½œç›¸å…³çš„å†…å®¹ iOSç«¯çš„ï¼šfrida-objc-bridge Objective-C runtime interop from Frida Androidç«¯çš„ï¼šfrida-java-bridge Java runtime interop from Frida Capstone è®°å¾—æ˜¯ï¼šFridaå†…éƒ¨ç”¨åˆ°äº†Capstoneï¼Œä½†æ˜¯æœ‰äº›é¢å¤–çš„å†…å®¹è¦å¾®è°ƒï¼Œæ‰€ä»¥å•ç‹¬forkäº†Capstoneæºç ï¼Œè‡ªå·±åŒæ­¥æ›´æ–°äº† crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 23:07:22 "},"frida_overview/doc_refer/":{"url":"frida_overview/doc_refer/","title":"æ–‡æ¡£å’Œèµ„æ–™","keywords":"","body":"æ–‡æ¡£å’Œèµ„æ–™ å®˜ç½‘æ–‡æ¡£å…¥å£: Frida Docs å…¥é—¨æŒ‡å—=Getting Started å¿«é€Ÿå…¥æ‰‹: Quick-start guide å®‰è£…: Installation æ“ä½œæ¨¡å¼: Modes of Operation Gadget: Gadget å†…éƒ¨åŸç†: Hacking Stalker: Stalker æ¼”è®²æ–‡æ¡£èµ„æ–™ï¼šPresentations æ•™ç¨‹=Tutorials é€šç”¨ å‡½æ•°: Functions æ¶ˆæ¯: Messages ç§»åŠ¨ç«¯ iOS Android æ¡ˆä¾‹=Examples PCç«¯ Windows macOS Linux ç§»åŠ¨ç«¯ iOS Android å…¶ä»– JavaScript å·¥å…·=Tools fridaå‘½ä»¤è¡Œå·¥å…·: Frida CLI frida-ps frida-trace frida-discover frida-ls-devices frida-kill gum-graft APIæ–‡æ¡£=API Reference JavaScript API C API Swift API Go API å…¶ä»–ç»†èŠ‚=Miscellaneous æœ€ä½³å®è·µ: Best Practices æ’é”™: Troubleshooting è‡ªå·±ç¼–è¯‘Frida=å‚ä¸Fridaå¼€å‘: Building å ç”¨ç³»ç»Ÿç©ºé—´: Footprint èµ·æºå’Œå‘å±•=Meta GSoC Ideas 2015 GSoD Ideas 2023 History å…¶ä»– æ•™ç¨‹ Frida basics - Frida HandBook (learnfrida.info) Frida HandBook crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 22:55:46 "},"install_upgrade/":{"url":"install_upgrade/","title":"å®‰è£…å’Œå‡çº§","keywords":"","body":"å®‰è£…å’Œå‡çº§ æ­¤å¤„ä»‹ç»Fridaçš„å®‰è£…å’Œå‡çº§ï¼Œå³Fridaçš„è°ƒè¯•ç¯å¢ƒåˆå§‹åŒ–ã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:24:57 "},"install_upgrade/install_frida/":{"url":"install_upgrade/install_frida/","title":"å®‰è£…Frida","keywords":"","body":"å®‰è£…Frida åœ¨èƒ½ä½¿ç”¨Fridaä¹‹å‰ï¼Œå…ˆè¦å»å®‰è£…Frida=åˆå§‹åŒ–Fridaè°ƒè¯•ç¯å¢ƒï¼š æ¦‚è¿° ç”µè„‘ç«¯å®‰è£…fridaï¼ˆå’Œfrida-toolsï¼‰ï¼Œç§»åŠ¨ç«¯å®‰è£…fridaï¼ˆçš„serverï¼‰ Macä¸­é€†å‘iOS Macï¼šå®‰è£…fridaï¼ˆpip3 install fridaï¼‰å’Œå®‰è£…frida-toolsï¼ˆpip3 install frida-toolsï¼‰ iOSï¼ˆiPhoneï¼‰ï¼šåŒ…ç®¡ç†å™¨ï¼ˆSileo/Cydiaï¼‰ä¸­ï¼ˆé€šè¿‡è½¯ä»¶æºï¼šhttps://build.frida.reï¼‰å®‰è£…fridaçš„æ’ä»¶ Macä¸­é€†å‘Android Macï¼šå®‰è£…fridaï¼ˆpip3 install fridaï¼‰å’Œå®‰è£…frida-toolsï¼ˆpip3 install frida-toolsï¼‰ Androidï¼šMagiskä¸­å®‰è£…MagiskFridaæ’ä»¶ æ³¨ï¼šFridaå®˜ç½‘çš„Androidç‰ˆfrida-serveræœ‰é—®é¢˜ï¼Œæ‰€ä»¥æ¢è£…ç¬¬ä¸‰æ–¹å¯ç”¨ç‰ˆæœ¬ åç»­è¯¦ç»†è§£é‡Šã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:37:06 "},"install_upgrade/install_frida/pc/":{"url":"install_upgrade/install_frida/pc/","title":"ç”µè„‘ç«¯","keywords":"","body":"ç”µè„‘ç«¯ æ­¤å¤„ä»‹ç»ï¼Œç”µè„‘ç«¯å®‰è£…Fridaçš„ç›¸å…³å†…å®¹ã€‚ æ ¸å¿ƒæ€è·¯ ç»™ç”µè„‘ç«¯å®‰è£…fridaå’Œç›¸å…³çš„å·¥å…· fridaçš„å‘½ä»¤è¡Œå·¥å…·ï¼šfrida fridaçš„ç›¸å…³å·¥å…·ï¼šfrida-tools ä¸¾ä¾‹ Mac å®‰è£…frida pip3 install frida å®‰è£…frida-tools pip3 install frida-tools crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:28:10 "},"install_upgrade/install_frida/pc/mac.html":{"url":"install_upgrade/install_frida/pc/mac.html","title":"Mac","keywords":"","body":"Mac æ­¤å¤„ä»‹ç»ï¼Œç”µè„‘ç«¯Macä¸­ï¼Œå®‰è£…Fridaçš„è¿‡ç¨‹ï¼š å®‰è£… å¿…é€‰ å®‰è£…frida å®‰è£…frida => ä½¿å¾—æœ‰fridaå‘½ä»¤è¡Œå·¥å…·å¯ç”¨pip3 install frida å®‰è£…åæŸ¥çœ‹ç‰ˆæœ¬pip show frida å®‰è£…frida-tools å®‰è£…frida-tools => ä½¿å¾—æœ‰frida-traceã€frida-psã€frida-lsç­‰å‘½ä»¤è¡Œå·¥å…·å¯ç”¨pip3 install frida-tools å®‰è£…åæŸ¥çœ‹ç‰ˆæœ¬pip show frida-tools é¢å¤–è¯´æ˜ å¦‚æœå‰é¢æ²¡æœ‰å…ˆå•ç‹¬å®‰è£…fridaï¼Œåˆ™å®‰è£…frida-toolsæ—¶ä¼šè‡ªåŠ¨å®‰è£…æ‰€ä¾èµ–çš„frida å¯é€‰ å®‰è£…Fridaçš„gadget å®‰è£…Fridaçš„gadget => ä½¿å¾—åç»­ä½¿ç”¨frida-ios-dumpæ—¶è€Œä¸æŠ¥é”™need Gadget to attach on jailed iOS ä¸‹è½½gadgetåº“æ–‡ä»¶ ä»Fridaçš„Githubçš„releaseé¡µé¢ä¸­ï¼Œä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„frida-gadgetçš„dylib ä¸¾ä¾‹ https://github.com/frida/frida/releases/download/16.0.8/frida-gadget-16.0.8-ios-universal.dylib.gz è§£å‹å¾—åˆ°ï¼šfrida-gadget-16.0.8-ios-universal.dylib æ‹·è´åˆ°å¯¹åº”ä½ç½®ï¼š~/.cache/frida/gadget-ios.dylib ä¸¾ä¾‹cp frida-gadget-16.0.8-ios-universal.dylib /Users/crifan/.cache/frida/gadget-ios.dylib å®‰è£…ï¼šFridaçš„Node.jsçš„bindings å®‰è£…ï¼šFridaçš„Node.jsçš„bindings è¯´æ˜ï¼š é»˜è®¤ä¸ç”¨å®‰è£… éœ€è¦ç”¨åˆ°æ—¶ï¼Œå†å»å®‰è£…å³å¯ å®‰è£…å‘½ä»¤npm install frida å®‰è£…å å®‰è£…fridaåï¼Œå¯ä»¥æŸ¥çœ‹å’Œç¡®è®¤ä½ç½®å’Œç‰ˆæœ¬ï¼š ä¸¾ä¾‹ï¼š âœ ~ which frida /opt/homebrew/bin/frida âœ ~ frida --version 16.4.5 crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:42:03 "},"install_upgrade/install_frida/mobile/":{"url":"install_upgrade/install_frida/mobile/","title":"ç§»åŠ¨ç«¯","keywords":"","body":"ç§»åŠ¨ç«¯ æ­¤å¤„ä»‹ç»ï¼Œç§»åŠ¨ç«¯ä¸­å¦‚ä½•å®‰è£…Firdaï¼š æ ¸å¿ƒæ€è·¯ ç»™ç§»åŠ¨ç«¯å®‰è£…ä¸€ä¸ªfridaçš„serverï¼ˆfrida-serverï¼‰ ä¸¾ä¾‹ iOSï¼ˆiPhoneï¼‰ åŒ…ç®¡ç†å™¨ï¼ˆSileo/Cydiaï¼‰ä¸­ï¼ˆé€šè¿‡è½¯ä»¶æºï¼šhttps://build.frida.reï¼‰å®‰è£…fridaçš„æ’ä»¶ Android Magiskä¸­å®‰è£…MagiskFridaæ’ä»¶ è¯´æ˜ Fridaå®˜ç½‘çš„Androidç‰ˆfrida-serveræœ‰é—®é¢˜ï¼Œæ‰€ä»¥æ¢è£…ç¬¬ä¸‰æ–¹å¯ç”¨ç‰ˆæœ¬ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:37:33 "},"install_upgrade/install_frida/mobile/ios.html":{"url":"install_upgrade/install_frida/mobile/ios.html","title":"iOS","keywords":"","body":"iOS æ­¤å¤„ä»‹ç»ï¼Œç§»åŠ¨ç«¯çš„iOSï¼ˆiPhoneï¼‰ä¸­ï¼Œå¦‚ä½•å®‰è£…Fridaï¼ˆçš„serverï¼‰ï¼š å‰æ iPhoneå·²è¶Šç‹± å®‰è£…æ­¥éª¤ ç”¨Sileo/Cydiaï¼Œæ·»åŠ è½¯ä»¶æºï¼šhttps://build.frida.reï¼Œæœç´¢å¹¶å®‰è£…fridaï¼Œå³å¯ Sileo Cydia å®‰è£…å ç¡®ä¿æœåŠ¡ç«¯æ­£åœ¨æ­£å¸¸è¿è¡Œ ä»¥åŠç¡®ä¿iPhoneç«¯çš„frida-serverçš„ç¡®æ­£åœ¨è¿è¡Œï¼Œæ­£å¸¸è¿è¡Œä¸­ï¼š iPhone8-150:~ root# ps -A | grep frida 2150 ?? 0:00.02 /usr/sbin/frida-server 2194 ttys000 0:00.00 grep frida fridaçš„ä½ç½®å’Œç‰ˆæœ¬ å®‰è£…fridaåï¼Œå¯ä»¥æŸ¥çœ‹iPhoneä¸­çš„fridaçš„ä½ç½®å’Œç‰ˆæœ¬ï¼š iPhone8-150:~ root# frida-server --version 16.0.10 iPhone8-150:~ root# which frida-server /usr/sbin/frida-server iPhone8-150:~ root# ls /usr/sbin/frida-server /usr/sbin/frida-server* fridaæ’ä»¶è¯¦æƒ… fridaæ’ä»¶ è¯¦æƒ…é¡µ Sileo Cydia å·²å®‰è£…çš„æ–‡ä»¶ åˆ—è¡¨ /Library/LaunchDaemons/re.frida.server.plist /usr/lib/frida/frida-agent.dylib /usr/sbin/frida-server å›¾ï¼š Sileo Cydia crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:16:20 "},"install_upgrade/install_frida/mobile/android.html":{"url":"install_upgrade/install_frida/mobile/android.html","title":"Android","keywords":"","body":"Android æ­¤å¤„ä»‹ç»ï¼Œç§»åŠ¨ç«¯çš„Androidå®‰å“ä¸­ï¼Œå¦‚ä½•å®‰è£…Fridaï¼ˆçš„serverï¼‰ã€‚ å‰æ å®‰å“æ‰‹æœºå·²root å®‰è£…æ­¥éª¤ æ¦‚è¿° å®‰è£…Magiskæ’ä»¶ï¼šMagiskFrida è¯¦è§£ å®‰å“æ‰‹æœºä¸­å®‰è£…frida-server èƒŒæ™¯ ç”±äºä¹‹å‰æ‰‹åŠ¨ä»ä¸‹è½½frida-serverå¹¶æ”¾åˆ°å®‰å“æ‰‹æœºPixel3ä¸­ï¼Œç»“æœåç»­ä¼šæŠ¥é”™Failed to enumerate processes connection closedï¼Œè€Œæ— æ³•ä½¿ç”¨ æœ€åè§£å†³åŠæ³•æ˜¯ï¼šå®‰è£…Magiskçš„æ’ä»¶ï¼š ViRb3/magisk-frida: ğŸ” Run frida-server on boot with Magisk, always up-to-date å…·ä½“æ­¥éª¤ ä¸‹è½½åˆ°æ­¤å¤„æœ€æ–°ç‰ˆçš„ï¼šMagiskFridaçš„zipåŒ… https://github.com/ViRb3/magisk-frida/releases/download/16.1.3-1/MagiskFrida-16.1.3-1.zip å¾—åˆ°ï¼šMagiskFrida-16.1.3-1.zip ï¼ˆç”¨adb pushï¼‰ä¼ è¾“åˆ°å®‰å“æ‰‹æœºä¸­ï¼ˆçš„ä¸‹è½½ç›®å½•ï¼‰ ç„¶åå»ï¼š Magisk->æ¨¡å—->ä»æœ¬åœ°å®‰è£…->æ‰¾åˆ°å¹¶ç‚¹å‡»MagiskFrida-16.1.3-1.zip->å¼€å§‹è‡ªåŠ¨å®‰è£…->é‡å¯ é‡å¯å®‰å“æ‰‹æœºåï¼Œéƒ½å¯ä»¥çœ‹åˆ°Magiskä¸­çš„æ’ä»¶ï¼šMagiskFrida å®‰è£…å ç¡®ä¿frida-serveræ­£å¸¸è¿è¡Œ ï¼ˆä»¥åï¼‰æ¯æ¬¡é‡å¯å®‰å“æ‰‹æœºåï¼Œéƒ½ä¼šè‡ªåŠ¨è¿è¡Œfrida-server blueline:/ # ps -A | grep frida root 4408 1321 10877092 3696 do_sys_poll 0 S frida-server åç»­å³å¯æ­£å¸¸ä½¿ç”¨Fridaã€‚ Macä¸­ç”¨ç¡®è®¤fridaå·¥å…·MagiskFridaæ˜¯å¦å¯ç”¨ æ­¤å¤„çš„MagiskFridaï¼Œä¹Ÿå¹¶ä¸æ˜¯å¾ˆå®Œç¾ï¼Œä½†æ˜¯ä¹ŸåŸºæœ¬å¤Ÿç”¨ã€‚ å…·ä½“ç»†èŠ‚æ˜¯ï¼š å¯ç”¨çš„ frida-psfrida-ps -U frida-ps -Uai fridafrida -U -F com.example.displaydemo frida-tracefrida-trace -U -F com.example.displaydemo -i open ä¸å¯ç”¨ frida-lsâœ frida frida-ls -U Failed to retrieve listing: Error: Invalid mode: 0x0 at I (agent.ts:274) at L (agent.ts:274) at ls (agent.ts:274) at apply (native) at (frida/runtime/message-dispatcher.js:13) at c (frida/runtime/message-dispatcher.js:23) æš‚æ—¶æ— æ³•è§£å†³ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:23:28 "},"install_upgrade/upgrade_frida.html":{"url":"install_upgrade/upgrade_frida.html","title":"å‡çº§Frida","keywords":"","body":"å‡çº§Frida ä»€ä¹ˆæ—¶å€™æ‰è¦å‡çº§Fridaç‰ˆæœ¬ï¼Ÿ å½“é‡åˆ°å¦‚ä¸‹åœºæ™¯æ—¶ï¼Œï¼ˆå¯èƒ½ï¼‰éœ€è¦å‡çº§Fridaï¼š å½“ï¼ˆä¸¤ç«¯çš„ï¼‰Fridaç‰ˆæœ¬ä¸åŒ¹é…æ—¶ ï¼ˆiPhoneç­‰ï¼‰ç§»åŠ¨ç«¯ä¸­çš„Fridaç‰ˆæœ¬ æŸ¥çœ‹ç°æœ‰ç‰ˆæœ¬frida-server --version ï¼ˆMacç­‰ï¼‰PCç«¯çš„Fridaçš„ç‰ˆæœ¬ æŸ¥çœ‹ç°æœ‰ç‰ˆæœ¬frida --version Fridaæœ‰æ–°ç‰ˆå¯ç”¨ï¼Œæƒ³è¦å‡çº§åˆ°æœ€æ–°ç‰ˆ ä¸¾ä¾‹ Sileoä¸­æç¤ºFridaæœ‰æ–°ç‰ˆæœ¬16.0.11 Cydiaä¸­æç¤ºæœ‰æ–°ç‰ˆæœ¬Frida å¦‚ä½•å‡çº§Fridaç‰ˆæœ¬ï¼Ÿ å’Œå®‰è£…Fridaç±»ä¼¼ï¼Œä¹Ÿæ˜¯åˆ†2éƒ¨åˆ†ï¼š PCç«¯ Mac ç”¨pipå‡çº§Fridapip install --upgrade frida å¦‚æœéœ€è¦ï¼Œä¹Ÿå»åŒæ—¶å‡çº§frida-toolspip install --upgrade frida-tools ç§»åŠ¨ç«¯ Android é‡å¤ä¹‹å‰ å®‰è£…Magiskæ’ä»¶ï¼šMagiskFrida çš„æ­¥éª¤ï¼Œåªæ˜¯ä¸‹è½½æ—¶ï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„MagiskFridaçš„zipåŒ…å³å¯ iOS(iPhone) ç”¨ï¼ˆCydia/Sileoç­‰ï¼‰åŒ…ç®¡ç†å™¨ï¼Œå‡çº§Fridaåˆ°æœ€æ–°ç‰ˆ å¦‚ä½•å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„Fridaï¼Ÿ TODOï¼šæ‰¾ä¹‹å‰å¦‚ä½•æŒ‡å®šfridaç‰ˆæœ¬ï¼Œå½“ç”¨pipå®‰è£…æ—¶ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:09:40 "},"use_frida/":{"url":"use_frida/","title":"ä½¿ç”¨Frida","keywords":"","body":"ä½¿ç”¨Frida crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-22 22:08:11 "},"use_frida/typical_logic/":{"url":"use_frida/typical_logic/","title":"Fridaå…¸å‹ä½¿ç”¨é€»è¾‘","keywords":"","body":"Fridaå…¸å‹ä½¿ç”¨é€»è¾‘ å…ˆææ‡‚å¤§çš„æ¦‚å¿µ ä»é€»è¾‘æ¦‚å¿µè§’åº¦åˆ† æ ¸å¿ƒå·¥å…·ï¼šfridaå‘½ä»¤è¡Œ è¾…åŠ©å·¥å…·ï¼šfrida-tools åŒ…æ‹¬frida-traceã€frida-psã€frida-lsç­‰å·¥å…· ä»ä½¿ç”¨è§’åº¦åˆ† æœ€å¸¸ç”¨ï¼šfridaå‘½ä»¤è¡Œ åˆ†æè°ƒè¯•é€»è¾‘çš„ä¸»åŠ›å·¥å…· ç»å¸¸ç”¨ï¼šfrida-trace åˆ†æå‡½æ•°è°ƒç”¨å †æ ˆå…³ç³» å¶å°”ç”¨ï¼šfrida-toolsï¼ˆåŒ…æ‹¬frida-psã€frida-lsç­‰ï¼‰ å…¶ä»–è¾…åŠ©ç”¨é€”ï¼Œæ¯”å¦‚æŸ¥çœ‹è¿›ç¨‹PIDç­‰ å»hookè°ƒè¯•iPhoneä¸­çš„appæˆ–äºŒè¿›åˆ¶ = Fridaå…¸å‹ä½¿ç”¨é€»è¾‘ å‡†å¤‡å·¥ä½œ å…ˆè¦ææ‡‚å½“å‰è¿æ¥äº†å“ªäº›iPhoneè®¾å¤‡ï¼šfrida-ls-deviecs å†å»ææ‡‚è¦å»hookçš„ç›®æ ‡ï¼ˆappæˆ–äºŒè¿›åˆ¶ï¼‰ï¼šfrida-ps ï¼ˆæˆ–sshè¿æ¥çš„iPhoneä¸­çš„psï¼‰ è¾…åŠ©ï¼šæŸ¥çœ‹iPhoneä¸­æœ‰å“ªäº›ç›¸å…³æ–‡ä»¶ï¼šfrida-ls çœŸæ­£å»hookè°ƒè¯• å‰æœŸç”¨=ç»å¸¸ç”¨ï¼šfrida-trace -ã€‹è°ƒè¯•ï¼ˆappé¡µé¢æ“ä½œè¿‡ç¨‹ä¸­éƒ½ï¼‰è°ƒç”¨äº†å“ªäº›ObjCçš„ï¼ˆç±»å’Œï¼‰å‡½æ•° åæœŸç”¨=æœ€å¸¸ç”¨ï¼šfrida -ã€‹ å†™jså»è°ƒè¯•å…·ä½“çš„ObjCçš„å‡½æ•° å…·ä½“å¹²ä»€ä¹ˆ æŸ¥çœ‹ ä¼ å…¥çš„å‚æ•°çš„ç±»å‹å’Œå€¼ å‡½æ•°è°ƒç”¨å †æ ˆ å¾®è°ƒ=æ”¹åŠ¨ ï¼ˆä¸´æ—¶ï¼‰ä¿®æ”¹ä¼ å…¥å‚æ•°çš„å€¼-ã€‹ç ”ç©¶ç¨‹åºé€»è¾‘å˜åŒ– ï¼ˆä¸´æ—¶ï¼‰ä¿®æ”¹è¿”å›å€¼-ã€‹ç ”ç©¶ç¨‹åºé€»è¾‘å˜åŒ– å¸¸ç”¨åˆ°çš„å†…éƒ¨åŠŸèƒ½ ä¸»è¦æ˜¯ï¼šInterceptorï¼ˆçš„Interceptor.attachï¼‰-ã€‹ å»æ‹¦æˆª=è§¦å‘=hookå¯¹åº”çš„ç±»çš„å‡½æ•° å¶å°”ç”¨ï¼šApiResolver -ã€‹ ï¼ˆæ¨¡ç³Šï¼‰æœç´¢æœ‰å“ªäº›ç±»ï¼Œç±»æœ‰å“ªäº›å‡½æ•°ç­‰ é«˜çº§ç”¨æ³•ï¼šStalker -ã€‹ ç ”ç©¶ï¼ˆè¢«æ··æ·†çš„ï¼‰ä»£ç å®é™…çš„æ‰§è¡Œè¿‡ç¨‹å’Œé€»è¾‘ç­‰ ç”¨Fridaè¾…åŠ©iOSé€†å‘çš„æ€è·¯ iOSé€†å‘å¼€å‘å¿ƒå¾—=æ€è·¯ï¼šåˆ©ç”¨fridaï¼Œæ‰“å°å‡½æ•°è°ƒç”¨ -ã€‹æ‰¾åˆ°urlã€æ‰¾åˆ°å…¨éƒ¨è¢«è°ƒå‡½æ•° å¯¹äºiOSé€†å‘çš„è¯ï¼Œæœ‰ç©ºè¯•è¯• fridaçš„hookã€‚ å°±åƒä¹‹å‰åˆ«çš„æŸä¸€ä¸ªiOSæŠ€æœ¯äººå‘˜æ²Ÿé€šçš„æ–¹æ³•ï¼šHookæ‰€æœ‰æ–¹æ³•è°ƒç”¨ æ¯”å¦‚ ä¼°è®¡æ˜¯ hook objc_msgSend è¿™ç±»å‡½æ•°ï¼Ÿ éƒ½æ‰“å°å‡ºæ¥ å°±çŸ¥é“è°ƒç”¨äº†å“ªäº›ç±»çš„å“ªäº›å‡½æ•°äº†ï¼Œç”šè‡³å¯ä»¥åŠ ä¸Šé¢å¤–çš„ç»Ÿè®¡è°ƒç”¨æ¬¡æ•°ä¹‹ç±»çš„ã€‚ ä»¥åŠä¹Ÿå¯ä»¥æŠŠåé¢çš„å‡ ä¸ªå‚æ•°çš„å€¼ï¼Œåªè¦æ˜¯å­—ç¬¦ä¸²çš„ä¹Ÿéƒ½æ‰“å°å‡ºæ¥ã€‚ å¦å¤–å»hook urlè°ƒç”¨HTTPçš„ã€‚ ä¼°è®¡ä¹Ÿæ˜¯èƒ½è½»æ˜“çš„ææ¸…æ¥šå½“å‰è°ƒç”¨è¿‡å“ªäº›ç½‘ç»œè¯·æ±‚ä»¥åŠç›¸å…³çš„ä»€ä¹ˆå‚æ•°ã€‚ ä¼°è®¡å°±èƒ½æ‰¾å‡ºæ¥NSUrlRequetä¹‹ç±»çš„ç›¸å…³è°ƒç”¨å’Œurlå’Œå…¶ä»–å‚æ•°ã€‚ æ€»ä¹‹æœ‰ç©ºè¿˜æ˜¯å»å¤šè¯•è¯•fridaçš„hookã€‚ ã€åè®°1ã€‘ å…¶å®å°±æ˜¯æ‰€æœ‰ç±»çš„æ‰€æœ‰æ–¹æ³• ä¹‹å‰è¯•è¿‡ï¼Œæ•ˆæœè¿˜è¡Œã€‚ ä¸è¿‡è¦æ’é™¤æ‰è¾“å‡ºå¤ªå¤šçš„ï¼Œå¦åˆ™å®¹æ˜“å¡æ­»å´©æºƒã€‚ ã€åè®°2ã€‘ æœ‰æœºä¼šå»è¯•è¯•ï¼š fridaå»hookï¼š objc_msgSendå‡½æ•° çœ‹çœ‹æœ‰å¤šå°‘objcçš„å‡½æ•°è°ƒç”¨ ä¸è¿‡çªç„¶æƒ³åˆ°ï¼Œè²Œä¼¼å°±æ˜¯ï¼šfrida-traceåŠ ä¸Š-m *[* *]çš„æ„æ€ï¼Ÿ ã€åè®°3ã€‘ Hookæ‰€æœ‰æ–¹æ³•è°ƒç”¨ çœ‹æ¥åº”è¯¥æ˜¯ï¼š ç”¨Fridaå»hookï¼šæ‰€æœ‰ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Ÿ æˆ–è€…æ˜¯ï¼šfrida-traceå»hookæ‰€æœ‰ç±»çš„æ‰€æœ‰æ–¹æ³• åˆæˆ–è€…æ˜¯ï¼šåªhook objc_msgSendæ–¹æ³•ï¼Ÿè¿™æ ·ä¹Ÿèƒ½æ‰“å°å‡ºæ‰€æœ‰ObjCå‡½æ•°çš„è°ƒç”¨ æœ‰ç©ºå»è¯•è¯• crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 22:44:28 "},"use_frida/frida_cli/":{"url":"use_frida/frida_cli/","title":"frida","keywords":"","body":"frida frida æ˜¯ä»€ä¹ˆï¼šå‘½ä»¤è¡Œå·¥å…· fridaæ˜¯Fridaæ•´ä¸ªç³»ç»Ÿä¸­ï¼Œæœ€åŸºç¡€ï¼Œç”¨çš„æœ€å¤šçš„ï¼Œå‘½ä»¤è¡Œå·¥å…· å®˜ç½‘ç§°ä¹‹ä¸ºï¼šfrida-CLI æ–‡æ¡£ frida-cli å®‰è£…frida Macä¸­ç”¨Pythonå®‰è£…frida pip3 install frida helpè¯­æ³•å¸®åŠ© âœ frida-trace frida --help usage: frida [options] target positional arguments: args extra arguments and/or target options: -h, --help show this help message and exit -D ID, --device ID connect to device with the given ID -U, --usb connect to USB device -R, --remote connect to remote frida-server -H HOST, --host HOST connect to remote frida-server on HOST --certificate CERTIFICATE speak TLS with HOST, expecting CERTIFICATE --origin ORIGIN connect to remote server with â€œOriginâ€ header set to ORIGIN --token TOKEN authenticate with HOST using TOKEN --keepalive-interval INTERVAL set keepalive interval in seconds, or 0 to disable (defaults to -1 to auto-select based on transport) --p2p establish a peer-to-peer connection with target --stun-server ADDRESS set STUN server ADDRESS to use with --p2p --relay address,username,password,turn-{udp,tcp,tls} add relay to use with --p2p -f TARGET, --file TARGET spawn FILE -F, --attach-frontmost attach to frontmost application -n NAME, --attach-name NAME attach to NAME -N IDENTIFIER, --attach-identifier IDENTIFIER attach to IDENTIFIER -p PID, --attach-pid PID attach to PID -W PATTERN, --await PATTERN await spawn matching PATTERN --stdio {inherit,pipe} stdio behavior when spawning (defaults to â€œinheritâ€) --aux option set aux option when spawning, such as â€œuid=(int)42â€ (supported types are: string, bool, int) --realm {native,emulated} realm to attach in --runtime {qjs,v8} script runtime to use --debug enable the Node.js compatible script debugger --squelch-crash if enabled, will not dump crash report to console -O FILE, --options-file FILE text file containing additional command line options --version show program's version number and exit -l SCRIPT, --load SCRIPT load SCRIPT -P PARAMETERS_JSON, --parameters PARAMETERS_JSON parameters as JSON, same as Gadget -C USER_CMODULE, --cmodule USER_CMODULE load CMODULE --toolchain {any,internal,external} CModule toolchain to use when compiling from source code -c CODESHARE_URI, --codeshare CODESHARE_URI load CODESHARE_URI -e CODE, --eval CODE evaluate CODE -q quiet mode (no prompt) and quit after -l and -e -t TIMEOUT, --timeout TIMEOUT seconds to wait before terminating in quiet mode --pause leave main thread paused after spawning program -o LOGFILE, --output LOGFILE output to log file --eternalize eternalize the script before exit --exit-on-error exit with code 1 after encountering any exception in the SCRIPT --kill-on-exit kill the spawned program when Frida exits --auto-perform wrap entered code with Java.perform --auto-reload Enable auto reload of provided scripts and c module (on by default, will be required in the future) --no-auto-reload Disable auto reload of provided scripts and c module crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 08:14:57 "},"use_frida/frida_cli/debug_target.html":{"url":"use_frida/frida_cli/debug_target.html","title":"è°ƒè¯•ç›®æ ‡æ–¹å¼","keywords":"","body":"Fridaè°ƒè¯•ç›®æ ‡çš„æ–¹å¼ èƒŒæ™¯çŸ¥è¯† iOSçš„è¿›ç¨‹çš„ç±»å‹ iOSçš„è¿›ç¨‹æœ‰2ç±»ï¼š app=Bundle=è½¯ä»¶åŒ… ä¸¾ä¾‹ ï¼ˆiOSç³»ç»Ÿè‡ªå¸¦çš„ï¼‰è®¾ç½®app=åŒ…åæ˜¯ï¼šcom.apple.Preferences Executable=å¯æ‰§è¡Œæ–‡ä»¶=äºŒè¿›åˆ¶æ–‡ä»¶ ä¸¾ä¾‹ ï¼ˆAppleMediaServices.framework çš„ ï¼‰amsaccountsd fridaå’Œfrida-traceæ˜¯è°ƒè¯•ç›®æ ‡çš„æ–¹å¼çš„é€»è¾‘æ˜¯ä¸€æ ·çš„ frida --help å’Œï¼š frida-trace --help éƒ½å¯ä»¥çœ‹åˆ°å¯¹åº”helpè¯­æ³•ï¼š -f TARGET, --file TARGET spawn FILE -F, --attach-frontmost attach to frontmost application -n NAME, --attach-name NAME attach to NAME -N IDENTIFIER, --attach-identifier IDENTIFIER attach to IDENTIFIER -p PID, --attach-pid PID attach to PID -W PATTERN, --await PATTERN await spawn matching PATTERN frida/frida-traceè°ƒè¯•ç›®æ ‡çš„æ–¹å¼ frida/frida-traceçš„è°ƒè¯•ç›®æ ‡æ–¹å¼ æ¦‚è¿° æ”¯æŒ2ç§æ¨¡å¼ï¼šSpawnå’ŒAttach Spawnæ¨¡å¼ï¼šåªæœ‰ä¸€ç§å†™æ³• -f TARGET TARGETæ˜¯ appåŒ…å æˆ– ExecutableäºŒè¿›åˆ¶æ–‡ä»¶å Attachæ¨¡å¼ï¼šæœ‰å¤šç§å†™æ³•=é’ˆå¯¹appæˆ–Executableæœ‰ä¸åŒå†™æ³• åŒæ—¶æ”¯æŒappæˆ–Executableçš„ï¼š-p PID PIDæ˜¯appæˆ–Executableçš„è¿›ç¨‹ID é’ˆå¯¹Executableçš„ï¼š -n NAME NAMEæ˜¯Executableçš„äºŒè¿›åˆ¶æ–‡ä»¶åï¼Œæ¯”å¦‚amsaccountsd é’ˆå¯¹appçš„ï¼š-N IDENTIFIER IDENTIFIERæ˜¯appçš„åŒ…åï¼Œæ¯”å¦‚com.apple.Prefrences ç‰¹æ®Šçš„ï¼šé’ˆå¯¹å½“å‰æ‰‹æœºä¸­æ­£åœ¨è¿è¡Œçš„frontmostæœ€å‰å°çš„ï¼š-F ç”±äºæ˜¯ï¼Œå½“å‰æœ€å‰å°çš„æ­£åœ¨è¿è¡Œçš„= é‚£åªèƒ½æ˜¯å¸¦é¡µé¢æ˜¾ç¤ºçš„appï¼Œä¸”ä¹Ÿæ— éœ€å†åŠ é¢å¤–å‚æ•°æŒ‡å®šapp è¯¦è§£ frida/frida-traceçš„è°ƒè¯•ç›®æ ‡æ–¹å¼çš„è¯¦ç»†è§£é‡Šï¼š Spawnæ¨¡å¼ï¼šå­µåŒ–å‡ºæ–°è¿›ç¨‹ å…¸å‹ä½¿ç”¨åœºæ™¯ï¼šapp/Executableè¿˜æ²¡è¿è¡Œï¼Œæƒ³è¦ä»app/Executableåˆšå¼€å§‹å¯åŠ¨å°±å»hookè°ƒè¯• è¯­æ³• -f TARGET, --file TARGET spawn FILE ä¸¾ä¾‹frida -U -f com.apple.Preferences è¯´æ˜ TARGETï¼šæ˜¯ APPåŒ…å æˆ– ExecutableäºŒè¿›åˆ¶æ–‡ä»¶åï¼Ÿ spawnæ–¹å¼å¯åŠ¨åï¼Œä¼šç«‹åˆ»æš‚åœè¿è¡Œ éœ€è¦ç»§ç»­è¿è¡Œï¼Œéœ€è¦æ‰‹åŠ¨è¾“å…¥ï¼š%resume å¦‚æœä¸æƒ³è¦æ¯æ¬¡spawnå¯åŠ¨åæš‚åœï¼Œåˆ™å¯ä»¥åŠ ä¸Šå‚æ•°ï¼š--no-pause æ³¨ï¼šæ—§ç‰ˆæœ¬æ‰æœ‰--no-pauseï¼Œæ–°ç‰ˆæœ¬å·²ä¸æ”¯æŒ--no-pause Attachæ¨¡å¼ï¼šæŒ‚è½½åˆ°ä¸€ä¸ªå·²ç»æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ å…¸å‹ä½¿ç”¨åœºæ™¯ï¼šapp/Executableå·²ç»åœ¨è¿è¡Œäº†ï¼Œæƒ³è¦hookè°ƒè¯•ç›¸å…³é€»è¾‘ å¸¸è§å†™æ³• é’ˆå¯¹äºappçš„ frida -N com.app.identifier è¯­æ³• -N IDENTIFIER, --attach-identifier IDENTIFIER attach to IDENTIFIER ä¸¾ä¾‹frida -U -N com.apple.Preferences è¯´æ˜ å¦‚ä½•æŸ¥çœ‹åˆ°appçš„åŒ…å Macä¸­ç”¨frida-psfrida-ps -Ua frida-ps -Uai frida -F è¯­æ³• -F, --attach-frontmost attach to frontmost application ä¸¾ä¾‹ å½“å‰iPhoneä¸­æ­£åœ¨æ˜¾ç¤ºè®¾ç½®appçš„ç•Œé¢frida -U -F è¯´æ˜ F=Frontmost=Focused åœ¨æ“ä½œä¹‹å‰ï¼Œç¡®ä¿è¦è°ƒè¯•çš„appï¼Œå¤„åœ¨å‰å°=æ­£åœ¨è¿è¡Œ=å½“å‰ç•Œé¢ é’ˆå¯¹äºExecutableçš„ frida -n executableFilename è¯­æ³• -n NAME, --attach-name NAME attach to NAME ä¸¾ä¾‹frida -U -n amsaccountsd é’ˆå¯¹äº app æˆ– Executable çš„ frida -p PID è¯­æ³• -p PID, --attach-pid PID attach to PID ä¸¾ä¾‹ 12886æ˜¯msaccountsdçš„PIDfrida -U -p 12886 19641æ˜¯com.apple.Preferencesçš„è¿›ç¨‹IDfrida -U -p 19641 è¯´æ˜ å¦‚ä½•è·å–PID iPhoneä¸­é€šè¿‡sshè¿è¡Œpsps -A | grep yourAppOrExecutableName Macä¸­ç”¨frida-psfrida-ps -U frida-ps -Ua æ³¨æ„äº‹é¡¹ å¦‚æœè°ƒè¯•æ–¹å¼å¯¹åº”å‚æ•°ä½¿ç”¨æœ‰è¯¯ï¼Œæ˜¯æ— æ³•æ­£å¸¸è°ƒè¯•çš„ ä¸¾ä¾‹ å¯¹äºappï¼Œç”¨-nï¼ˆè€Œä¸æ˜¯-Nï¼‰ï¼Œä¼šæŠ¥é”™ å¯¹äºappï¼šç³»ç»Ÿå†…ç½®çš„åº”ç”¨ï¼šPreferencesï¼ˆåŒ…åcom.apple.Preferencesï¼‰ è™½ç„¶ä¹Ÿæœ‰å¯¹åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š/Applications/Preferences.app/Preferences ä½†æ˜¯æ˜¯æ— æ³•é€šè¿‡Executableçš„Attachå‚æ•°å»å¯åŠ¨çš„ å³ï¼Œä¸‹é¢å†™æ³•æ˜¯æ— æ•ˆçš„ï¼Œä¼šæŠ¥é”™çš„ï¼šâœ ~ frida-trace -U -n Preferences Failed to spawn: unable to find process with name 'Preferences' å¦‚æœç”¨-Nå‡ºç°å¼‚å¸¸æƒ…å†µï¼Œåˆ™å¯è€ƒè™‘æ¢ç”¨-F ä¸¾ä¾‹ Fridaè°ƒè¯•è®¾ç½®app ç”¨-N åŒ…å æˆ– -Fä¸åŠ åŒ…åfrida-trace -U -N com.apple.Preferences -O Preferences_accoutLogin_hook.txt frida-trace -U -F -O Preferences_accoutLogin_hook.txt -> å°±ä¼šå¯¼è‡´ï¼šè®¾ç½®appå¼‚å¸¸ -ã€‹ç‚¹å‡»ç™»å½•iPhoneï¼Œä¼šå‡ºç°å¼¹æ¡†ï¼šæ¥å…¥äº’è”ç½‘ä»¥ç™»å½•iPhoneï¼Œå¥½åƒæ˜¯ï¼šæ­¤æ—¶è®¾ç½®appæ— æ³•è”ç½‘äº† è€Œæ¢ç”¨-F åŒ…åå»è°ƒè¯•frida-trace -U -F com.apple.Preferences -O Preferences_accoutLogin_hook.txt -> å°±ä¸€åˆ‡æ­£å¸¸ï¼Œè®¾ç½®appå·¥ä½œæ­£å¸¸ï¼Œç‚¹å‡»ç™»å½•iPhoneï¼Œå¯ä»¥å‡ºç°Apple IDç™»å½•é¡µ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-22 21:59:31 "},"use_frida/frida_cli/js_script.html":{"url":"use_frida/frida_cli/js_script.html","title":"å†™jsè„šæœ¬","keywords":"","body":"å†™jsè„šæœ¬ fridaçš„åˆ©ç”¨æ–¹å¼ï¼Œä»ä½¿ç”¨è§’åº¦æ¥è¯´ï¼Œä¸»è¦åˆ†2ç±»ï¼š frida-traceï¼šæ— éœ€jsè„šæœ¬ï¼Œç›´æ¥å»hookå¯¹åº”çš„å‡½æ•° frida ... -l xxx.jsï¼šæœ€å¸¸è§çš„ç”¨æ³•ï¼Œé€šè¿‡jsè„šæœ¬å®ç°è‡ªå·±çš„åŠŸèƒ½ å³ï¼Œå†™jsè„šæœ¬ï¼Œå†ç”¨fridaå»åŠ è½½è°ƒç”¨ jsè„šæœ¬æ–‡ä»¶çš„ç±»å‹ + åˆ©ç”¨jsè„šæœ¬çš„æ–¹å¼ æœ€æ—©çš„ï¼Œå¤§å®¶ç”¨çš„æœ€å¤šçš„ï¼Œæœ€å¸¸è§çš„ï¼š.jsæ–‡ä»¶=JavaScriptæ–‡ä»¶ å¯¹åº”ç”¨æ³•frida ... -l xxx.js ä¸¾ä¾‹frida -U -p 8229 -l hookAccountLogin_singleClassSingleMethod.js æœ€æ–°çš„ï¼Œå®˜ç½‘æ¨èçš„ï¼š.tsæ–‡ä»¶=TypeScriptæ–‡ä»¶ å¯¹åº”ç”¨æ³•frida ... -l xxx.ts jsè„šæœ¬çš„æ¥æº å¯ä»¥è‡ªå·±å†™ æ¯”å¦‚ iOSçš„ObjC ä¸­çš„å„ç§ä¾‹å­ ä¹Ÿå¯ä»¥ï¼Œå€Ÿç”¨åˆ«äººå·²æœ‰çš„ æ¯”å¦‚ Frida Codeshare jsè„šæœ¬ä¸­çš„å†…å®¹ ä¸»è¦å–å†³äºä½ çš„å…·ä½“ä½¿ç”¨æ–¹æ³• æ ¹æ®ä½¿ç”¨åœºæ™¯åˆ†ï¼Œä¸»è¦æœ‰3ç§ï¼š Interceptor=æ‹¦æˆªå™¨ ä½œç”¨ï¼šå»å®ç°hookå‡½æ•°ï¼Œæ‰“å°å‚æ•°ç­‰è°ƒè¯•æ“ä½œ æ•ˆæœï¼šæ¯æ¬¡åŒ¹é…åˆ°ï¼ˆå¯¹åº”å‡½æ•°ï¼‰ï¼Œéƒ½ä¼šè§¦å‘æ‰§è¡Œjsä»£ç  ä¸¾ä¾‹ï¼šInterceptor=hookå‡½æ•° ApiResolver=è§£æå™¨ æ•ˆæœï¼šåªè¿è¡Œä¸€æ¬¡ åªæœ‰ç¬¬ä¸€æ¬¡ï¼ˆè§£ææ—¶ï¼‰åŒ¹é…åˆ°ï¼Œæ‰ä¼šæ‰§è¡Œï¼Œåç»­ä»£ç è¿è¡ŒæœŸé—´ï¼Œä¸å†å»ï¼ˆåŒ¹é…ï¼‰æ‰§è¡Œ ä½œç”¨ å¦‚æœæœ‰äº›æƒ…å†µéœ€è¦æ‰¹é‡ Hookï¼Œæ¯”å¦‚å¯¹æŸä¸€ä¸ªç±»çš„æ‰€æœ‰æ–¹æ³•è¿›è¡Œ Hookï¼Œæˆ–è€…å¯¹æŸä¸ªæ¨¡å—çš„ç‰¹å®šåç§°çš„å‡½æ•°è¿›è¡Œ Hookï¼Œå¯èƒ½æˆ‘ä»¬å¹¶ä¸çŸ¥é“å‡†ç¡®çš„åç§°æ˜¯ä»€ä¹ˆï¼ŒåªçŸ¥é“å¤§æ¦‚çš„å…³é”®å­—ï¼Œè¿™ç§æƒ…å†µæ€ä¹ˆ Hook å‘¢ï¼Ÿè¿™æ—¶å°±å¾—ä½¿ç”¨ APIæŸ¥æ‰¾å™¨ï¼ˆApiResolverï¼‰å…ˆæŠŠæ„Ÿå…´è¶£å‡½æ•°ç»™æ‰¾å‡ºæ¥ï¼Œå¾—åˆ°åœ°å€ä¹‹åå°±èƒ½ Hookäº† ä¸¾ä¾‹ï¼šApiResolver Stalker = è·Ÿè¸ªå™¨ æ•ˆæœï¼šè·Ÿè¸ªä»£ç çš„å®é™…è¿è¡Œçš„è¿‡ç¨‹ æœŸé—´å¯ä»¥æ‰“å°å’ŒæŸ¥çœ‹å¯¹åº”çš„å€¼ï¼Œä¾¿äºå®ç°è°ƒè¯•çœŸæ­£ä»£ç è¿è¡Œçš„é€»è¾‘ è¯¦è§ï¼šFridaçš„Stalker ä¸¾ä¾‹ï¼šStalker crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 23:00:47 "},"use_frida/frida_cli/typical_usage.html":{"url":"use_frida/frida_cli/typical_usage.html","title":"å…¸å‹ä½¿ç”¨æ–¹å¼","keywords":"","body":"Fridaçš„å…¸å‹ä½¿ç”¨æ–¹å¼ åœ¨ææ‡‚äº†è°ƒè¯•ç›®æ ‡æ–¹å¼å’Œå†™jsè„šæœ¬åï¼Œå†æ¥ä»‹ç» Fridaçš„å…¸å‹ä½¿ç”¨æ–¹å¼ ç”¨å“ªä¸ªå‘½ä»¤ï¼Ÿ ä¸»è¦æ˜¯ç”¨ï¼šfrida å¤§éƒ½æ˜¯éƒ½æ˜¯fridaç„¶ååŠ ä¸Š-l xxx.jsåŠ ä¸Šjsè„šæœ¬ï¼Œå®ç°è‡ªå·±ç‰¹å®šçš„è°ƒè¯•çš„ç›®çš„ å¶å°”ä½¿ç”¨ï¼šfrida-trace å¶å°”ç›´æ¥ç”¨frida-traceï¼ŒåŠ ä¸Šè¦hookçš„ç±»æˆ–å‡½æ•°ï¼Œå»è¿½è¸ªä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨åˆ°å“ªäº›å‡½æ•° å¸¸è§å†™æ³• = æ€ä¹ˆç”¨ï¼Ÿ å‘½ä»¤è¡Œä¸­ä½¿ç”¨ frida xxx frida-trace xxx ï¼ˆå…¶ä¸­xxxä¸­ï¼‰å¸¸ç”¨å‚æ•°æœ‰ è¦è°ƒè¯•çš„è®¾å¤‡ç”¨ï¼š-U -Uï¼šè°ƒè¯•çš„æ˜¯USBè¿æ¥çš„ç§»åŠ¨ç«¯çš„è®¾å¤‡ï¼ˆæ¯”å¦‚iPhoneï¼‰ è¦è°ƒè¯•çš„ç›®æ ‡app/äºŒè¿›åˆ¶ï¼š-p PID / -n executableName / -N com.app.identifier / -F / -F com.app.identifier æœ‰å¤šç§å†™æ³•ï¼Œé€‰æ‹©åˆé€‚çš„ä¸€ä¸ªå³å¯ appæˆ–äºŒè¿›åˆ¶å‡æ”¯æŒ é€šè¿‡PIDæŒ‡å®šè¿›ç¨‹ï¼š-p PID ä»…æ”¯æŒäºŒè¿›åˆ¶ é€šè¿‡-næŒ‡å®šäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶åï¼š-n executableName ä»…æ”¯æŒapp é€šè¿‡-NæŒ‡å®šappçš„åŒ…åï¼š-N com.app.identifier é€šè¿‡-FæŒ‡å®šå½“å‰æœ€é¡¶å±‚æ­£åœ¨è¿è¡Œçš„appï¼š-F æœ‰æ—¶å€™å¯ä»¥é¢å¤–ç»™-Få†åŠ ä¸Šappçš„åŒ…åï¼Œæ•ˆæœæ›´å¥½ï¼š-F com.app.identifier -ã€‹æ‰€ä»¥å¸¸è§å†™æ³•ä¸¾ä¾‹ frida æ— éœ€jsï¼šç›´æ¥åŠ¨æ€äº¤äº’å¼çš„è°ƒè¯•frida -U -f com.apple.Preferences éœ€è¦jsï¼šå®ç°ç‰¹å®šè°ƒè¯•ç›®çš„ è‡ªå·±å†™js ä½¿ç”¨-pæŒ‡å®šè¿›ç¨‹PIDfrida -U -F -p 18533 -l ./hookAccountLogin_Interceptor.js -Uï¼šè°ƒè¯•çš„è®¾å¤‡æ˜¯ï¼ˆå½“å‰Macç”¨ï¼‰USBè¿æ¥çš„iPhone -F -p 18533ï¼šè°ƒè¯•çš„appæ˜¯ -Fï¼šè¡¨ç¤ºæ˜¯å½“å‰æœ€å‰ç«¯æ˜¾ç¤ºçš„app -p 18533ï¼šï¼ˆé¢å¤–ï¼‰åŠ ä¸ŠPIDï¼ŒæŒ‡å®šappçš„è¿›ç¨‹ID -l ./hookAccountLogin_Interceptor.jsï¼šæ‰€è¦å…·ä½“è°ƒè¯•çš„å†…å®¹ï¼Œæ”¾åœ¨jsä¸­ ä½¿ç”¨-næŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶å=è¿›ç¨‹å=ProcessNamefrida -U -n akd -l ./fridaStalker_akdSymbol2575.js -n akdï¼šè¦è°ƒè¯•çš„ç›®æ ‡æ˜¯ï¼Œè¿›ç¨‹å=äºŒè¿›åˆ¶åæ˜¯akdçš„è¿›ç¨‹ æ³¨ï¼šakd=AuthKitçš„daemonè¿›ç¨‹ å€ŸåŠ©åˆ«äººçš„jsfrida --codeshare lichao890427/ios-utils -F com.apple.Preferences frida-trace ç”¨frida-traceè¿½è¸ªPreferencesè®¾ç½®ä¸­Appleè´¦å·ç™»å½•è¿‡ç¨‹è°ƒç”¨äº†å“ªäº›å‡½æ•°frida-trace -U -F com.apple.Preferences -m \"*[AA* *]\" -m \"*[AK* *]\" -m \"*[AS* *]\" -m \"*[NSXPC* *]\" -M \"-[ASDBundle copyWithZone:]\" -M \"-[ASDInstallationEvent copyWithZone:]\" -M \"-[NSXPCEncoder _encodeArrayOfObjects:forKey:]\" -M \"-[NSXPCEncoder _encodeUnkeyedObject:]\" -M \"-[NSXPCEncoder _replaceObject:]\" -M \"-[NSXPCEncoder _checkObject:]\" -M \"-[NSXPCEncoder _encodeObject:]\" -M \"-[NSXPCConnection replacementObjectForEncoder:object:]\" è¯´æ˜ -U -F com.apple.Preferencesï¼šè°ƒè¯•ç›®æ ‡è®¾å¤‡å’Œç›®æ ‡appæ˜¯å’Œfridaå†™æ³•ä¸€è‡´ ä½†æ˜¯åç»­è¦traceçš„å‡½æ•°å†™æ³•ï¼Œæ˜¯frida-traceæ‰€ç‰¹æœ‰çš„è¯­æ³•ï¼š -m xxxï¼šinclude=åŒ…å«è¦è°ƒè¯•çš„Objcçš„ç±» -M xxxï¼šexclue=æ’é™¤æ‰Objcçš„ç±»ï¼Œä¸è°ƒè¯• crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 23:15:37 "},"use_frida/frida_cli/ios_objc/":{"url":"use_frida/frida_cli/ios_objc/","title":"iOSçš„ObjC","keywords":"","body":"Fridaä¸­iOSçš„ObjC Fridaæ”¯æŒhookè°ƒè¯•iOSçš„ObjCçš„ç±»å’Œå‡½æ•°ã€‚ Fridaçš„ObjC å®˜ç½‘æ–‡æ¡£ Frida API - ObjC ObjC.available ObjC.api ObjC.classes ObjC.Object ObjC.protocols ObjC.Protocol ObjC.mainQueue ObjC.schedule(queue, work) new ObjC.Object(handle[, protocol]) new ObjC.Protocol(handle) new ObjC.Block(target[, options]) ObjC.implement(method, fn) ObjC.registerProxy(properties) ObjC.registerClass(properties) ObjC.registerProtocol(properties) ObjC.bind(obj, data) ObjC.unbind(obj) ObjC.getBoundData(obj) ObjC.enumerateLoadedClasses([options, ]callbacks) ObjC.enumerateLoadedClassesSync([options]) ObjC.choose(specifier, callbacks) ObjC.chooseSync(specifier) ObjC.selector(name) ObjC.selectorAsString(sel) å¸¸ç”¨å·¥å…·ç±» iOS Utils ä¸‹é¢ç»§ç»­ä»‹ç»ï¼Œå…³äºFridaä¸­ObjCçš„åŸºæœ¬é€»è¾‘ï¼š crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 23:29:20 "},"use_frida/frida_cli/ios_objc/objc_para.html":{"url":"use_frida/frida_cli/ios_objc/objc_para.html","title":"ObjCçš„å‚æ•°","keywords":"","body":"Fridaä¸­ObjCçš„å‚æ•° å½“è§¦å‘åˆ°Interceptor.attachçš„onEnterå‡½æ•°å ä¸¾ä¾‹ï¼šç›¸å…³çš„å…¸å‹çš„ä»£ç function hook_specific_method_of_class(className, funcName) { var curClass = ObjC.classes[className]; if (typeof(curClass) !== 'undefined') { var curMethod = curClass[funcName]; if (typeof(curMethod) !== 'undefined') { Interceptor.attach(curMethod.implementation, { onEnter: function(args) { ... ä¼ å…¥Fridaä¸­iOSçš„ObjCçš„å‚æ•° == ObjCçš„åº•å±‚å‡½æ•°objc_msgSendçš„å‚æ•° æ³¨ï¼šobjc_msgSendå‡½æ•°çš„å®šä¹‰id objc_msgSend(id self, SEL _cmd, ...) æ­¤æ—¶é»˜è®¤å‚æ•°åå«åšargsçš„å‚æ•° == æ˜¯ä¸€ä¸ªå‚æ•°çš„æ•°ç»„åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ çš„ç±»å‹æ˜¯NativePointer æ­¤æ—¶å¯¹åº”ï¼ˆFridaä¸­iOSçš„ObjCï¼‰çš„å‚æ•°é€»è¾‘æ˜¯ï¼š ç¬¬ä¸€ä¸ªå‚æ•° = args[0] == objc_msgSendçš„self(ç±»å‹æ˜¯id) ç¬¬äºŒä¸ªå‚æ•° = args[1] == objc_msgSendçš„_cmdï¼ˆç±»å‹æ˜¯SELï¼‰ åç»­æ‰æ˜¯ï¼šçœŸæ­£çš„å‡½æ•°çš„å‚æ•° å‡½æ•°çš„çœŸæ­£çš„ç¬¬1ä¸ªå‚æ•° = args[2] å‡½æ•°çš„çœŸæ­£çš„ç¬¬2ä¸ªå‚æ•° = args[3] ... Fridaä¸­è·å–ObjCçš„å‚æ•° ç¬¬ä¸€ä¸ªå‚æ•°args[0] è·å–ç¬¬ä¸€ä¸ªå‚æ•°args[0] // args[0] is self = id const argSelf = args[0]; console.log(\"argSelf: \", argSelf); å…¸å‹logè¾“å‡ºargSelf: 0x105744c00 ç¬¬äºŒä¸ªå‚æ•°args[1] è·å–ç¬¬äºŒä¸ªå‚æ•°args[1]ï¼š // args[1] is selector const argSel = args[1]; console.log(\"argSel: \", argSel); å…¸å‹logè¾“å‡ºargSelf: 0x105744c00 ObjCå‡½æ•°çš„çœŸæ­£å‚æ•° è·å– å‡½æ•°çš„çœŸæ­£çš„ç¬¬1ä¸ªå‚æ•° = args[2] // args[2] holds the first function argument const args2 = args[2]; console.log(\"args2: \", args2); å…¸å‹logè¾“å‡ºargs2: 0x105743850 è·å– å‡½æ•°çš„å…¶ä»–æ›´å¤šå‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ const args3 = args[3]; console.log(\"args3: \", args3); const args4 = args[4]; console.log(\"args4: \", args4); ... è®¡ç®—ObjCçš„å‡½æ•°çš„çœŸæ­£å‚æ•°çš„ä¸ªæ•° + æ‰“å°å…¨éƒ¨å‚æ•° TODOï¼šæŠŠè¿™éƒ¨åˆ†ä»£ç ï¼Œæ•´ç†æˆ ç‹¬ç«‹çš„å·¥å…·ç±»å‡½æ•°ï¼Œè½¬ç§»åˆ°ï¼šå·¥å…·ç±»å‡½æ•° æ ¹æ®ObjCçš„åŸºç¡€çŸ¥è¯†ï¼Œç›®å‰å¾—çŸ¥ï¼šå¯ä»¥é€šè¿‡SEL=selectorå­—ç¬¦ä¸²ä¸­çš„:=å†’å·çš„ä¸ªæ•°ï¼Œåˆ¤æ–­åç»­çœŸæ­£æœ‰å‡ ä¸ªå‚æ•° æ‰€ä»¥ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹ä»£ç ï¼Œå¾ªç¯çš„ã€æ‰¹é‡çš„ã€æŒ¨ä¸ªã€æ‰“å°æ‰€æœ‰å‚æ•°ï¼š /** Function that count occurrences of a substring in a string; * @param {String} string The string * @param {String} subString The sub string to search for * @param {Boolean} [allowOverlapping] Optional. (Default:false) * * @author Vitim.us https://gist.github.com/victornpb/7736865 * @see Unit Test https://jsfiddle.net/Victornpb/5axuh96u/ * @see https://stackoverflow.com/a/7924240/938822 */ function occurrences(string, subString, allowOverlapping) { // console.log(\"string=\" + string + \",subString=\" + subString + \", allowOverlapping=\" + allowOverlapping) string += \"\"; subString += \"\"; if (subString.length = 0) { ++n; pos += step; } else break; } return n; } ... function hook_specific_method_of_class(className, funcName) { var iOSObjCallStr = toiOSObjcCall(className, funcName) // var hook = ObjC.classes[className][funcName]; // var hook = eval('ObjC.classes.' + className + '[\"' + funcName + '\"]'); var curClass = ObjC.classes[className]; if (typeof(curClass) !== 'undefined') { var curMethod = curClass[funcName]; if (typeof(curMethod) !== 'undefined') { Interceptor.attach(curMethod.implementation, { onEnter: function(args) { console.log(\"=========== [*] Detected call to: \" + iOSObjCallStr); ... const argSelStr = ObjC.selectorAsString(argSel); console.log(\"argSelStr: \", argSelStr); const argCount = occurrences(argSelStr, \":\"); // console.log(\"funcName=\", funcName); // const argCount = occurrences(funcName, \":\"); // console.log(\"argCount: \", argCount); for (let curArgIdx = 0; curArgIdx æŸæ¬¡çš„è¾“å‡ºæ—¥å¿—çš„æ•ˆæœï¼š =========== [*] Detected call to: +[NSURLRequest requestWithURL:cachePolicy:timeoutInterval:] funcName= + requestWithURL:cachePolicy:timeoutInterval: argSelStr: requestWithURL:cachePolicy:timeoutInterval: argCount: 3 ---------- [0] curArgPtr=0x2831f2530 curArgPtrObj: https://setup.icloud.com/setup/signin/v2/login curArgPtrObj className: NSURL ---------- [1] curArgPtr=0x0 ---------- [2] curArgPtr=0x0 æ³¨æ„ï¼š å½“Fridaè°ƒè¯•æœŸé—´ï¼Œè¾“å‡ºlogæ—¥å¿—å¤ªå¤šï¼Œæˆ–è€…æ‰“å°å‚æ•°å¤ªå¤šæ—¶ï¼Œç»å¸¸ä¼šå¯¼è‡´appæˆ–è¿›ç¨‹å´©æºƒè€Œæ— æ³•ç»§ç»­è°ƒè¯• æ‰€ä»¥å½“é‡åˆ°Fridaè°ƒè¯•å¯¼è‡´çš„å´©æºƒé—®é¢˜æ—¶ï¼Œå¯ä»¥é€‚å½“çš„å‡å°‘logæ—¥å¿—çš„è¾“å‡ºï¼Œä»¥ç¼“è§£å´©æºƒé—®é¢˜ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 23:44:27 "},"use_frida/frida_cli/ios_objc/objc_var_type.html":{"url":"use_frida/frida_cli/ios_objc/objc_var_type.html","title":"ObjCçš„å˜é‡ç±»å‹","keywords":"","body":"Fridaä¸­ObjCçš„å˜é‡ç±»å‹ é€šç”¨é€»è¾‘ è·å–ObjCçš„æŸä¸ªç±» å†™æ³•ï¼šObjC.classes.someClassName == ObjC.classes[someClassName] ä¸¾ä¾‹ ObjC.classes.NSMutableData.data() ObjC.classes.NSString.stringWithString_(\"Crifan Li\") ObjCçš„Object æ­¤å¤„çš„ç¬¬ä¸€ä¸ªå‚æ•°å’Œåç»­çš„çœŸæ­£çš„å‡½æ•°çš„ï¼ˆç¬¬ä¸€ä¸ªä»¥åŠåç»­çš„å…¶ä»–ï¼‰å‚æ•°ï¼Œå¾€å¾€æ˜¯ä¸ªï¼ˆiOSä¸­ObjCçš„ï¼‰Classæˆ–Instanceï¼Œåœ¨Fridaä¸­å¯¹åº”çš„å«åšï¼š ObjCçš„Object ObjCçš„Objectçš„å¸¸è§çš„æ“ä½œ è½¬æ¢ä¸ºObjCçš„ç±» const argSelf = args[0] const argSelfObj = new ObjC.Object(argSelf) const args2 = args[2] const args2Obj = new ObjC.Object(args2) // const args2Obj = new ObjC.Object(ptr(args2)) ä»¥åŠç´§æ¥ç€çš„ï¼š æ‰“å°ç±»çš„ä¿¡æ¯ console.log(\"argSelfObj: \", argSelfObj) console.log(\"args2Obj: \", args2Obj) å…¸å‹logè¾“å‡º argSelfObj: connection from pid 46847 on mach service named com.apple.ak.auth.xpc args2Obj: ä»¥åŠï¼ŒæŠŠObjectè½¬æ¢æˆStringå­—ç¬¦ä¸²ï¼Œå†å»æ‰“å° const args2ObjStr = args2Obj.toString(); console.log(\"args2ObjStr: \", args2ObjStr); å…¸å‹logè¾“å‡ºargs2ObjStr: æ³¨ï¼šæ­¤å¤„ä»è°ƒè¯•è¾“å‡ºç±»çš„ä¿¡æ¯çš„è§’åº¦æ¥è¯´ï¼Œå¾€å¾€Objectè½¬æ¢æˆStringåå†è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼Œå’Œä¸Šè¿°ç›´æ¥æ‰“å°Objectçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ ObjCçš„Objectçš„ç‰¹æ®Šå±æ€§ å¯¹äºFridaä¸­çš„ObjCçš„Objectï¼Œæœ‰å¾ˆå¤šå†…ç½®çš„ç‰¹æ®Šçš„å±æ€§ï¼š $kind $super $superClass $class $className $moduleName $protocols $methods $ownMethods $ivars æ‰€ä»¥ï¼Œä¸€äº›å¸¸è§æ“ä½œæ˜¯ï¼š $className æŸ¥çœ‹ï¼ˆå½“å‰Objectå¯¹è±¡çš„ï¼‰ç±»å=ç±»çš„åå­— const argSelfClassName = argSelfObj.$className; console.log(\"argSelfClassName: \", argSelfClassName); const args2ObjClassName = args2Obj.$className; console.log(\"args2ObjClassName: \", args2ObjClassName); å…¸å‹logè¾“å‡º argSelfClassName: NSXPCConnection args2ObjClassName: AKAppleIDAuthenticationService $kind æŸ¥çœ‹ï¼ˆå½“å‰Objectå¯¹è±¡çš„ï¼‰ç±»å‹ const argSelfKind = argSelfObj.$kind; console.log(\"argSelfKind:\", argSelfKind); å…¸å‹logè¾“å‡ºargSelfKind: instance $methodså’Œ$ownMethods æ³¨æ„ æ­¤å¤„çš„$methodsã€$ownMethodsä¸­çš„method methodçš„è‹±æ–‡å•è¯æœ¬æ„æ˜¯ï¼šæ–¹æ³•=å‡½æ•° ä½†å®é™…ä¸Šæ­¤å¤„ï¼šmethod = ç±»çš„property + ç±»çš„method æ³¨ï¼š property=å±æ€§ method=æ–¹æ³•=å‡½æ•° ä¸¾ä¾‹ï¼š$methodså’Œ$ownMethods ObjCçš„Objectçš„è‡ªå·±ç±»çš„å±æ€§ è€Œå¯¹äºæœ¬èº«ObjCçš„ç±»çš„å±æ€§ï¼Œä¹Ÿæ˜¯æ”¯æŒè®¿é—®çš„ï¼š è®¿é—®ObjCçš„è‡ªå·±ç±»çš„å±æ€§çš„æ–¹å¼ï¼šæŠŠå±æ€§å½“åšå‡½æ•°è®¿é—® -ã€‹åŠ ä¸Šæ‹¬å·() è¯­æ³•ï¼šiosObjcObj.propertyName() ä¸¾ä¾‹ è·å–NSXPCConnectionçš„serviceName å¯¹äºObjcçš„Objectå¯¹è±¡ï¼šargSelfObj: connection from pid 46847 on mach service named com.apple.ak.auth.xpc å»è·å–å…¶serviceNameå±æ€§çš„ä»£ç ï¼š const connnServiceNameNSStr = argSelfObj.serviceName(); console.log(\"connnServiceNameNSStr: \", connnServiceNameNSStr); è¾“å‡ºlogconnnServiceNameNSStr: com.apple.ak.auth.xpc è·å–NSStringçš„UTF8String ä»£ç ï¼š const connnServiceNameJsStr = connnServiceNameNSStr.UTF8String(); console.log(\"connnServiceNameJsStr: \", connnServiceNameJsStr); è¾“å‡ºlogconnnServiceNameJsStr: com.apple.ak.auth.xpc ObjCçš„Objectçš„è‡ªå·±ç±»çš„å‡½æ•° Fridaä¸­ï¼Œæ˜¯å¯ä»¥è°ƒç”¨Objcä¸­ç±»çš„å‡½æ•°çš„ã€‚ ä¸¾ä¾‹ï¼š+[NSString stringWithString:] ObjCä¸­NSStringçš„åŸå§‹å‡½æ•°ï¼š +[NSString stringWithString:@\"Hello World\"] æ ¹æ®è§„åˆ™ï¼š æŠŠå†’å·=:å˜æˆä¸‹åˆ’çº¿=_ ç»™å‡½æ•°åŠ ä¸Šæ‹¬å·() æŠŠå‚æ•°æ”¾åˆ°æ‹¬å·()ä¸­ è€Œå˜æˆï¼š const { NSString } = ObjC.classes; NSString.stringWithString_(\"Hello World\"); æˆ–å¦å¤–ä¸€ç§å†™æ³•ï¼šObjC.classes.NSString.stringWithString_(\"Hello World\"); ä¸¾ä¾‹ï¼š-[NSString cStringUsingEncoding:] ObjCçš„å‡½æ•°ï¼š-[NSString cStringUsingEncoding:] -> Fridaä¸­çš„è°ƒç”¨ï¼šconst NSUTF8StringEncoding = 4; const curJsStr = curNsStr.cStringUsingEncoding_(NSUTF8StringEncoding)` ObjCçš„selector ObjCä¸­ï¼Œæœ‰ä¸ªç¨å¾®ç‰¹æ®Šä¸€ç‚¹çš„å˜é‡ï¼Œå«åšSEL=selector ä¹Ÿå°±æ˜¯å‰é¢è·å–åˆ°çš„ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼Œç±»å‹æ˜¯SEL SELçš„å¸¸è§æ“ä½œä¹‹ä¸€å°±æ˜¯ï¼šè½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå†å»æ‰“å°const argSel = args[1] const argSelStr = ObjC.selectorAsString(argSel); console.log(\"argSelStr: \", argSelStr); å…¸å‹logè¾“å‡º argSelStr: setExportedObject: ObjCçš„Protocol ObjCçš„Block crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 23:10:39 "},"use_frida/frida_cli/data_type/":{"url":"use_frida/frida_cli/data_type/","title":"æ•°æ®ç±»å‹","keywords":"","body":"æ•°æ®ç±»å‹ Fridaä¸­å…¸å‹çš„æ•°æ®ç±»å‹æœ‰ï¼š Int64 https://frida.re/docs/javascript-api/#int64 UInt64 https://frida.re/docs/javascript-api/#uint64 NativePointer ArrayBuffer https://frida.re/docs/javascript-api/#arraybuffer å…¶ä»–ç›¸å…³ Functionå‡½æ•° NativeFunction https://frida.re/docs/javascript-api/#nativefunction SystemFunction https://frida.re/docs/javascript-api/#systemfunction Callbackå›è°ƒ NativeCallback https://frida.re/docs/javascript-api/#nativecallback å¸¸è§ç¼©å†™ å’Œæ•°æ®ç±»å‹æœ‰å…³çš„ï¼Œå¸¸è§ç¼©å†™æœ‰ï¼š int64(v) == new Int64(v) uint64(v) == new UInt64(v) ptr(s) == new NativePointer(s) NULL == ptr(\"0\") crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 22:10:37 "},"use_frida/frida_cli/data_type/nativepointer.html":{"url":"use_frida/frida_cli/data_type/nativepointer.html","title":"NativePointer","keywords":"","body":"NativePointer NativePointer æ˜¯ä»€ä¹ˆï¼šFridaä¸­ä¸€ä¸ªæœ€åŸºæœ¬çš„å˜é‡ç±»å‹ å¸¸ç®€ç§°ï¼šptr å®˜ç½‘æ–‡æ¡£ NativePointer - JavaScript API NativePointerçš„å‡½æ•°=æ”¯æŒçš„æ“ä½œ NativePointerçš„å‡½æ•°=æ”¯æŒçš„æ“ä½œ new NativePointer(s)ï¼šä¼ å…¥å­—ç¬¦ä¸²ï¼Œç”ŸæˆNativePointer å¤§å®¶å¸¸ç”¨=å…¶ç®€å†™ä¸ºï¼šptr(s) isNull()ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºç©º add(rhs), sub(rhs), and(rhs), or(rhs), xor(rhs) shr(n), shl(n) not() sign([key, data]) strip([key]) blend(smallInteger) equals(rhs) compare(rhs) toInt32() toString([radix = 16]) toMatchPattern() readPointer() writePointer(ptr) readS8(), readU8(), readS16(), readU16(), readS32(), readU32(), readShort(), readUShort(), readInt(), readUInt(), readFloat(), readDouble() writeS8(value), writeU8(value), writeS16(value), writeU16(value), writeS32(value), writeU32(value), writeShort(value), writeUShort(value), writeInt(value), writeUInt(value), writeFloat(value), writeDouble(value) readS64(), readU64(), readLong(), readULong() writeS64(value), writeU64(value), writeLong(value), writeULong(value) readByteArray(length) writeByteArray(bytes) readCString([size = -1]), readUtf8String([size = -1]), readUtf16String([length = -1]), readAnsiString([size = -1]) writeUtf8String(str), writeUtf16String(str), writeAnsiString(str) NativePointerçš„å…¸å‹ç”¨æ³• ä¸€äº›å¸¸è§çš„å†™æ³• myOffsetPtr = myBaseAddr.add(ptr('0x76E')) console.log(hexdump(ptr(0x7cbe43acd0))) Memory.protect(ptr('0x1234'), 4096, 'rw-'); ptr('0x7fff870135c9') onEnterä¸­çš„args fridaä¸­æœ€å¸¸æ¶‰åŠåˆ°NativePointerçš„åœ°æ–¹å°±æ˜¯ï¼šInterceptor.attachçš„onEnterä¸­çš„argsï¼Œå°±æ˜¯ä¸€ä¸ªNativePointerçš„æ•°ç»„ = an array of NativePointer objects å•ä¸ªç±»çš„å•ä¸ªå‡½æ•°çš„ä»£ç ä¸¾ä¾‹ä¸­çš„ï¼š const curMethod = ObjC.classes.NSXPCConnection[\"- setExportedObject:\"]; Interceptor.attach(curMethod.implementation, { onEnter: function(args) { const arg0 = args[0] const arg1 = args[1] const arg2 = args[2] console.log(\"args: Objc self id=\" + arg0 + \", SEL=\" + arg1 + \", objcRealArg1=\" + arg2); } }); ä¸­çš„argsï¼Œå°±æ˜¯NativePointerçš„æ•°ç»„ï¼Œæ‰€ä»¥ï¼šarg0ã€arg1ã€arg2ï¼Œéƒ½æ˜¯NativePointer=ptrç±»å‹ è€Œå…¸å‹çš„åç»­çš„æ“ä½œå°±æ˜¯ï¼Œå»è½¬æ¢æˆå¯¹åº”çš„ç±»å‹ï¼Œå»å¤„ç† æ¯”å¦‚ï¼š ObjCä¸­ï¼ŒæŠŠä¼ å…¥çš„å‚æ•°ï¼Œè½¬æ¢æˆçœŸæ­£çš„ObjCçš„ç±»const argSelf = args[0]; const argSelfObj = new ObjC.Object(argSelf); ç”¨addè®¡ç®—å‡½æ•°åœ°å€ Stalkerå®ä¾‹ä»£ç  ä¸­çš„ var funcRelativeStartAddr = 0xa0460; var functionSize = 0x24C8; // 9416 == 0x24C8 var funcRelativeEndAddr = funcRelativeStartAddr + functionSize; const moduleName = \"akd\"; const moduleBaseAddress = Module.findBaseAddress(moduleName); const funcRealStartAddr = moduleBaseAddress.add(funcRelativeStartAddr); const funcRealEndAddr = funcRealStartAddr.add(functionSize); ä¸­å°±æ˜¯ç”¨åˆ°äº†Module.findBaseAddressçš„è¿”å›å€¼ï¼Œç±»å‹å°±æ˜¯NativePointerï¼Œç„¶åï¼š const funcRealStartAddr = moduleBaseAddress.add(funcRelativeStartAddr); é€šè¿‡addåŠ ä¸Šèµ·å§‹åœ°å€ï¼Œè®¡ç®—å‡ºå‡½æ•°çœŸæ­£çš„èµ·å§‹åœ°å€ const funcRealEndAddr = funcRealStartAddr.add(functionSize); é€šè¿‡addåŠ ä¸Šå‡½æ•°å¤§å°ï¼Œè®¡ç®—å‡ºçœŸæ­£çš„ç»“æŸåœ°å€ è¾“å‡ºçš„ç›¸å…³logï¼š funcRelativeStartAddr=656480, functionSize=9416, funcRelativeEndAddr=665896 moduleName=akd, moduleBaseAddress=0x10015c000 funcRealStartAddr=0x1001fc460, funcRealEndAddr=0x1001fe928 æ³¨æ„ï¼š å¦‚æœæ˜¯NativePointerç±»å‹çš„å˜é‡ï¼Œç›´æ¥ç›¸åŠ +æ™®é€šçš„æ•°å€¼ï¼Œåˆ™ç»“æœï¼Œä¸æ˜¯æ•°å€¼ä¸Šçš„ç›¸åŠ ï¼Œè€Œæ˜¯ï¼šæ•°å€¼çš„å­—ç¬¦ä¸²æ‹¼æ¥ å¯¹æ¯” ä¸Šè¿°ä»£ç const funcRealEndAddr = funcRealStartAddr.add(functionSize); ç»“æœï¼šfuncRealEndAddr=0x1001fe928 = 0x1001fc460 + 0x24C8 å¦‚æœæ”¹ä¸ºconst funcRealEndAddr = funcRealStartAddr + functionSize; åˆ™ç»“æœæ˜¯ï¼šfuncRealEndAddr=0x1001fc4609416 = åœ°å€çš„å­—ç¬¦ä¸²0x1001fc460 æ‹¼æ¥ä¸Š 9416(=16è¿›åˆ¶çš„0x24C8çš„10è¿›åˆ¶å€¼) crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 23:17:59 "},"use_frida/frida_cli/frida_stalker.html":{"url":"use_frida/frida_cli/frida_stalker.html","title":"Fridaçš„Stalker","keywords":"","body":"Fridaçš„Stalker Fridaçš„Stalker åˆ«ç§°ï¼šfrida-stalker æœ‰äººç¿»è¯‘æˆï¼šæ½œè¡Œè€… ä½œç”¨ï¼šæ±‡ç¼–æŒ‡ä»¤çº§åˆ«çš„hook ç”¨é€”ï¼šè¿½è¸ªçœŸå®ä»£ç æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ å®˜ç½‘æ–‡æ¡£ Stalkerä»‹ç» APIæ¥å£ æ¥å£å½¢å¼ æ™®é€šç”¨æˆ·å¸¸ç›´æ¥è°ƒç”¨ï¼šJSçš„API Stalker - JavaScript API | Frida å†…éƒ¨æ¥å£ï¼šGumæ¥å£ TypeScript type definitions DefinitelyTyped/index.d.ts æ¥å£å†…å®¹ æœ€æ ¸å¿ƒæ¥å£ Stalker.follow([threadId, options]) å…¶ä»– Stalker.exclude(range) Stalker.unfollow([threadId]) Stalker.parse(events[, options]) Stalker.flush() Stalker.garbageCollect() Stalker.invalidate(address) Stalker.invalidate(threadId, address) Stalker.addCallProbe(address, callback[, data]) Stalker.removeCallProbe Stalker.trustThreshold Stalker.queueCapacity Stalker.queueDrainInterval ç”¨æ³• æ¦‚è¿° æ ¸å¿ƒé€»è¾‘ åœ¨fridaå‘½ä»¤ä¸Šï¼Œå’Œæ™®é€šfridaä¸€æ ·ï¼Œéƒ½æ˜¯è°ƒç”¨jsfrida -U -n akd -l ./fridaStalker_akdSymbol2575.js jså†…éƒ¨é€»è¾‘ æœ€åˆè¦åˆå§‹åŒ–ï¼šè®¡ç®—å‡ºå½“å‰è¦hookçš„å‡½æ•°æ‰€å±çš„æ¨¡å—å’Œåœ°å€ åœ¨æ™®é€šçš„Interceptor.attachçš„onEnterä¸­ï¼ŒåŠ ä¸ŠStalker.follow åœ¨transformä¸­ï¼Œè®¡ç®—æ˜¯å¦æ˜¯åŸå§‹å‡½æ•°çš„ä»£ç  å¦‚æœæ˜¯ï¼Œå†å»ï¼šå®ç°ç‰¹å®šçš„è°ƒè¯•çš„ç›®çš„ æ‰“å°çœŸå®æ‰§è¡Œçš„æŒ‡ä»¤çš„ä¿¡æ¯instruction.toString() æ‰“å°å½“æ—¶çš„å˜é‡çš„å€¼context ç­‰ç­‰ è¯¦è§£ ä¸¾ä¾‹ Stalkerç¤ºä¾‹ä»£ç  ä½•æ—¶éœ€è¦ç”¨åˆ°Fridaçš„Stalker å¦‚ä¸‹åœºæ™¯ï¼š ä½ æƒ³è¦ææ‡‚è¯¥å‡½æ•°å†…éƒ¨çš„æ‰§è¡Œçš„é€»è¾‘ï¼Œæƒ³è¦æŸ¥çœ‹å“ªä¸ªå‡½æ•°ï¼Œç”šè‡³æ˜¯å“ªä¸ªä»£ç å—codeblockï¼Œè¢«æ‰§è¡Œäº† è¿˜æ¯”å¦‚ä½ æƒ³è¦ææ‡‚ï¼Œå½“ä¼ å…¥ä¸åŒå‚æ•°æ—¶ï¼Œå‡½æ•°å†…éƒ¨ä»£ç æ‰§è¡Œçš„æµç¨‹è·¯å¾„ï¼Œæ˜¯å¦æœ‰ä½•ä¸åŒã€‚ å°±å¯ä»¥å»ç”¨ï¼š Stalker.follow() Fridaçš„Stalkerä¸­transformçš„é€»è¾‘ Fridaçš„Stalkerä¸­transformçš„é€»è¾‘ï¼š é™¤äº†å®˜ç½‘æ–‡æ¡£ï¼š https://frida.re/docs/stalker/ ä»‹ç»äº†å†…éƒ¨å…·ä½“å®ç°æœºåˆ¶å’Œè¿‡ç¨‹ä¹‹å¤–ï¼š å¯¹äºï¼Œæƒ³è¦ææ‡‚å¦‚ä½•åˆ©ç”¨transformå»è°ƒè¯•ä»£ç æ¥è¯´ï¼š éœ€è¦æ˜ç™½çš„é€»è¾‘æ˜¯ï¼š æ­¤å¤„ä»£ç ï¼š Interceptor.attach(funcRealStartAddr, { onEnter: function(args) { ... var curTid = Process.getCurrentThreadId(); console.log(\"curTid=\", curTid); Stalker.follow(curTid, { events: { call: true, // CALL instructions: yes please ret: false, // RET instructions exec: false, // all instructions: not recommended as it's block: false, // block executed: coarse execution trace compile: false // block compiled: useful for coverage }, // transform: (iterator: StalkerArm64Iterator) => { transform: function (iterator) { ... è§¦å‘åˆ°çš„transformçš„iteratoræ¥è¯´ï¼š æ¯æ¬¡è§¦å‘=æ¯ä¸ªiteratorï¼šéƒ½ï¼ˆå¯¹åº”ç€ï¼‰å•ä¸ªblock=ï¼ˆbasicï¼‰ä»£ç å— æ­¤å¤„ä»£ç å—æœ‰2ç§ éåŸå§‹å‡½æ•°ä»£ç  == isAppCode=false å¯¹åº”ç€åº”è¯¥æ˜¯Stalkerå†…éƒ¨å®ç°åŸç†è¯´çš„ï¼Œcopyæ‹·è´å‡ºçš„ä»£ç  å…¶ä¸­ä¼šé¢å¤–åŠ ä¸Šå¾ˆå¤šé€»è¾‘ï¼Œç”¨äºå®ç°Stalkerçš„åŠŸèƒ½å’Œé€»è¾‘ ä¼°è®¡å°±æ˜¯è¿™é‡Œè¯´çš„è¿™äº›å†…å®¹ [åŸåˆ›] sktraceï¼šåŸºäº Frida Stalker çš„ trace å·¥å…·-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com æ¯å½“æ‰§è¡Œåˆ°ä¸€ä¸ªåŸºæœ¬å—ï¼ŒStalker éƒ½ä¼šåšä»¥ä¸‹å‡ ä»¶äº‹ï¼š å¯¹äºæ–¹æ³•è°ƒç”¨ï¼Œä¿å­˜ lr ç­‰å¿…è¦ä¿¡æ¯ é‡å®šä½ä½ç½®ç›¸å…³æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼šADR Xd, label å»ºç«‹æ­¤å—çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤å—åœ¨è¾¾åˆ°å¯ä¿¡é˜ˆå€¼åï¼Œå†…å®¹æœªæ›¾å˜åŒ–ï¼Œä¸‹æ¬¡å°†ä¸å†é‡æ–°ç¼–è¯‘ï¼ˆä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼‰ æ ¹æ® transform å‡½æ•°ï¼Œç¼–è¯‘ç”Ÿæˆä¸€ä¸ªæ–°çš„åŸºæœ¬å— GumExecBlock ï¼Œä¿å­˜åˆ° GumSlab ã€‚void transform(GumStalkerIterator iterator, GumStalkerOutput output, gpointer user_data) å¯ä»¥æ§åˆ¶è¯»å–ï¼Œæ”¹åŠ¨ï¼Œå†™å…¥æŒ‡ä»¤ã€‚ transform è¿‡ç¨‹ä¸­è¿˜å¯é€šè¿‡ void gum_stalker_iterator_put_callout (GumStalkerIterator self,GumStalkerCallout callout, gpointer data, GDestroyNotify data_destroy) æ¥è®¾ç½®ä¸€ä¸ªå½“æ­¤ä½ç½®è¢«æ‰§è¡Œåˆ°æ—¶çš„ calloutã€‚é€šè¿‡æ­¤ void callout(GumCpuContext cpu_context, gpointer user_data) è·å– cpu ä¿¡æ¯ã€‚ æ‰§è¡Œä¸€ä¸ªåŸºæœ¬å¿« GumExecBlockï¼Œå¼€å§‹ä¸‹ä¸€ä¸ªåŸºæœ¬å¿« æ‰€ä»¥æ— éœ€æ“ä½œå…·ä½“å†…éƒ¨è¿‡ç¨‹ï¼Œç›´æ¥å¿½ç•¥å³å¯ åŸå§‹å‡½æ•°ä»£ç  == isAppCode=true æ˜¯å®é™…è¿è¡Œçš„ä»£ç ï¼Œæ‰æ˜¯æˆ‘ä»¬æ‰€è¦å…³æ³¨çš„ä»£ç  æ‰ä¼šçœŸæ­£çš„å»å¤„ç†ï¼šæ¯”å¦‚åˆ¤æ–­æ˜¯å¦æ˜¯å¯¹åº”çš„ï¼ˆæŸä¸ªåç§»é‡çš„ï¼‰ä»£ç ï¼Œç„¶åå»æ‰“å°æŸ¥çœ‹è°ƒè¯•å¯„å­˜å™¨çš„å€¼ç­‰ç­‰ æ­¤å¤„å»é€šè¿‡è®¡ç®—æ˜¯å¦æ˜¯ åŸå§‹å‡½æ•°ä»£ç isAppCode å†³å®šæ˜¯å¦å¤„ç† å…·ä½“è¯¦è§ç¤ºä¾‹ä»£ç ï¼š___lldb_unnamed_symbol2575$$akd Stalker.followä¸­çš„eventsçš„å±æ€§å«ä¹‰ Stalker.followä¸­çš„eventsçš„å±æ€§å«ä¹‰ æ¦‚è¿° Stalker.followä¸­çš„eventsä¸­æŸä¸ªå±æ€§æ˜¯trueï¼Œå«ä¹‰æ˜¯ï¼šå½“å‡ºç°å¯¹åº”æŒ‡ä»¤ï¼Œåˆ™è§¦å‘å¯¹åº”eventäº‹ä»¶ è¯¦è§£ å±æ€§ å¯¹åº”çš„å±æ€§çš„å«ä¹‰æ˜¯ callï¼šcallæŒ‡ä»¤ Intelçš„ï¼šcallæŒ‡ä»¤ ARMçš„ï¼šBLç±»çš„æŒ‡ä»¤ æ™®é€šçš„=arm64çš„ï¼šBLã€BLRç­‰ arm64eçš„ï¼Œå¸¦PACçš„ï¼šBLRAAã€BLRAAZã€BLRABã€BLRABZç­‰ retï¼šretæŒ‡ä»¤ execï¼šæ‰€æœ‰æŒ‡ä»¤ blockï¼šï¼ˆå•ä¸ªï¼‰blockçš„ï¼ˆæ‰€æœ‰ï¼‰æŒ‡ä»¤ compileï¼šç‰¹æ®Šï¼Œï¼ˆå•ä¸ªï¼‰blockè¢«ç¼–è¯‘æ—¶ï¼Œä»…ç”¨äºæµ‹è¯•ä»£ç è¦†ç›–ç‡ï¼Ÿ é™¤å»ç‰¹æ®Šçš„compileå‚æ•°ï¼Œå…¶ä»–å‡ ä¸ªå‚æ•°ï¼ŒæŒ‰ç…§èŒƒå›´å¤§å°å»åˆ’åˆ†ï¼Œæ›´å®¹æ˜“ç†è§£ï¼š execï¼šæ‰€æœ‰ä»£ç çš„çº§åˆ« blockï¼šå•ä¸ªä»£ç å—çš„çº§åˆ« æŸäº›ç‰¹æ®ŠæŒ‡ä»¤çš„çº§åˆ« callï¼šå•ç‹¬çš„callæŒ‡ä»¤ retï¼šå•ç‹¬çš„retæŒ‡ä»¤ eventäº‹ä»¶ ä¼šè§¦å‘onReceive(events)å‡½æ•° å…¶ä¸­å¯ä»¥eventsæ˜¯äºŒè¿›åˆ¶ï¼ˆçš„blobï¼‰ï¼Œéœ€è¦å»ç”¨Stalker.parse()è§£æåæ‰èƒ½çœ‹æ‡‚ -ã€‹eventså’ŒonReceiveçš„ä½œç”¨ æš‚æ—¶ä¸å®Œå…¨æ‡‚ï¼Œåªæ˜¯çŸ¥é“ï¼Œå¯ä»¥è®¾ç½®å‚æ•°ï¼Œå†³å®šcallã€retç­‰æŒ‡ä»¤çš„è§¦å‘æ—¶å»æ‰“å°ï¼Œå…¶ä»–ç”¨é€”æš‚æ—¶ä¸æ¸…æ¥š Stalker.follow()å†…éƒ¨å®ç°åŸç† å½“ç”¨æˆ·è°ƒç”¨Stalker.follow()æ—¶ï¼Œå†…éƒ¨è°ƒç”¨ï¼š è¦ä¹ˆæ˜¯ï¼šgum_stalker_follow_me() ï¼šå»è·Ÿè¸ªå½“å‰çš„çº¿ç¨‹thread å‡½æ•°åŸå‹GUM_API void gum_stalker_follow_me (GumStalker * self, GumStalkerTransformer * transformer, GumEventSink * sink); åº•å±‚JSå¼•æ“ï¼šæ˜¯QuickJSæˆ–V8 è¦ä¹ˆæ˜¯ï¼šgum_stalker_follow(thread_id)ï¼šå»è·Ÿè¸ªå½“å‰processè¿›ç¨‹ä¸­çš„å…¶ä»–æŸä¸ªçº¿ç¨‹thread gum_stalker_follow_meçš„å†…éƒ¨åŸç† #ifdef __APPLE__ .globl _gum_stalker_follow_me _gum_stalker_follow_me: #else .globl gum_stalker_follow_me .type gum_stalker_follow_me, %function gum_stalker_follow_me: #endif stp x29, x30, [sp, -16]! mov x29, sp mov x3, x30 #ifdef __APPLE__ bl __gum_stalker_do_follow_me #else bl _gum_stalker_do_follow_me #endif ldp x29, x30, [sp], 16 br x0 -ã€‹ å†…éƒ¨åŸç† LR=Link Register=X30=é“¾æ¥å¯„å­˜å™¨ AArch64æ¶æ„ä¸­ï¼Œæ ¹æ®LRå»å†³å®šä»å“ªé‡Œå¼€å§‹è·Ÿè¸ª å½“é‡åˆ°BRï¼ŒBLRç­‰è·³è½¬æŒ‡ä»¤æ—¶ï¼Œä¼šå»è®¾ç½®LR LRè¢«è®¾ç½®ä¸ºï¼Œå½“å‰å‡½æ•°è¿”å›åï¼Œç»§ç»­è¿è¡Œçš„åœ°å€ ç”±äºåªæœ‰ä¸€ä¸ªLRï¼Œå¦‚æœè¢«è°ƒç”¨å‡½æ•°è°ƒç”¨äº†å…¶ä»–å‡½æ•°ï¼Œæ­¤æ—¶LRçš„å€¼å°±ä¼šè¢«ä¿å­˜èµ·æ¥ï¼Œæ¯”å¦‚ä¿å­˜åˆ°Stackæ ˆä¸Šï¼Œåç»­å½“RETæŒ‡ä»¤æ‰§è¡Œä¹‹å‰ï¼Œä¼šé‡æ–°æŠŠLRä»Stackæ ˆä¸­åŠ è½½åˆ°å¯„å­˜å™¨ä¸­ï¼Œæœ€ç»ˆè¿”å›åˆ°è°ƒç”¨è€… FP=Frame Pointer=X29=å¸§æŒ‡é’ˆ FPå§‹ç»ˆæŒ‡å‘Stack topæ ˆçš„é¡¶éƒ¨ï¼Œè¡¨ç¤ºå½“å‰å‡½æ•°è¢«è°ƒç”¨æ—¶çš„æ ˆçš„ä½ç½® æ‰€ä»¥å°±å¯ä»¥é€šè¿‡å›ºå®šçš„åç§»é‡å»è®¿é—®åˆ°ï¼Œæ‰€æœ‰é€šè¿‡Stackæ ˆä¼ å…¥çš„å‚æ•°å’ŒåŸºäºæ ˆçš„å±€éƒ¨å˜é‡ ä¸”æ¯ä¸ªå‡½æ•°éƒ½æœ‰è‡ªå·±çš„FPï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨æ–°å‡½æ•°æ—¶ï¼Œä¿å­˜ä¹‹å‰çš„FPï¼Œè¿”å›ä¹‹å‰å‡½æ•°æ—¶ï¼Œæ¢å¤FPã€‚ åœ¨åˆšè¿›å…¥æ–°å‡½æ•°åï¼Œå¤‡ä»½FPåï¼Œå°±å¯ä»¥å»è®¾ç½®ï¼šmov x29, spï¼ŒæŠŠSPç»™X29=FPäº†ã€‚ ä¿æŒäº†åŸå…ˆä¼ å…¥x0-x2çš„3ä¸ªå‚æ•°ï¼Œé¢å¤–åŠ ä¸Šx3=x30=LRï¼Œæ‰€ä»¥å†å»è°ƒç”¨å‡½æ•°ï¼Œå°±å¯¹åº”ä¸Šå‚æ•°äº†ï¼š gpointer_gum_stalker_do_follow_me (GumStalker * self, GumStalkerTransformer * transformer, GumEventSink * sink, gpointer ret_addr) gum_stalker_followçš„å†…éƒ¨åŸç† å’Œgum_stalker_follow_me()ç±»ä¼¼ï¼Œä½†æœ‰é¢å¤–å‚æ•°ï¼šthread_id void gum_stalker_follow (GumStalker * self, GumThreadId thread_id, GumStalkerTransformer * transformer, GumEventSink * sink) { if (thread_id == gum_process_get_current_thread_id ()) { gum_stalker_follow_me (self, transformer, sink); } else { GumInfectContext ctx; ctx.stalker = self; ctx.transformer = transformer; ctx.sink = sink; gum_process_modify_thread (thread_id, gum_stalker_infect, &ctx); } } å…¶ä¸­ï¼šgum_process_modify_thread()ï¼Œä¸å±äºStalkerï¼Œä½†å±äºGum å›è°ƒcallbackä¼šå»ä¿®æ”¹ï¼šGumCpuContext GumCpuContext GumCpuContextçš„å®šä¹‰ï¼š typedef GumArm64CpuContext GumCpuContext; struct _GumArm64CpuContext { guint64 pc; guint64 sp; guint64 x[29]; guint64 fp; guint64 lr; guint8 q[128]; }; ç›¸å…³ï¼š static void gum_stalker_infect (GumThreadId thread_id, GumCpuContext * cpu_context, gpointer user_data) gum_process_modify_thread() å†…éƒ¨å®ç° Linux/Androidï¼šptrace GDBä¹Ÿç”¨çš„è¿™ä¸ªï¼šæŒ‚è½½åˆ°è¿›ç¨‹ä¸Šï¼Œè¯»å†™å¯„å­˜å™¨ Stalkeræ¯æ¬¡åªå¤„ç†ä¸€ä¸ªä»£ç å—block å†…éƒ¨æœºåˆ¶ï¼š æ–°ç”³è¯·ä¸€å—å†…å­˜ï¼Œå†™å…¥ç»™åŸå§‹ä»£ç ä¸­åŠ äº†è°ƒè¯•ä»£ç åçš„ä»£ç  åŠ çš„æŒ‡ä»¤ï¼Œç”¨äºç”Ÿæˆäº‹ä»¶ã€æä¾›å…¶ä»–Stalkeræ‰€æ”¯æŒçš„åŠŸèƒ½ã€‚ ä»¥åŠæ ¹æ®æƒ…å†µå»relocateé‡å®šä½æŒ‡ä»¤ä»£ç ã€‚ æ¯”å¦‚å¯¹äºä¸‹é¢ä»£ç ï¼Œè¦é‡å®šä½ï¼š ADR Address of label at a PC-relative offset. ADR Xd, label Xd Is the 64-bit name of the general-purpose destination register, in the range 0 to 31. label Is the program label whose address is to be calculated. It is an offset from the address of this instruction, in the range Â±1MB. åº•å±‚é€šè¿‡Gumçš„Relocator frida-gum/gumarm64relocator.c at main Â· frida/frida-gum Â· GitHub ç°åœ¨ï¼Œå›æƒ³ä¸€ä¸‹æˆ‘ä»¬è¯´è¿‡æ½œè¡Œè€…ä¸€æ¬¡å·¥ä½œä¸€ä¸ªå—ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ£€æµ‹ä¸‹ä¸€ä¸ªå—å‘¢ï¼Ÿæˆ‘ä»¬è¿˜è®°å¾—æ¯ä¸ªå—ä¹Ÿä»¥åˆ†æ”¯æŒ‡ä»¤ç»“å°¾ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªåˆ†æ”¯ä»¥åˆ†æ”¯å› Stalker å¼•æ“ï¼Œä½†ç¡®ä¿æˆ‘ä»¬å­˜å‚¨åˆ†æ”¯æ‰“ç®—ç»“æŸçš„ç›®çš„åœ°ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æµ‹ä¸‹ä¸€ä¸ªå—å¹¶åœ¨é‚£é‡Œé‡å®šå‘æ‰§è¡Œã€‚è¿™ä¸ªç›¸åŒçš„ç®€å•è¿‡ç¨‹å¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°ç»§ç»­ã€‚ Stalker=æ½œè¡Œè€… ç°åœ¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½æœ‰ç‚¹æ…¢ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åº”ç”¨ä¸€äº›ä¼˜åŒ–ã€‚é¦–å…ˆï¼Œå¦‚æœæˆ‘ä»¬å¤šæ¬¡æ‰§è¡Œç›¸åŒçš„ä»£ç å—ï¼ˆä¾‹å¦‚å¾ªç¯ï¼Œæˆ–è€…å¯èƒ½åªæ˜¯ä¸€ä¸ªå¤šæ¬¡è°ƒç”¨çš„å‡½æ•°ï¼‰ï¼Œæˆ‘ä»¬ä¸å¿…é‡æ–°æ£€æµ‹å®ƒã€‚æˆ‘ä»¬å¯ä»¥é‡æ–°æ‰§è¡Œç›¸åŒçš„æ£€æµ‹ä»£ç ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬ä¿ç•™äº†ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬ä¹‹å‰é‡åˆ°çš„æ‰€æœ‰å—ä»¥åŠæˆ‘ä»¬æ”¾ç½®å—çš„æ£€æµ‹å‰¯æœ¬çš„ä½ç½®ã€‚ å…¶æ¬¡ï¼Œå½“é‡åˆ°å‘¼å«æŒ‡ä»¤æ—¶ï¼Œåœ¨å‘å‡ºæ£€æµ‹çš„å‘¼å«åï¼Œæˆ‘ä»¬éšåä¼šå‘å‡ºä¸€ä¸ªç€é™†æ¿ï¼Œæˆ‘ä»¬å¯ä»¥è¿”å›è¯¥ç€é™†æ¿è€Œæ— éœ€é‡æ–°è¿›å…¥ Stalkerã€‚Stalkerä½¿ç”¨è®°å½•çœŸå®è¿”å›åœ°å€ï¼ˆreal_addressï¼‰å’Œæ­¤ç€é™†å«ï¼ˆcode_addressï¼‰çš„GumExecFrameç»“æ„æ„å»ºäº†ä¸€ä¸ªä¾§å †æ ˆã€‚å½“ä¸€ä¸ªå‡½æ•°è¿”å›æ—¶ï¼Œæˆ‘ä»¬å‘å‡ºä»£ç ï¼Œè¯¥ä»£ç å°†æ ¹æ®real_addressæ£€æŸ¥ä¾§å †æ ˆä¸­çš„è¿”å›åœ°å€ï¼Œå¦‚æœåŒ¹é…ï¼Œå®ƒå¯ä»¥ç®€å•åœ°è¿”å›åˆ°code_addressï¼Œè€Œæ— éœ€é‡æ–°è¿›å…¥è¿è¡Œæ—¶ã€‚è¿™ä¸ªç€é™†æ¿æœ€åˆå°†åŒ…å«è¿›å…¥ Stalker å¼•æ“ä»¥æ£€æµ‹ä¸‹ä¸€ä¸ªå—çš„ä»£ç ï¼Œä½†ç¨åå¯ä»¥å°†å…¶åå‘ä¿®è¡¥ä»¥ç›´æ¥åˆ†æ”¯åˆ°è¯¥å—ã€‚è¿™æ„å‘³ç€å¯ä»¥å¤„ç†æ•´ä¸ªè¿”å›åºåˆ—ï¼Œè€Œæ— éœ€è¾“å…¥å’Œç¦»å¼€ Stalkerã€‚ å¦‚æœè¿”å›åœ°å€ä¸å­˜å‚¨çš„GumExecFrame real_addressä¸åŒ¹é…ï¼Œæˆ–è€…æˆ‘ä»¬åœ¨ä¾§å †æ ˆä¸­çš„ç©ºé—´ä¸è¶³ï¼Œæˆ‘ä»¬åªéœ€ä»å¤´å¼€å§‹é‡æ–°æ„å»ºä¸€ä¸ªæ–°çš„ã€‚æˆ‘ä»¬éœ€è¦åœ¨åº”ç”¨ç¨‹åºä»£ç æ‰§è¡Œæ—¶ä¿ç•™ LR çš„å€¼ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºä¸èƒ½ä½¿ç”¨å®ƒæ¥æ£€æµ‹ Stalker çš„å­˜åœ¨ï¼ˆåè°ƒè¯•ï¼‰ï¼Œæˆ–è€…å¦‚æœå®ƒå°†å…¶ç”¨äºé™¤ç®€å•è¿”å›ä¹‹å¤–çš„ä»»ä½•å…¶ä»–ç›®çš„ï¼ˆä¾‹å¦‚ï¼Œåœ¨ä»£ç éƒ¨åˆ†ä¸­å¼•ç”¨å†…è”æ•°æ®ï¼‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¸Œæœ› Stalker èƒ½å¤Ÿéšæ—¶å–æ¶ˆå…³æ³¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æƒ³ä¸å¾—ä¸è¿”å›æˆ‘ä»¬çš„å †æ ˆæ¥æ›´æ­£æˆ‘ä»¬åœ¨æ­¤è¿‡ç¨‹ä¸­ä¿®æ”¹çš„ LR å€¼ã€‚ æœ€åï¼Œè™½ç„¶æˆ‘ä»¬æ€»æ˜¯ç”¨å¯¹ Stalker çš„è°ƒç”¨æ¥æ›¿æ¢åˆ†æ”¯ä»¥æ£€æµ‹ä¸‹ä¸€ä¸ªå—ï¼Œä½†æ ¹æ® Stalker.trustThreshold çš„é…ç½®ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¯¹æ­¤ç±»æ£€æµ‹ä»£ç è¿›è¡Œåå‘ä¿®è¡¥ï¼Œä»¥å°†è°ƒç”¨æ›¿æ¢ä¸ºä¸‹ä¸€ä¸ªæ£€æµ‹å—çš„ç›´æ¥åˆ†æ”¯ã€‚ç¡®å®šæ€§åˆ†æ”¯ï¼ˆä¾‹å¦‚ï¼Œç›®çš„åœ°æ˜¯å›ºå®šçš„ï¼Œåˆ†æ”¯ä¸æ˜¯æœ‰æ¡ä»¶çš„ï¼‰å¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥å°†åˆ†æ”¯æ›¿æ¢ä¸ºä¸‹ä¸€ä¸ªå—ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å¤„ç†æ¡ä»¶åˆ†æ”¯ï¼Œå¦‚æœæˆ‘ä»¬æ£€æµ‹ä¸¤ä¸ªä»£ç å—ï¼ˆä¸€ä¸ªæ˜¯åˆ†æ”¯ï¼Œä¸€ä¸ªæ˜¯ä¸æ˜¯ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†åŸå§‹æ¡ä»¶åˆ†æ”¯æ›¿æ¢ä¸ºä¸€ä¸ªæ¡ä»¶åˆ†æ”¯ï¼Œè¯¥æ¡ä»¶åˆ†æ”¯å°†æ§åˆ¶æµå®šå‘åˆ°è·å–åˆ†æ”¯æ—¶é‡åˆ°çš„å—çš„æ£€æµ‹ç‰ˆæœ¬ï¼Œç„¶åæ˜¯å¦ä¸€ä¸ªæ£€æµ‹å—çš„æ— æ¡ä»¶åˆ†æ”¯ã€‚æˆ‘ä»¬è¿˜å¯ä»¥éƒ¨åˆ†å¤„ç†ç›®æ ‡ä¸æ˜¯é™æ€çš„åˆ†æ”¯ã€‚å‡è®¾æˆ‘ä»¬çš„åˆ†æ”¯æ˜¯è¿™æ ·çš„ï¼š BR X0 è¿™ç§æŒ‡ä»¤åœ¨è°ƒç”¨å‡½æ•°æŒ‡é’ˆæˆ–ç±»æ–¹æ³•æ—¶å¾ˆå¸¸è§ã€‚è™½ç„¶ X0 çš„å€¼å¯ä»¥æ›´æ”¹ï¼Œä½†é€šå¸¸å®ƒå®é™…ä¸Šæ€»æ˜¯ç›¸åŒçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ€ç»ˆçš„åˆ†æ”¯æŒ‡ä»¤æ›¿æ¢ä¸ºä»£ç ï¼Œè¯¥ä»£ç å°† X0 çš„å€¼ä¸æˆ‘ä»¬çš„å·²çŸ¥å‡½æ•°è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå®ƒå°†åˆ†æ”¯ä¸ä»£ç çš„æ£€æµ‹å‰¯æœ¬çš„åœ°å€åŒ¹é…ã€‚ç„¶åï¼Œå¦‚æœä¸åŒ¹é…ï¼Œåˆ™å¯ä»¥å°†æ— æ¡ä»¶åˆ†æ”¯è¿”å›åˆ° Stalker å¼•æ“ã€‚å› æ­¤ï¼Œå¦‚æœå‡½æ•°æŒ‡é’ˆ say çš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆä»£ç ä»ç„¶æœ‰æ•ˆï¼Œæ— è®ºæˆ‘ä»¬æœ€ç»ˆåˆ°è¾¾å“ªé‡Œï¼Œæˆ‘ä»¬éƒ½å°†é‡æ–°è¾“å…¥ Stalker å’Œä¹å™¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœå¦‚æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·å®ƒä¿æŒä¸å˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®Œå…¨ç»•è¿‡ Stalker å¼•æ“å¹¶ç›´æ¥è¿›å…¥ä»ªå™¨åŒ–åŠŸèƒ½ã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-25 23:53:53 "},"use_frida/frida_trace/":{"url":"use_frida/frida_trace/","title":"frida-trace","keywords":"","body":"frida-trace frida-trace å®˜ç½‘æ–‡æ¡£ frida-trace å®˜ç½‘ä»£ç  frida-tools/frida_tools/tracer.py æ ¸å¿ƒå‚æ•°è§£é‡Š è°ƒè¯•ç›®æ ‡æ–¹å¼ frida-traceå»hookè°ƒè¯•çš„ç›®æ ‡çš„å†™æ³•ï¼Œæ˜¯å’Œfridaæ˜¯ä¸€æ ·çš„ è¯¦è§ï¼šfridaè°ƒè¯•ç›®æ ‡æ–¹å¼ é€šç”¨é€»è¾‘ -mã€-Mç­‰å‚æ•°ï¼Œæ”¯æŒé€šé…ç¬¦ *ï¼šè¡¨ç¤ºä»»æ„ä¸ªæ•°çš„å­—ç¬¦=æ‰€æœ‰çš„ï¼ˆç±»æˆ–æ–¹æ³•åï¼‰ ä¸¾ä¾‹-m \"-[NSURL *]\" // åŒ¹é…NSURLç±»çš„æ‰€æœ‰å®ä¾‹æ–¹æ³• -m \"+[NSURL *]\" // åŒ¹é…NSURLç±»çš„æ‰€æœ‰ç±»æ–¹æ³• -m \"*[NSURL *]\" // åŒ¹é…NSURLç±»çš„æ‰€æœ‰æ–¹æ³• -m \"*[*URL *]\" // åŒ¹é…ä»¥URLç»“å°¾ç±»çš„æ‰€æœ‰æ–¹æ³• -m \"*[URL* *]\" // åŒ¹é…ä»¥URLå¼€å¤´ç±»çš„æ‰€æœ‰æ–¹æ³• -m \"*[*URL* *]\" // åŒ¹é…åŒ…å«URLçš„ç±»çš„æ‰€æœ‰æ–¹æ³• -m \"*[*URL* *login*]\" // åŒ¹é…åŒ…å«URLçš„ç±»çš„å¸¦loginçš„æ‰€æœ‰æ–¹æ³• æ³¨æ„ ä¸æ”¯æŒï¼š? å¦‚æœç”¨äº†?ï¼Œåˆ™ä¼šæŠ¥é”™ï¼šError: invalid query; format is: -[NS*Number foo:bar:], +[Foo foo*] or *[Bar baz] å‚æ•° -m è¯­æ³•ï¼š-m OBJC_METHOD, --include-objc-method OBJC_METHOD include OBJC_METHOD å«ä¹‰ï¼šï¼ˆè¦å»hookçš„ï¼‰åŒ…å«çš„ObjCçš„ï¼ˆç±»å’Œï¼‰æ–¹æ³• -M è¯­æ³•ï¼š-M OBJC_METHOD, --exclude-objc-method OBJC_METHOD exclude OBJC_METHOD å«ä¹‰ï¼šï¼ˆ ä¸è¦hookçš„ï¼‰æ’é™¤æ‰çš„ObjCçš„ï¼ˆç±»å’Œï¼‰æ–¹æ³• -O è¯­æ³•ï¼š-O FILE, --options-file FILE text file containing additional command line options å«ä¹‰ï¼šç”¨Optionæ–‡ä»¶ï¼ŒåŒ…å«é¢å¤–çš„å‘½ä»¤è¡Œå‚æ•° å…¸å‹ç”¨æ³•æ˜¯ï¼Œè§‰å¾—-mã€-Mç­‰è¦å»hookå’Œè¦å»æ’é™¤æ‰çš„ç±»å’Œæ–¹æ³•ï¼Œå¤ªå¤šäº†ï¼Œå°±è½¬å»æ”¾åˆ°Optionæ–‡ä»¶ä¸­ ä¸¾ä¾‹ æ¦‚è¿° hookè°ƒè¯•Preferencesï¼š-mã€-Mç­‰å‚æ•°ç›´æ¥æ”¾åˆ°å‘½ä»¤è¡Œä¸­ hookå•ä¸ªçš„ç±»ï¼šAAUISignInViewControllerfrida-trace -U -F com.apple.Preferences -m \"*[AAUISignInViewController *]\" ï¼ˆç”¨*åŒ¹é…ï¼‰å»hookå¤šä¸ªç±»ï¼Œä¸”æ’é™¤ç‰¹å®šï¼ˆå®é™…ä¸Šä¼šè¾“å‡ºå¾ˆå¤šæ¬¡ä½†å¯¹è°ƒè¯•é€»è¾‘æ²¡å¸®åŠ©ï¼‰çš„å‡½æ•°frida-trace -U -F com.apple.Preferences -m \"*[AA* *]\" -M \"-[ASDBundle copyWithZone:]\" -M \"-[* copyWithZone:]\" -M \"-[AAUILabel *]\" é€šç”¨å‚æ•°å«ä¹‰è¯´æ˜ -U -F com.apple.Preferencesï¼šè°ƒè¯•ç›®æ ‡è®¾å¤‡å’Œç›®æ ‡appæ˜¯å’Œfridaå†™æ³•ä¸€è‡´ -Uï¼šè°ƒè¯•è®¾å¤‡æ˜¯ï¼ˆMacä¸­é€šè¿‡ï¼‰USBè¿æ¥çš„iPhone -F com.apple.Preferencesï¼šè°ƒè¯•çš„appæ˜¯å½“å‰iPhoneä¸­ï¼Œæœ€å‰ç«¯æ‰€æ˜¾ç¤ºçš„app = è®¾ç½®app = åŒ…åæ˜¯com.apple.Preferences ä½†æ˜¯åç»­è¦traceçš„å‡½æ•°å†™æ³•ï¼Œæ˜¯frida-traceæ‰€ç‰¹æœ‰çš„è¯­æ³• -m xxxï¼šinclude=åŒ…å«è¦è°ƒè¯•çš„Objcçš„ç±» -M xxxï¼šexclue=æ’é™¤æ‰Objcçš„ç±»ï¼Œä¸è°ƒè¯• hookè°ƒè¯•akdï¼šè§‰å¾—-mã€-Mç­‰å‚æ•°å¤ªå¤šï¼Œåˆ™æ”¾åˆ°-Oçš„Optionæ–‡ä»¶ä¸­frida-trace -U -n akd -O akdObjcMethods.txt Optionæ–‡ä»¶akdObjcMethods.txt-m \"*[AA* *]\" -m \"*[AK* *]\" -m \"*[AS* *]\" -m \"*[NSXPC* *]\" -M \"-[NSXPC*coder *]\" -M \"-[NSXPCConnection replacementObjectForEncoder:object:]\" ä¸€äº›ç”¨æ³•frida-trace -U -i \"CCCryptorCreate*\" Twitter frida-trace --decorate -i \"recv*\" -i \"send*\" Safari frida-trace -m \"-[NSView drawRect:]\" Safari frida-trace -U -f com.toyopagroup.picaboo -I \"libcommonCrypto*\" frida-trace -U -f com.google.android.youtube --runtime=v8 -j '*!*certificate*/isu' frida-trace -U -i \"Java_*\" com.samsung.faceservice frida-trace -p 1372 -i \"msvcrt.dll!*mem*\" frida-trace -p 1372 -i \"*open*\" -x \"msvcrt.dll!*open*\" frida-trace -p 1372 -a \"libjpeg.so!0x4793c\" è¯¦è§ frida-traceçš„iOSçš„ObjCçš„ä¸¾ä¾‹ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-10-26 09:06:38 "},"use_frida/frida_trace/help.html":{"url":"use_frida/frida_trace/help.html","title":"helpè¯­æ³•","keywords":"","body":"frida-traceçš„helpè¯­æ³• âœ ~ frida-trace --help usage: frida-trace [options] target positional arguments: args extra arguments and/or target options: -h, --help show this help message and exit -D ID, --device ID connect to device with the given ID -U, --usb connect to USB device -R, --remote connect to remote frida-server -H HOST, --host HOST connect to remote frida-server on HOST --certificate CERTIFICATE speak TLS with HOST, expecting CERTIFICATE --origin ORIGIN connect to remote server with â€œOriginâ€ header set to ORIGIN --token TOKEN authenticate with HOST using TOKEN --keepalive-interval INTERVAL set keepalive interval in seconds, or 0 to disable (defaults to -1 to auto-select based on transport) --p2p establish a peer-to-peer connection with target --stun-server ADDRESS set STUN server ADDRESS to use with --p2p --relay address,username,password,turn-{udp,tcp,tls} add relay to use with --p2p -f TARGET, --file TARGET spawn FILE -F, --attach-frontmost attach to frontmost application -n NAME, --attach-name NAME attach to NAME -N IDENTIFIER, --attach-identifier IDENTIFIER attach to IDENTIFIER -p PID, --attach-pid PID attach to PID -W PATTERN, --await PATTERN await spawn matching PATTERN --stdio {inherit,pipe} stdio behavior when spawning (defaults to â€œinheritâ€) --aux option set aux option when spawning, such as â€œuid=(int)42â€ (supported types are: string, bool, int) --realm {native,emulated} realm to attach in --runtime {qjs,v8} script runtime to use --debug enable the Node.js compatible script debugger --squelch-crash if enabled, will not dump crash report to console -O FILE, --options-file FILE text file containing additional command line options --version show program's version number and exit -I MODULE, --include-module MODULE include MODULE -X MODULE, --exclude-module MODULE exclude MODULE -i FUNCTION, --include FUNCTION include [MODULE!]FUNCTION -x FUNCTION, --exclude FUNCTION exclude [MODULE!]FUNCTION -a MODULE!OFFSET, --add MODULE!OFFSET add MODULE!OFFSET -T INCLUDE_IMPORTS, --include-imports INCLUDE_IMPORTS include program's imports -t MODULE, --include-module-imports MODULE include MODULE imports -m OBJC_METHOD, --include-objc-method OBJC_METHOD include OBJC_METHOD -M OBJC_METHOD, --exclude-objc-method OBJC_METHOD exclude OBJC_METHOD -j JAVA_METHOD, --include-java-method JAVA_METHOD include JAVA_METHOD -J JAVA_METHOD, --exclude-java-method JAVA_METHOD exclude JAVA_METHOD -s DEBUG_SYMBOL, --include-debug-symbol DEBUG_SYMBOL include DEBUG_SYMBOL -q, --quiet do not format output messages -d, --decorate add module name to generated onEnter log statement -S PATH, --init-session PATH path to JavaScript file used to initialize the session -P PARAMETERS_JSON, --parameters PARAMETERS_JSON parameters as JSON, exposed as a global named 'parameters' -o OUTPUT, --output OUTPUT dump messages to file crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-10-26 09:06:45 "},"use_frida/frida_tools/":{"url":"use_frida/frida_tools/","title":"frida-tools","keywords":"","body":"frida-tools frida-toolæ˜¯Fridaçš„ä¸€å¥—å·¥å…·çš„é›†åˆï¼ŒåŒ…æ‹¬ï¼š ç›¸å¯¹å¸¸ç”¨çš„ frida-trace frida-ps frida-ls ä¸å¤ªå¸¸ç”¨çš„ frida-apk frida-compile frida-create frida-discover frida-join frida-ls-devices frida-kill frida-pull frida-push frida-rm å¯¹åº”æºç æ˜¯ï¼šfrida-tools å®‰è£…frida-tools Macä¸­ç”¨Pythonçš„pip3å»å®‰è£…ï¼š pip3 install frida-tools å…¶ä»–å·¥å…· gum-graft crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 23:20:40 "},"use_frida/frida_tools/frida_ps.html":{"url":"use_frida/frida_tools/frida_ps.html","title":"frida-ps","keywords":"","body":"frida-ps frida-ps æ˜¯frida-toolsä¸­ä¸€ä¸ªå¸¸ç”¨çš„å·¥å…· ä½œç”¨ï¼šæ˜¾ç¤ºç³»ç»Ÿè¿›ç¨‹åˆ—è¡¨ ç±»ä¼¼äºps æ”¯æŒæ˜¾ç¤ºå½“å‰ï¼ˆMacç­‰ï¼‰PCç«¯çš„è¿›ç¨‹å’Œï¼ˆiPhoneç­‰ï¼‰ç§»åŠ¨ç«¯ä¸­çš„è¿›ç¨‹ å®˜ç½‘æ–‡æ¡£ frida-ps ç”¨æ³• æ˜¾ç¤ºå½“å‰PCç«¯è¿›ç¨‹ï¼šä¸åŠ å‚æ•°frida-ps æ˜¾ç¤ºUSBè¿æ¥çš„ï¼ˆiPhoneç­‰ï¼‰ç§»åŠ¨ç«¯çš„ï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰æ‰€æœ‰è¿›ç¨‹ï¼Œè¿›ç¨‹ï¼š-Ufrida-ps -U æ˜¾ç¤ºUSBè¿æ¥çš„ï¼ˆiPhoneç­‰ï¼‰ç§»åŠ¨ç«¯çš„æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„è¿›ç¨‹ï¼š-Ua = USB + only (running) applicationsfrida-ps -Ua æ˜¾ç¤ºUSBè¿æ¥çš„ï¼ˆiPhoneç­‰ï¼‰ç§»åŠ¨ç«¯çš„åº”ç”¨ç¨‹åºçš„å·²å®‰è£…çš„å…¨éƒ¨ï¼ˆæ­£åœ¨è¿è¡Œå’Œæ²¡æœ‰è¿è¡Œï¼‰çš„åº”ç”¨ç¨‹åºçš„è¿›ç¨‹ï¼š-Uai = USB + only (running) applications + (not runnning but) installedfrida-ps -Uai å¦å¤–ï¼š å¯ä»¥åŠ grepå»æœç´¢ç‰¹å®šapp ä¸¾ä¾‹âœ frida-ps -Ua | grep -i preferences 46847 è®¾ç½® com.apple.Preferences ä¸¾ä¾‹ frida-ps âœ ~ frida-ps PID Name --- ------------------------------------------------------------ ... 1205 weatherd 639 wifianalyticsd 612 wifip2pd 913 wifivelocityd 11153 wine64-preloader ... 11120 wineserver 633 writeconfig 17438 xpcroleaccountd ... 94172 zsh frida-ps -U crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_tool/reverse_security/iOS/palera1n î‚° frida-ps -U PID Name --- ------------------------------------------------------------ 262 App Store 328 Filza 260 GTA Car Tracker 261 Safariæµè§ˆå™¨ 291 Shadowrocket 350 Sileo 265 TrollStore 316 palera1n 234 å¾®ä¿¡ 315 æˆªå± 312 æœç´¢ 264 æ’­å®¢ 263 è®¾ç½® 100 ACCHWComponentAuthService 339 ASPCarryLog 230 AppPredictionIntentsHelperService 252 AppSSODaemon 81 AppleCredentialManagerDaemon 140 BlueTool 219 CAReportingService 335 CMFSyncAgent 276 CacheDeleteAppContainerCaches 285 CacheDeleteExtension 307 CategoriesService 237 CategoriesService 214 CategoriesService 187 CategoriesService 119 CloudKeychainProxy 91 CommCenter 185 CommCenterMobileHelper 188 ContextService 322 EnforcementService ... frida-ps -Ua âœ ~ frida-ps -Ua PID Name Identifier 5 --------- ----------------------- 27692 Sileo org.coolstar.SileoStore 23650 å¾®ä¿¡ com.tencent.xin 11941 æ—¥å† com.apple.mobilecal 19641 è®¾ç½® com.apple.Preferences frida-ps -Uai âœ ~ frida-ps -Uai PID Name Identifier 5 ------------------- ------------------------------------- 27692 Sileo org.coolstar.SileoStore 23650 å¾®ä¿¡ com.tencent.xin 11941 æ—¥å† com.apple.mobilecal 19641 è®¾ç½® com.apple.Preferences - App Store com.apple.AppStore - Apple Store com.apple.store.Jolly - CocoaTop ru.domo.cocoatop64 - FaceTimeé€šè¯ com.apple.facetime - Filza com.tigisoftware.Filza - GTA Car Tracker com.icraze.gtatracker - Safariæµè§ˆå™¨ com.apple.mobilesafari - Shadowrocket com.liguangming.Shadowrocket - ShowSystemInfo com.crifan.ShowSystemInfo - Substitute com.ex.substitute.settings - TrollStore com.opa334.TrollStore - Watch com.apple.Bridge - iTunes Store com.apple.MobileStore - palera1n com.llsc12.palera1nLoader - ä¿¡æ¯ com.apple.MobileSMS - å¥åº· com.apple.Health - åé¦ˆ com.apple.appleseed.FeedbackAssistant - å›¾ä¹¦ com.apple.iBooks - åœ°å›¾ com.apple.Maps - å¤‡å¿˜å½• com.apple.mobilenotes - å¤©æ°” com.apple.weather - å®¶åº­ com.apple.Home - å¿«æ·æŒ‡ä»¤ com.apple.shortcuts - æŒ‡å—é’ˆ com.apple.compass - æç¤º com.apple.tips - æé†’äº‹é¡¹ com.apple.reminders - æ’­å®¢ com.apple.podcasts - æ”¾å¤§å™¨ com.apple.Magnifier - æ–‡ä»¶ com.apple.DocumentsApp - æ—¶é’Ÿ com.apple.mobiletimer - æŸ¥æ‰¾ com.apple.findmy - æµ‹è·ä»ª com.apple.measure - ç…§ç‰‡ com.apple.mobileslideshow - çˆ±æ€å…¨èƒ½ç‰ˆ com.ownbook.notes - ç”µè¯ com.apple.mobilephone - ç›¸æœº com.apple.camera - ç¿»è¯‘ com.apple.Translate - è‚¡å¸‚ com.apple.stocks - è§†é¢‘ com.apple.tv - è®¡ç®—å™¨ com.apple.calculator - è¯­éŸ³å¤‡å¿˜å½• com.apple.VoiceMemos - é€šè®¯å½• com.apple.MobileAddressBook - é‚®ä»¶ com.apple.mobilemail - é’±åŒ… com.apple.Passbook - éŸ³ä¹ com.apple.Music è¯­æ³•help âœ ~ frida-ps --help usage: frida-ps [options] options: -h, --help show this help message and exit -D ID, --device ID connect to device with the given ID -U, --usb connect to USB device -R, --remote connect to remote frida-server -H HOST, --host HOST connect to remote frida-server on HOST --certificate CERTIFICATE speak TLS with HOST, expecting CERTIFICATE --origin ORIGIN connect to remote server with â€œOriginâ€ header set to ORIGIN --token TOKEN authenticate with HOST using TOKEN --keepalive-interval INTERVAL set keepalive interval in seconds, or 0 to disable (defaults to -1 to auto- select based on transport) --p2p establish a peer-to-peer connection with target --stun-server ADDRESS set STUN server ADDRESS to use with --p2p --relay address,username,password,turn-{udp,tcp,tls} add relay to use with --p2p -O FILE, --options-file FILE text file containing additional command line options --version show program's version number and exit -a, --applications list only applications -i, --installed include all installed applications -j, --json output results as JSON crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 23:19:37 "},"use_frida/frida_tools/frida_ls.html":{"url":"use_frida/frida_tools/frida_ls.html","title":"frida-ls","keywords":"","body":"frida-ls frida-ls æ˜¯frida-toolsä¸­ä¸€ä¸ªå·¥å…· ä½œç”¨ï¼šæ˜¾ç¤ºç³»ç»Ÿä¸­çš„æ–‡ä»¶åˆ—è¡¨ ç±»ä¼¼äºls æ”¯æŒï¼šå½“å‰ï¼ˆMacç­‰ï¼‰PCç«¯çš„æ–‡ä»¶å’Œï¼ˆiPhoneç­‰ï¼‰ç§»åŠ¨ç«¯ä¸­çš„æ–‡ä»¶ ç”¨æ³• æ˜¾ç¤ºå½“å‰PCç«¯çš„æ–‡ä»¶ï¼šä¸åŠ å‚æ•°frida-ls æ˜¾ç¤ºUSBè¿æ¥çš„ï¼ˆiPhoneç­‰ï¼‰ç§»åŠ¨ç«¯ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼š-U == USBfrida-ls -U ä¸¾ä¾‹ frida-ls âœ ~ frida-ls drwxr-xr-x 20 root wheel 640 Thu Feb 9 09:39:53 2023 . drwxr-xr-x 20 root wheel 640 Thu Feb 9 09:39:53 2023 .. lrwxr-xr-x 1 root admin 36 Thu Feb 9 09:39:53 2023 .VolumeIcon.icns -> System/Volumes/Data/.VolumeIcon.icns ---------- 1 root admin 0 Thu Feb 9 09:39:53 2023 .file drwxr-xr-x 2 root wheel 64 Thu Feb 9 09:39:53 2023 .vol drwxrwxr-x 45 root admin 1440 Wed Jun 14 14:45:54 2023 Applications drwxr-xr-x 66 root wheel 2112 Fri May 12 19:14:14 2023 Library drwxr-xr-x 10 root wheel 320 Thu Feb 9 09:39:53 2023 System drwxr-xr-x 5 root admin 160 Sat Mar 18 14:26:26 2023 Users drwxr-xr-x 3 root wheel 96 Mon Jun 5 02:34:08 2023 Volumes drwxr-xr-x 39 root wheel 1248 Thu Feb 9 09:39:53 2023 bin drwxrwxr-x 2 root admin 64 Mon Oct 24 06:20:41 2022 cores dr-xr-xr-x 4 root wheel 5127 Sat Mar 18 14:26:04 2023 dev lrwxr-xr-x 1 root wheel 11 Thu Feb 9 09:39:53 2023 etc -> private/etc lrwxr-xr-x 1 root wheel 25 Sat Mar 18 14:27:10 2023 home -> /System/Volumes/Data/home drwxr-xr-x 7 root wheel 224 Mon May 29 03:57:47 2023 opt drwxr-xr-x 6 root wheel 192 Sat Mar 18 14:27:03 2023 private drwxr-xr-x 64 root wheel 2048 Thu Feb 9 09:39:53 2023 sbin lrwxr-xr-x 1 root wheel 11 Thu Feb 9 09:39:53 2023 tmp -> private/tmp drwxr-xr-x 11 root wheel 352 Thu Feb 9 09:39:53 2023 usr lrwxr-xr-x 1 root wheel 11 Thu Feb 9 09:39:53 2023 var -> private/var frida-ls -U æ³¨ï¼šMacä¸­ç”¨USBè¿æ¥çš„æ˜¯ï¼ŒiOS 15.0çš„iPhone8ï¼Œå·²ç”¨palera1nå®ç°rootfulè¶Šç‹± âœ ~ frida-ls -U drwxr-xr-x 26 root wheel 832 Fri May 5 07:03:51 2023 . drwxr-xr-x 26 root wheel 832 Fri May 5 07:03:51 2023 .. -rw-r--r-- 1 mobile staff 6148 Mon Feb 6 03:41:36 2023 .DS_Store drwx------ 2 root wheel 64 Thu Sep 16 05:39:21 2021 .ba ---------- 1 root admin 0 Thu Sep 16 05:39:21 2021 .file drwx------ 2 root wheel 64 Fri May 5 06:58:46 2023 .fseventsd drwx------ 2 root wheel 64 Thu Sep 16 05:39:21 2021 .mb -rw-r--r-- 1 mobile staff 0 Sun Nov 20 01:58:22 2022 .palecursus_strapped -rw-r--r-- 1 root staff 0 Fri May 5 07:03:50 2023 .procursus_strapped drwxrwxr-x 121 root admin 3872 Wed Jun 14 13:34:36 2023 Applications drwxr-xr-x 7 root wheel 306 Thu Sep 16 05:39:46 2021 Developer drwxrwxr-x 26 root admin 832 Thu May 18 15:05:28 2023 Library drwxr-xr-x 5 root wheel 160 Thu Sep 16 05:39:21 2021 System lrwxr-xr-x 1 root wheel 12 Fri May 5 07:03:50 2023 User -> //var/mobile drwxr-xr-x 39 root wheel 1248 Fri May 5 07:40:50 2023 bin drwxr-xr-x 2 root wheel 64 Fri May 5 07:03:50 2023 boot drwxrwxr-x 4 root admin 440 Wed Jun 14 06:35:22 2023 cores dr-xr-xr-x 4 root wheel 1492 Wed Jun 14 06:35:21 2023 dev lrwxr-xr-x 1 root wheel 11 Thu Sep 16 05:39:21 2021 etc -> private/etc drwxr-xr-x 2 root wheel 64 Fri May 5 07:03:50 2023 lib drwxr-xr-x 2 root wheel 64 Fri May 5 07:03:50 2023 mnt drwxr-xr-x 7 root wheel 224 Thu Sep 16 05:39:21 2021 private drwxr-xr-x 24 root wheel 768 Fri May 5 07:39:45 2023 sbin lrwxr-xr-x 1 root wheel 15 Thu Sep 16 05:39:21 2021 tmp -> private/var/tmp drwxr-xr-x 10 root wheel 320 Fri May 5 07:03:49 2023 usr lrwxr-xr-x 1 root admin 11 Thu Sep 16 05:39:21 2021 var -> private/var è¯­æ³•help âœ ~ frida-ls --help usage: frida-ls [options] [FILE]... positional arguments: files files to list information about options: -h, --help show this help message and exit -D ID, --device ID connect to device with the given ID -U, --usb connect to USB device -R, --remote connect to remote frida-server -H HOST, --host HOST connect to remote frida-server on HOST --certificate CERTIFICATE speak TLS with HOST, expecting CERTIFICATE --origin ORIGIN connect to remote server with â€œOriginâ€ header set to ORIGIN --token TOKEN authenticate with HOST using TOKEN --keepalive-interval INTERVAL set keepalive interval in seconds, or 0 to disable (defaults to -1 to auto- select based on transport) --p2p establish a peer-to-peer connection with target --stun-server ADDRESS set STUN server ADDRESS to use with --p2p --relay address,username,password,turn-{udp,tcp,tls} add relay to use with --p2p -O FILE, --options-file FILE text file containing additional command line options --version show program's version number and exit crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-22 22:01:30 "},"use_frida/frida_tools/frida_ls_devices.html":{"url":"use_frida/frida_tools/frida_ls_devices.html","title":"frida-ls-devices","keywords":"","body":"frida-ls-devices å®˜ç½‘æ–‡æ¡£ï¼šfrida-ls-devices ä¸¾ä¾‹ âœ frida-ls-devices Id Type Name OS ---------------------------------------- ------ --------------------------- -------------- local local crifanlideMacBook-Pro.local macOS 13.2.1 abdc0dd961c3cb96f5c4afe109de4eb48b88433a usb iPhone8_150 iPhone OS 15.0 socket remote Local Socket è¯­æ³•help âœ frida-ls-devices --help usage: frida-ls-devices [options] options: -h, --help show this help message and exit -O FILE, --options-file FILE text file containing additional command line options --version show program's version number and exit crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-22 23:19:24 "},"use_frida/other_related/":{"url":"use_frida/other_related/","title":"å…¶ä»–ç›¸å…³","keywords":"","body":"å…¶ä»–ç›¸å…³ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 08:10:11 "},"use_frida/other_related/frida_server.html":{"url":"use_frida/other_related/frida_server.html","title":"frida-server","keywords":"","body":"frida-server è¶Šç‹±æ‰‹æœºiPhoneå®‰è£…Fridaåï¼Œå°±å¯ä»¥é€šè¿‡Fridaæ’ä»¶çš„å·²å®‰è£…æ–‡ä»¶ï¼š çœ‹åˆ°å®‰è£…äº†2ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼š /usr/lib/frida/frida-agent.dylib /usr/sbin/frida-server å…¶ä¸­frida-serverå°±æ˜¯Fridaçš„serverç«¯ frida-serverè¯­æ³•help iPhone11-151:~ root# frida-server --help Usage: frida [OPTION?] Help Options: -h, --help Show help options Application Options: --version Output version information and exit -l, --listen=ADDRESS Listen on ADDRESS --certificate=CERTIFICATE Enable TLS using CERTIFICATE --origin=ORIGIN Only accept requests with ?Origin? header matching ORIGIN (by default any origin will be accepted) --token=TOKEN Require authentication using TOKEN --asset-root=ROOT Serve static files inside ROOT (by default no files are served) -d, --directory=DIRECTORY Store binaries in DIRECTORY -D, --daemonize Detach and become a daemon --policy-softener=system|internal Select policy softener -P, --disable-preload Disable preload optimization -C, --ignore-crashes Disable native crash reporter integration -v, --verbose Be verbose crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-22 22:08:31 "},"frida_example/":{"url":"frida_example/","title":"Fridaç”¨æ³•ä¸¾ä¾‹","keywords":"","body":"Fridaç”¨æ³•ä¸¾ä¾‹ æ¦‚è¿° Fridaä¾‹å­ å®˜ç½‘ Frida CodeShare å…¶ä»– oleavr/frida-agent-example: Example Frida agent written in TypeScript frida-presentations Fridaåœ¨iOSå¹³å°è¿›è¡ŒOCå‡½æ•°hookçš„å¸¸ç”¨æ–¹æ³• | 8Biiit's Blog personal_script/Frida_script at master Â· lich4/personal_script Â· GitHub frida-ios-hook/frida-scripts 0xdea/frida-scripts misc/frida-read-process-memory.py at master Â· poxyran/misc Â· GitHub frida-snippets/README.md at master Â· iddoeldor/frida-snippets Â· GitHub è¯¦è§£ Fridaé€†å‘å®ä¾‹å’Œå·¥å…·å‡½æ•° crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-03-19 09:44:38 "},"summary_note/":{"url":"summary_note/","title":"ç»éªŒå¿ƒå¾—","keywords":"","body":"ç»éªŒå¿ƒå¾— æ­¤å¤„æ•´ç†fridaä¸­çš„ä¸€äº›ç»éªŒå’Œå¿ƒå¾—ã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-23 22:04:58 "},"summary_note/hook_func/":{"url":"summary_note/hook_func/","title":"hookå‡½æ•°","keywords":"","body":"hookå‡½æ•° crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-24 23:42:49 "},"summary_note/hook_func/frida/":{"url":"summary_note/hook_func/frida/","title":"frida","keywords":"","body":"frida crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-24 21:57:15 "},"summary_note/hook_func/frida/interceptor/":{"url":"summary_note/hook_func/frida/interceptor/","title":"Interceptor","keywords":"","body":"Interceptor å¿ƒå¾— é€šè¿‡å‡½æ•°åœ°å€å»hookæ‹¦æˆªå‡½æ•° å·²çŸ¥ï¼šå‡½æ•°çš„ï¼ˆäºŒè¿›åˆ¶å†…åç§»é‡ï¼‰åœ°å€ æƒ³è¦ï¼šå»hookæ‹¦æˆªå‡½æ•° ä¸¾ä¾‹è¯´æ˜ akdä¸­å‡½æ•°___lldb_unnamed_symbol2575$$akdçš„äºŒè¿›åˆ¶å†…åç§»é‡æ˜¯ï¼š0xa0460 æ€è·¯ï¼šåŠ¨æ€è®¡ç®—åŠ ä¸Šæ¨¡å—åçš„çœŸå®å‡½æ•°åœ°å€ï¼Œå†å»hook æ ¸å¿ƒä»£ç ï¼šconsole.log(\"dynamicDebug/frida/scripts/fridaStalker_akdSymbol2575.js\"); // var akdSymbol2575_functionAddress = 0x1000a0460; var akdSymbol2575_functionAddress = 0xa0460; // arm64 akd: ___lldb_unnamed_symbol2575$$akd const moduleName = \"akd\"; const moduleBaseAddress = Module.findBaseAddress(moduleName); console.log(\"moduleName=\", moduleName, \"moduleBaseAddress=\", moduleBaseAddress); const functionRealAddress = moduleBaseAddress.add(akdSymbol2575_functionAddress); console.log(\"functionRealAddress=\", functionRealAddress); Interceptor.attach(functionRealAddress, { onEnter: function(args) { var arg0 = args[0] var arg1 = args[1] var arg2 = args[2] console.log(\"arg0=\" + arg0 + \", arg1=\" + arg1 + \", arg2=\" + arg2); var curTid = Process.getCurrentThreadId(); console.log(\"curTid=\", curTid); ... è¾“å‡ºdynamicDebug/frida/scripts/fridaStalker_akdSymbol2575.js moduleName= akd moduleBaseAddress= 0x102b40000 functionRealAddress= 0x102be0460 arg0=0xfffffffffffffffe, arg1=0x16d346838, arg2=0x16d346838 curTid= 35847 ... å®Œæ•´ä»£ç å’Œè¾“å‡ºï¼Œè¯¦è§ï¼š___lldb_unnamed_symbol2575$$akd onLeaveä¸­å¦‚ä½•è·å–åˆ°selfç±»æœ¬èº«çš„å®ä¾‹å˜é‡ æ€è·¯ï¼šonEnteræ—¶ï¼ŒæŠŠselfå˜é‡èµ‹å€¼ä¿å­˜ç»™this.xxxï¼ŒonLeaveæ—¶å»è¯»å–å³å¯ ä»£ç  Interceptor.attach(curMethod.implementation, { onEnter: function(args) { this.argSelfObj = argSelfObj ... }, onLeave: function (retval) { var retValObj = ObjC.Object(retval); var retValObjStr = retValObj.toString(); console.log(\"onLeave: retValObj=\" + retValObj + \",retValObjStr=\" + retValObjStr) const curSelfObj = this.argSelfObj console.log(\"curSelfObj=\" + curSelfObj) } }) è¾“å‡º==================== -[NSXPCConnection setExportedObject:] ==================== argSelfObj: connection to service named com.apple.accountsd.accountmanager onLeave: retValObj=nil,retValObjStr=nil curSelfObj= connection to service named com.apple.accountsd.accountmanager é—®é¢˜ TypeError: cannot read property 'implementation' of undefined é—®é¢˜ï¼š å†™fridaçš„hookä»£ç è°ƒè¯•ObjCçš„å‡½æ•° function hook_specific_method_of_class(className, funcName) { var hook = ObjC.classes[className][funcName]; Interceptor.attach(hook.implementation, { onEnter: function(args) { console.log(\"[*] Detected call to: \" + className + \" -> \" + funcName); } }); } //Your class name and function name here hook_specific_method_of_class(\"AAUISignInViewController\", \"_nextButtonSelected:\") å§‹ç»ˆæŠ¥é”™ï¼š TypeError: cannot read property 'implementation' of undefined åŸå› ï¼šæ­¤å¤„iOSçš„ObjCçš„å‡½æ•°å_nextButtonSelected:å†™æ³•æœ‰è¯¯ è§£å†³åŠæ³•ï¼šæ”¹ä¸ºæ­£ç¡®çš„å†™æ³•ï¼š- _nextButtonSelected: æ³¨ï¼šæ­¤å¤„çš„ObjCçš„ç±»çš„å‡½æ•°åçš„å†™æ³•ï¼š åŠ ä¸Šç±»å‹æ˜¯classçš„è¿˜æ˜¯instanceï¼Œæ‰€å¯¹åº”çš„åŠ å·=+ è¿˜æ˜¯ å‡å·=-ï¼Œä»¥åŠä¸­é—´å¸¦ä¸Šç©ºæ ¼= ç›¸å…³ä»£ç æ”¹åŠ¨ï¼šhook_specific_method_of_class(\"AAUISignInViewController\", \"- _nextButtonSelected:\") å®Œæ•´ä»£ç è¯¦è§ï¼šå•ä¸ªç±»çš„å•ä¸ªå‡½æ•° fridaå»hookå‡½æ•°æ—¶ç¡®ä¿å·²æ‰§è¡Œå‡½æ•°ä½†ä¸è§¦å‘ä¸è¾“å‡ºæ—¥å¿—log é—®é¢˜ï¼šä¹‹å‰ç”¨äº†ApiResolverå»å†™äº†hookä»£ç ï¼Œåç»­è°ƒè¯•çš„å‡½æ•°ç¡®ä¿è¢«è§¦å‘äº†ï¼Œä½†æ˜¯å´æ²¡è¾“å‡ºæˆ‘ä»¬å¸Œæœ›çš„æ—¥å¿— åŸå› ï¼šæ­¤å¤„ApiResolveråªæ˜¯searchæŸ¥æ‰¾ï¼Œå‡½æ•°æ˜¯å¦å­˜åœ¨ï¼Œåªè¿è¡Œä¸€æ¬¡ï¼Œåç»­çš„ç¡®ï¼Œæœ¬èº«å°±ä¸ä¼šå†æ¬¡è§¦å‘ï¼Œæ‰€ä»¥åç»­ä»£ç è¢«è§¦å‘æ—¶ï¼Œå°±ä¸ä¼šæ‰“å°æ—¥å¿— è§£å†³åŠæ³•ï¼šçœŸæ­£çš„è¦å®ç°ï¼Œhookå‡½æ•°ï¼Œå¾…å‡½æ•°è¢«è¿è¡Œåè§¦å‘æ—¥å¿—æ‰“å°ï¼Œåº”è¯¥æ”¹ç”¨ï¼šInterceptor æ³¨ï¼š ApiResolverçš„å®Œæ•´ä»£ç å’Œè§£é‡Šï¼Œè¯¦è§ï¼šApiResolver Interceptorçš„å®Œæ•´ç¤ºä¾‹ä»£ç ï¼Œè¯¦è§ï¼šInterceptor=hookå‡½æ•° crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-26 23:16:00 "},"summary_note/hook_func/frida/interceptor/stalker.html":{"url":"summary_note/hook_func/frida/interceptor/stalker.html","title":"Stalker","keywords":"","body":"Stalker å®é™…å†…å­˜åœ°å€å’ŒStalkerè¾“å‡ºåœ°å€ä¸åŒ¹é…ä¸ä¸€è‡´ æŸæ¬¡Stalkerè°ƒè¯•çš„logæ˜¯ï¼š ===== dynamicDebug/frida/scripts/fridaStalker_akdSymbol2575.js ===== funcRelativeStartAddr=656480, functionSize=9416, funcRelativeEndAddr=665896 moduleName=akd, moduleBaseAddress=0x10054c000 funcRealStartAddr=0x1005ec460, funcRealEndAddr=0x1005ec4609416 [iPhone::PID::13098 ]-> ----- arg0=0xfffffffffffffffe, arg1=0x16fe26838, arg2=0x16fe26838, arg3=0xfffffffffffffffe curTid= 26635 +++ into iterator= [0x1071dbcd8] b #0x1071dbce8 +++ into iterator= [0x1071dbce8] str wzr, [x19, #0x90] [0x1071dbcec] ldr x0, [x19, #0xa0] [0x1071dbcf0] str xzr, [x19, #0xa0] [0x1071dbcf4] cbz x0, #0x1071dbcfc +++ into iterator= [0x1071dbcf8] bl #0x1070dfef8 +++ into iterator= [0x1071dbcfc] ldr x0, [x19, #0x98] [0x1071dbd00] str xzr, [x19, #0x98] [0x1071dbd04] cbz x0, #0x1071dbd14 ... å…¶ä¸­æŒ‡ä»¤åœ°å€çœ‹èµ·æ¥ä¸åŒ¹é…=ä¸ä¸€è‡´ï¼š æŒ‡ä»¤åœ°å€ï¼š0x1071dbcd8 å‡½æ•°äºŒè¿›åˆ¶å†…åç§»é‡ï¼š0xa0460 æ­¤å¤„akdæ¨¡å—åŸºåœ°å€ï¼š0x10054c000 æ‰€ä»¥å‡½æ•°çš„å®é™…çœŸå®èµ·å§‹åœ°å€ï¼š0x1005ec460 åæ¥æ‰æ˜ç™½æ˜¯ï¼š Fridaçš„Stalkerä¸­ï¼Œçœ‹åˆ°2ä¸ªå‡½æ•°åœ°å€ä¸åŒ¹é…ï¼š å‡½æ•°å®é™…å†…å­˜èµ·å§‹åœ°å€ï¼š0x1005ec460 0x1005exxxx ä¹‹ç±»çš„åœ°å€ Stalkerä¸­è¿è¡ŒæœŸé—´çš„å‡½æ•°åœ°å€ï¼š0x1071dbcd8 0x1071dxxxx ä¹‹ç±»çš„åœ°å€ çš„åŸå› ï¼š Stalkerå†…éƒ¨çš„hookæŒ‡ä»¤çš„åŸç†å°±æ˜¯ï¼šæŠŠå½“å‰ä»£ç æ‹·è´ä¸€ä»½ï¼ŒåŠ ä¸Šhookä»£ç åŠå…¶ä»–é€»è¾‘ è€Œæ­¤å¤„çš„ï¼šæ‹·è´ä¸€ä»½ï¼Œåˆ°åˆ«å¤„ï¼Œåˆ«çš„ä¸€æ®µå†…å­˜åœ°å€ç©ºé—´ï¼Œæ­¤å¤„å°±æ˜¯æŒ‡çš„æ˜¯ï¼š 0x1071dbcd8 0x1071dxxxx ä¹‹ç±»çš„åœ°å€ æ‰€ä»¥ï¼ŒåŸå§‹å‡½æ•°ä»£ç å’Œè¢«Stalkerå»hookçš„ä»£ç ï¼Œä¸¤ä¸ªåœ°å€æ˜¯ä¸åŒçš„ï¼Œæ˜¯å¯ä»¥ç†è§£çš„ã€‚ Fridaçš„Stalkerçš„transformä¸­Instructionçš„å±æ€§ Fridaçš„Stalkerçš„transformä¸­InstructionæŒ‡ä»¤ï¼Œæœ‰å“ªäº›å±æ€§ï¼Œå‚è€ƒå®˜ç½‘ï¼š https://frida.re/docs/javascript-api/#instruction å¾—çŸ¥æœ‰å¦‚ä¸‹å±æ€§ï¼š address next size mnemonic opStr operands regsAccessed regsRead regsWritten groups toString() toJSON() æ³¨ï¼šä½†æ˜¯æ²¡æœ‰ï¼ˆå…¶å®å¸Œæœ›ä¹Ÿæœ‰çš„ï¼‰bytes=opcodeå±æ€§ã€‚ è€Œè¿™äº›å±æ€§çš„æ¥æºæ˜¯ï¼šCapstone Capstone Javaæ¥å£ capstone/Capstone.java at next Â· capstone-engine/capstone Â· GitHub Pythonæ¥å£ capstone/init.py at next Â· capstone-engine/capstone Â· GitHub ä¸¾ä¾‹ å¦‚ä¹‹å‰ç¤ºä¾‹ä»£ç ï¼š ___lldb_unnamed_symbol2575$$akd ä¸­çš„ï¼Œä½†æ˜¯æ³¨é‡Šæ‰çš„ä»£ç ï¼š ï¼ˆæ³¨ï¼šå½“æ—¶æ²¡åŠ regsAccessedå’ŒtoJSON()ï¼‰ // console.log(\"instruction: address=\" + instruction.address // + \",next=\" + instruction.next() // + \",size=\" + instruction.size // + \",mnemonic=\" + instruction.mnemonic // + \",opStr=\" + instruction.opStr // + \",operands=\" + JSON.stringify(instruction.operands) // + \",regsAccessed=\" + JSON.stringify(instruction.regsAccessed) // + \",regsRead=\" + JSON.stringify(instruction.regsRead) // + \",regsWritten=\" + JSON.stringify(instruction.regsWritten) // + \",groups=\" + JSON.stringify(instruction.groups) // + \",toString()=\" + instruction.toString() // + \",toJSON()=\" + instruction.toJSON() // ); å–æ¶ˆæ³¨é‡Šåï¼Œå¯ä»¥è¾“å‡ºlogï¼š instruction: address=0x10f4ecef4,next=0x4,size=4,mnemonic=ldr,opStr=x0, #0x10f4ecf78,operands=[{\"type\":\"reg\",\"value\":\"x0\",\"access\":\"w\"},{\"type\":\"imm\",\"value\":\"4551790456\",\"access\":\"r\"}],regsRead=[],regsWritten=[],groups=[],toString()=ldr x0, #0x10f4ecf78 [0x10f4ecef4] ldr x0, #0x10f4ecf78 instruction: address=0x10f4ecef8,next=0x4,size=4,mnemonic=bl,opStr=#0x1091a500c,operands=[{\"type\":\"imm\",\"value\":\"4447686668\",\"access\":\"r\"}],regsRead=[],regsWritten=[\"lr\"],groups=[\"call\",\"jump\",\"branch_relative\"],toString()=bl #0x1091a500c [0x10f4ecef8] bl #0x1091a500c Fridaçš„Stalkerä¸­å»åˆ¤æ–­æ˜¯å¦æ˜¯å‡½æ•°çš„ä»£ç æŒ‡ä»¤çš„é€»è¾‘ éœ€æ±‚ï¼šFridaçš„Stalkerè°ƒè¯•æœŸé—´ï¼Œæƒ³è¦çŸ¥é“å½“å‰æ‰€æ‰§è¡Œçš„ä»£ç ï¼Œæ˜¯å¦å±äºï¼šçœŸæ­£çš„è¦hookçš„å‡½æ•°çš„çœŸå®ä»£ç  è§£å†³åŠæ³• ç»è¿‡è°ƒè¯•ç”¨å¦‚ä¸‹ä»£ç ï¼š console.log(\"===== Frida Stalker hook for arm64 ___lldb_unnamed_symbol2575$$akd =====\"); // arm64 akd: ___lldb_unnamed_symbol2575$$akd // var funcRelativeStartAddr = 0x1000a0460; var funcRelativeStartAddr = 0xa0460; var functionSize = 0x24C8; // 9416 == 0x24C8 var funcRelativeEndAddr = funcRelativeStartAddr + functionSize; console.log(\"funcRelativeStartAddr=\" + funcRelativeStartAddr + \", functionSize=\" + functionSize + \", funcRelativeEndAddr=\" + funcRelativeEndAddr); const moduleName = \"akd\"; const moduleBaseAddress = Module.findBaseAddress(moduleName); console.log(\"moduleName=\" + moduleName + \", moduleBaseAddress=\" + moduleBaseAddress); // console.log(\"moduleName=%s, moduleBaseAddress=%p\", moduleName, moduleBaseAddress); const funcRealStartAddr = moduleBaseAddress.add(funcRelativeStartAddr); // var funcRealEndAddr = funcRealStartAddr + functionSize; const funcRealEndAddr = funcRealStartAddr.add(functionSize); console.log(\"funcRealStartAddr=\" + funcRealStartAddr + \", funcRealEndAddr=\" + funcRealEndAddr); var curTid = null; Interceptor.attach(funcRealStartAddr, { onEnter: function(args) { var arg0 = args[0] var arg1 = args[1] var arg2 = args[2] var arg3 = args[3] console.log(\"----- arg0=\" + arg0 + \", arg1=\" + arg1 + \", arg2=\" + arg2 + \", arg3=\" + arg3); var curTid = Process.getCurrentThreadId(); console.log(\"curTid=\", curTid); Stalker.follow(curTid, { events: { call: true, // CALL instructions: yes please ret: false, // RET instructions exec: false, // all instructions: not recommended as it's block: false, // block executed: coarse execution trace compile: false // block compiled: useful for coverage }, // transform: (iterator: StalkerArm64Iterator) => { transform: function (iterator) { var instruction = iterator.next(); const startAddress = instruction.address; console.log(\"+++ into iterator: startAddress=\" + startAddress); // const isAppCode = startAddress.compare(funcRealStartAddr) >= 0 && startAddress.compare(funcRealEndAddr) === -1; // const isAppCode = (startAddress.compare(funcRealStartAddr) >= 0) && (startAddress.compare(funcRealEndAddr) = 0 const lt_realEndAddr = startAddress.compare(funcRealEndAddr) : \" + instructionStr); } iterator.keep(); } while ((instruction = iterator.next()) !== null); } }) }, onLeave: function(retval) { console.log(\"retval:\", new ObjC.Object(retval)) if (curTid != null) { Stalker.unfollow(curTid); console.log(\"Stalker.unfollow curTid=\", curTid) } } }); å¯ä»¥è¾“å‡ºï¼š ===== Frida Stalker hook for arm64 ___lldb_unnamed_symbol2575$$akd ===== funcRelativeStartAddr=656480, functionSize=9416, funcRelativeEndAddr=665896 moduleName=akd, moduleBaseAddress=0x10237c000 funcRealStartAddr=0x10241c460, funcRealEndAddr=0x10241e928 [iPhone::akd ]-> ----- arg0=0xfffffffffffffffe, arg1=0x16dcae838, arg2=0x16dcae838, arg3=0xfffffffffffffffe curTid= 15635 +++ into iterator: startAddress=0x1089dbcd8 isAppCode=false, gt_realStartAddr=true, lt_realEndAddr=false +++ into iterator: startAddress=0x1089dbce8 ... isAppCode=true, gt_realStartAddr=true, lt_realEndAddr=true, arg3=0xfffffffffffffffe 0x10241c470 : stp x22, x21, [sp, #0xc0] 0x10241c474 : stp x20, x19, [sp, #0xd0] 0x10241c478 : stp x29, x30, [sp, #0xe0] 0x10241c47c : add x29, sp, #0xe0 ... ç®—æ˜¯å®ç°äº†ï¼Œé€šè¿‡è®¡ç®—ï¼Œæœ€åç”¨isAppCodeè¿™ä¸ªå˜é‡å»åˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰ä»£ç  ä¸Šè¿°ä»£ç çš„æ‰€å±çš„å®Œæ•´çš„ç¤ºä¾‹ä»£ç ï¼Œè¯¦è§ï¼š ___lldb_unnamed_symbol2575$$akd crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-25 23:54:22 "},"summary_note/hook_func/frida_trace.html":{"url":"summary_note/hook_func/frida_trace.html","title":"frida-trace","keywords":"","body":"frida-trace hookæŒ‡å®šçš„å¤šä¸ªäºŒè¿›åˆ¶åº“æ–‡ä»¶ æƒ³è¦å»ç”¨frida-traceè¿½è¸ªçš„iOSçš„ObjCçš„åº“=Framework=äºŒè¿›åˆ¶ï¼š AppleAccount AppleAccountUI Accounts AccountsDaemon AuthKitUI AuthKit UserManagement æœ€åæ˜¯ç”¨ï¼š å»include å¤šä¸ª modulefrida-trace -U -F com.apple.Preferences -I \"AppleAccount*\" -I \"UserManagement\" -I \"Accounts*\" -I \"AuthKit*\" å¯ä»¥è¿è¡Œï¼Œä½†æ˜¯ç»“æœï¼š åªæ‰¾åˆ°å°‘æ•°å‡ ä¸ªå‡½æ•°ï¼Œä¸æ˜¯æˆ‘ä»¬è¦çš„ -ã€‹è¿™ä¹ˆå¤šåº“ï¼Œä¸€å…±æ‰æœ‰107ä¸ªå‡½æ•° -ã€‹å…¶ä¸­AppleAccountåªæœ‰7ä¸ªå‡½æ•°ï¼Œå…¶ä¸­å°±æœ‰ä¸Šé¢çš„_AALogSystemä»…ä»…æ˜¯æ—¥å¿—çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è¦çš„ï¼šå¾ˆå¤šå…¶ä»–è´¦å·ç™»å½•ç›¸å…³çš„å‡½æ•° -ã€‹æ­£å¸¸æƒ…å†µä¸‹ï¼Œåº”è¯¥ä¼šæœ‰éå¸¸å¤šçš„å‡½æ•°æ‰å¯¹ æ³¨ï¼š ä¹Ÿå¯ä»¥æ¢å¦å¤–å†™æ³•ï¼š frida-trace -U -F com.apple.Preferences -i \"AppleAccount\\!\" -i \"AppleAccountUI\\!\" -i \"Accounts\\!\" -i \"AccountsDaemon\\!\" -i \"AuthKit\\!\" -i \"AuthKitUI\\!\" -i \"UserManagement\\!\" ä¸è¿‡ç»“æœéƒ½ä¸€æ ·ï¼šhookçš„å‡½æ•°éƒ½å¾ˆå°‘ï¼Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ è¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶ä¸­ è§£å†³åŠæ³•ï¼šåŠ ä¸Š-oå‚æ•°ï¼Œå»æŒ‡å®šè¾“å‡ºlogåˆ°æ–‡ä»¶ å‘½ä»¤frida-trace -U -F com.apple.Preferences -o traceAccount.log -m \"*[AA* *]\" -m \"*[AK* *]\" -m \"*[AS* *]\" -m \"*[NSXPC* *]\" -M \"-[ASDBundle copyWithZone:]\" -M \"-[ASDInstallationEvent copyWithZone:]\" -M \"-[NSXPCEncoder _encodeArrayOfObjects:forKey:]\" -M \"-[NSXPCEncoder _encodeUnkeyedObject:]\" -M \"-[NSXPCEncoder _replaceObject:]\" -M \"-[NSXPCEncoder _checkObject:]\" -M \"-[NSXPCEncoder _encodeObject:]\" -M \"-[NSXPCConnection replacementObjectForEncoder:object:]\" ç¼ºç‚¹ ä¹‹å‰=è¾“å‡ºæ—¥å¿—åˆ°ç»ˆç«¯ï¼šå¸¦é¢œè‰²å’Œç¼©è¿› -> åˆ©äºæŸ¥çœ‹å‡½æ•°è°ƒç”¨å…³ç³» ç°åœ¨=è¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶ï¼šä¸¢å¤±äº†é¢œè‰²ï¼Œæ›´ä¸»è¦æ˜¯ç¼©è¿›ä¹Ÿä¸¢å¤±äº† -> éå¸¸ä¸åˆ©äºæŸ¥çœ‹å‡½æ•°è°ƒç”¨å…³ç³» æƒ³è¦ä¿ç•™æ‰€æœ‰çš„frida-traceçš„å¸¦ç¼©è¿›çš„æ—¥å¿— å¦‚ä¸Šæ‰€è¿°ï¼Œæƒ³è¦ï¼šä¿ç•™æ‰€æœ‰çš„frida-traceçš„æ—¥å¿—ï¼Œä½†å¦‚æœç”¨è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ï¼Œå´åˆä¸¢å¤±ç¼©è¿›ï¼ˆå’Œé¢œè‰²ï¼‰ å¦å¤–æœ‰ä¸ªè§„é¿åŠæ³•ï¼š ä¿®æ”¹å½“å‰ç»ˆç«¯çš„æœ€å¤§æ˜¾ç¤ºè¡Œæ•° -> å°±å¯ä»¥é¿å…è¾“å‡ºæ—¥å¿—è¡Œæ•°å¤ªå¤šï¼Œä¹‹å‰å†…å®¹è¢«å†²æ‰ï¼Œçœ‹ä¸åˆ°çš„é—®é¢˜äº† æ¯”å¦‚ï¼š Macä¸­iTerm2ä¸­ï¼Œå³é”®å½“å‰tabé¡µé¡¶éƒ¨-ã€‹å³é”®-ã€‹Edit Session->Terminal->Scrollback Buffer->Scrollback lineï¼šæ”¹ä¸ºè¶³å¤Ÿå¤§çš„æ•°å€¼ï¼Œæ¯”å¦‚5000 ç”šè‡³å¦‚æœlogæ—¥å¿—ç‰¹åˆ«é•¿ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ï¼šè®¾ç½®ä¸ºæ— é™è¡Œæ•°éƒ½ä¿ç•™ == Unlimited scrollback è¿™æ ·å°±å®Œå…¨ä¸ç”¨æ‹…å¿ƒæ—¥å¿—è¡Œæ•°å¤ªå¤šï¼Œå‰é¢çš„æ—¥å¿—è¢«å†²æ‰ï¼Œçœ‹ä¸åˆ°çš„é—®é¢˜äº†ã€‚ é€šè¿‡ä¿®æ”¹ç‰¹å®šå‡½æ•°çš„hookçš„jså»æ‰“å°å‚æ•°å€¼ å¯¹äºä¹‹å‰çš„éœ€æ±‚ï¼šfrida-traceæ—¶ï¼Œæ‰“å°å…¶ä¸­ç‰¹å®šçš„æŸä¸ªObjCå‡½æ•°çš„å‚æ•° ä¹‹å‰ä¸çŸ¥é“å¦‚ä½•è§£å†³ï¼Œåæ¥å‚è€ƒè¿™é‡Œï¼Œçªç„¶æƒ³åˆ°ï¼š å€’æ˜¯å¯ä»¥å€ŸåŠ©å…¶æ‰€è¯´çš„ï¼Œå¯¹äºfrida-traceè‡ªåŠ¨ä¸ºæ¯ä¸ªç±»çš„å‡½æ•°ï¼Œæ‰€ç”Ÿæˆçš„jsæ–‡ä»¶ï¼š ä½ç½®ï¼š__handlers__/{ClassName}/{FunctionName}.js å»ä¿®æ”¹jsä»£ç ï¼ŒåŠ ä¸Šæ‰“å°å¯¹åº”çš„argsçš„ä»£ç ï¼Œå³å¯æ‰“å°å¯¹åº”å‚æ•°å€¼äº†ã€‚ ä¸¾ä¾‹ -[AAAccountManager addAccount:] frida-traceä¸ºå‡½æ•°-[AAAccountManager addAccount:]è‡ªåŠ¨ç”Ÿæˆçš„ï¼š jsæ–‡ä»¶ /Users/crifan/dev/dev_root/iosReverse/AppleStore/AuthKit_akd/dynamicDebug/frida/scripts/__handlers__/AAAccountManager/addAccount_.js å®Œæ•´jsä»£ç  /* * Auto-generated by Frida. Please modify to match the signature of -[AAAccountManager addAccount:]. * This stub is currently auto-generated from manpages when available. * * For full API reference, see: https://frida.re/docs/javascript-api/ */ { /** * Called synchronously when about to call -[AAAccountManager addAccount:]. * * @this {object} - Object allowing you to store state for use in onLeave. * @param {function} log - Call this function with a string to be presented to the user. * @param {array} args - Function arguments represented as an array of NativePointer objects. * For example use args[0].readUtf8String() if the first argument is a pointer to a C string encoded as UTF-8. * It is also possible to modify arguments by assigning a NativePointer object to an element of this array. * @param {object} state - Object allowing you to keep state across function calls. * Only one JavaScript function will execute at a time, so do not worry about race-conditions. * However, do not use this to store function arguments across onEnter/onLeave, but instead * use \"this\" which is an object for keeping state local to an invocation. */ onEnter(log, args, state) { log(`-[AAAccountManager addAccount:${args[2]}]`); }, /** * Called synchronously when about to return from -[AAAccountManager addAccount:]. * * See onEnter for details. * * @this {object} - Object allowing you to access state stored in onEnter. * @param {function} log - Call this function with a string to be presented to the user. * @param {NativePointer} retval - Return value represented as a NativePointer object. * @param {object} state - Object allowing you to keep state across function calls. */ onLeave(log, retval, state) { } } å¯ä»¥æ‹·è´æŠŠå…¶ä¸­çš„ï¼š log(`-[AAAccountManager addAccount:${args[2]}]`); æ”¹ä¸ºï¼š log(`-[AAAccountManager addAccount:${new ObjC.Object(args[2])}]`); åº”è¯¥å°±å¯ä»¥ï¼šæ‰“å°å‡ºObjCå¯¹è±¡çš„ä¿¡æ¯äº†ï¼Œè€Œä¸ä»…ä»…æ˜¯ï¼šptr=NativePointerçš„æŒ‡é’ˆçš„å­—ç¬¦ä¸²è€Œå·²ã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 23:22:30 "},"summary_note/hook_func/common_ios_func.html":{"url":"summary_note/hook_func/common_ios_func.html","title":"å¸¸ç”¨iOSå‡½æ•°","keywords":"","body":"å¸¸ç”¨iOSå‡½æ•° Fridaä¸­é€†å‘iOSçš„appæœŸé—´ï¼Œå¸¸ä¼šæ¶‰åŠåˆ°ï¼Œä¸€äº›ç›¸å¯¹é€šç”¨çš„ï¼Œå¸¸ç”¨çš„å‡½æ•°ï¼Œæ•´ç†å¦‚ä¸‹ï¼š ç½‘ç»œç›¸å…³ è¯·æ±‚=request NSURLRequest+[NSURLRequest requestWithURL:] +[NSURLRequest requestWithURL:cachePolicy:timeoutInterval:] -[NSURLRequest requestWithURL:cachePolicy:timeoutInterval:] -[NSURLRequest initWithURL:] -[NSURLRequest initWithURL:cachePolicy:timeoutInterval:] NSMutableURLRequest-[NSMutableURLRequest initWithURL:] -[NSMutableURLRequest setHTTPBody:] NSURL+[NSURL URLWithString:] +[NSURL URLWithString:relativeToURL:] -[NSURL initWithScheme:host:path:] -[NSURL initWithString:] -[NSURL initWithString:relativeToURL:] NSURLConnection+[NSURLConnection sendSynchronousRequest:returningResponse:error:] +[NSURLConnection sendAsynchronousRequest:queue:completionHandler:] +[NSURLConnection connectionWithRequest:delegate:] -[NSURLConnection initWithRequest:delegate:] -[NSURLConnection start] -[NSURLConnection cancel] -[NSURLConnection connection:didReceiveResponse:] -[NSURLConnection connection:didReceiveData:] -[NSURLConnection connectionDidFinishLoading:] -[NSURLConnection connection:didFailWithError:] å“åº”=response NSHTTPURLResponse-[NSHTTPURLResponse initWithURL:statusCode:HTTPVersion:headerFields:] -[NSHTTPURLResponse allHeaderFields] -[NSHTTPURLResponse statusCode] NSURLResponse-[NSURLResponse initWithURL:MIMEType:expectedContentLength:textEncodingName] crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-10-24 17:48:36 "},"summary_note/js/":{"url":"summary_note/js/","title":"js","keywords":"","body":"js æ­¤å¤„æ•´ç†Fridaä¸­jsçš„ä¸€äº›ç»éªŒå¿ƒå¾—ã€‚ å¸¸è§é”™è¯¯ RangeError: invalid array index é”™è¯¯ï¼šFridaçš„hookè„šæœ¬jsä¸­Interceptor.attach(functionRealAddress, { onEnter: function(args) { console.log(args); ä¼šæŠ¥é”™ï¼šRangeError: invalid array index åŸå› ï¼šæ— æ³•çŸ¥é“å‡†ç¡®çš„argsçš„æ•°ç»„çš„å¤§å°ï¼Œæ— æ³•ç›´æ¥æ‰“å°ï¼Œæ‰€ä»¥æŠ¥é”™ è§£å†³åŠæ³•ï¼šä¸å»ç›´æ¥æ‰“å°ï¼Œè€Œæ”¹ä¸ºå»è·å–å¯¹åº”çš„å‰å‡ ä¸ªå‚æ•°ï¼ˆå‰æï¼šå·²çŸ¥å‚æ•°ä¸ªæ•°ï¼‰ï¼Œå†å»æ‰“å°ï¼šInterceptor.attach(functionRealAddress, { onEnter: function(args) { var arg0 = args[0] var arg1 = args[1] var arg2 = args[2] console.log(\"arg0=\" + arg0 + \", arg1=\" + arg1 + \", arg2=\" + arg2); è¿›ä¸€æ­¥ä¼˜åŒ–ï¼šç”šè‡³æ˜¯ï¼Œè®¡ç®—å‡ºæ­¤å¤„çš„ObjCçš„å‚æ•°çš„ä¸ªæ•°ï¼Œå¾ªç¯æ‰¹é‡æ‰“å°æ‰€æœ‰å‚æ•° å…·ä½“è¯¦è§ï¼šObjCçš„å‚æ•°ä¸­çš„è®¡ç®—ObjCçš„å‡½æ•°çš„çœŸæ­£å‚æ•°çš„ä¸ªæ•° + æ‰“å°å…¨éƒ¨å‚æ•° Fridaå¯¹äºjsæ”¯æŒçš„ä¸å¤Ÿå¥½ Fridaå¯¹äºjsæ”¯æŒçš„ä¸å¤Ÿå¥½ï¼Œä¸å¤Ÿå®Œç¾ï¼š jsæŠ¥é”™æ—¶ï¼Œä»£ç é”™è¯¯è¡Œæ•°æŒ‡ç¤ºæœ‰è¯¯ console.logçš„å‚æ•°æ ¼å¼åŒ–ä¸æ”¯æŒ putCalloutä¸­ä¼ é€’æœ‰åçš„ç‹¬ç«‹å‡½æ•°ä¼šå¯¼è‡´å´©æºƒï¼Œæ”¹ä¸ºåŒ¿åå‡½æ•°å³å¯ ä¸‹é¢è¯¦ç»†è§£é‡Šï¼š jsæŠ¥é”™æ—¶ï¼Œä»£ç é”™è¯¯è¡Œæ•°æŒ‡ç¤ºæœ‰è¯¯ é—®é¢˜ï¼š Fridaçš„jsä»£ç æ–‡ä»¶ä¸­ï¼Œå‚è€ƒåˆ«äººçš„tsçš„ä»£ç ï¼Œå†™äº†ï¼š transform: (iterator: StalkerArm64Iterator) => { ... var arm64Context = ctx as Arm64CpuContext; ç»“æœè¯­æ³•æŠ¥é”™ Error: could not parse â€˜xxxf/ridaStalker_akdSymbol2575.js' line 1: expecting ',' at (/frida/repl-2.js:1) è§£å†³è¿‡ç¨‹ Fridaä¸­å¯¹jsä»£ç æŠ¥é”™ï¼Œå§‹ç»ˆæ˜¯ç¬¬ä¸€è¡Œä»£ç æœ‰é—®é¢˜ åæ¥æ˜¯ï¼ŒèŠ±äº†å¾ˆé•¿æ—¶é—´å’Œç²¾åŠ›ï¼Œæ‰å®šä½åˆ°çœŸæ­£é—®é¢˜ï¼š åŸå› ï¼šjsä»£ç ä¸­ï¼Œåé¢çš„æŸ2è¡Œä¸­ï¼Œå…ˆåå‡ºç°çš„2ä¸ªå˜é‡ï¼Œæ²¡æœ‰å®šä¹‰ 2ä¸ªå˜é‡æ˜¯ï¼šStalkerArm64Iteratorå’ŒArm64CpuContext å¯¼è‡´çš„æ•´ä½“jsä»£ç æ— æ³•è¿è¡Œè€ŒæŠ¥é”™ è§£å†³åŠæ³•ï¼šæ³¨é‡Šæ‰2ä¸ªæœªå®šä¹‰çš„å˜é‡ï¼ˆStalkerArm64Iteratorå’ŒArm64CpuContextï¼‰ å¿ƒå¾—ï¼š æ€»ä¹‹è¯´æ˜ï¼Œjsä»£ç çš„è§£æï¼Œæ˜¯Fridaæ•´ä¸ªæ¡†æ¶å»åŸºäºjså¼•æ“ï¼ˆv8æˆ–å…¶ä»–ï¼Ÿï¼‰å»è§£æçš„ æ‰€ä»¥æœ€ç»ˆè¾“å‡ºçš„æŠ¥é”™ä¿¡æ¯ï¼Œä¸å¤Ÿå‹å¥½ï¼Œå¯¼è‡´å®¹æ˜“è®©äººè¯¯åˆ¤é”™è¯¯åŸå› ï¼Œä»è€Œå¢åŠ è§£å†³é—®é¢˜çš„éš¾åº¦ putCalloutä¸­ä¼ é€’æœ‰åçš„ç‹¬ç«‹å‡½æ•°ä¼šå¯¼è‡´å´©æºƒ é—®é¢˜æ¦‚è¿° ç»™putCalloutä¼ é€’å‡½æ•°ï¼š ä¼ é€’æœ‰åçš„ç‹¬ç«‹çš„å‡½æ•°ï¼šä¼šå¯¼è‡´å´©æºƒ ä¼ é€’åŒ¿åçš„å‡½æ•°ï¼šå°±å¯ä»¥æ­£å¸¸è¿è¡Œ è¯¦è§£ Fridaçš„Stalkerçš„transformä¸­å»å†™putCalloutä»£ç  æ³¨ï¼šå®Œæ•´ä»£ç è¯¦è§ï¼š___lldb_unnamed_symbol2575$$akd å¦‚æœæŠŠputCalloutå†™æˆæ˜¯ä¼ å…¥ä¸€ä¸ªç‹¬ç«‹çš„jså‡½æ•°ï¼š transform: function (iterator) { ... if (curOffsetInt == 8516) { iterator.putCallout(needDebug); } } ... function needDebug (context) { console.log(\"into needDebug: context=\" + context); ... } ->å°±ä¼šå¯¼è‡´æ­¤å¤„å‡ºç°å´©æºƒï¼š ã€‚ã€‚ã€‚ Process terminated Thank you for using Frida! Fatal Python error: _enter_buffered_busy: could not acquire lock for '> at interpreter shutdown, possibly due to daemon threads Python runtime state: finalizing (tstate=0x000000010308e0c8) Current thread 0x00000001f4ab4140 (most recent call first): è€Œå¦‚æœæ”¹ä¸ºï¼šjsåŒ¿ååå‡½æ•° transform: function (iterator) { ... if (curOffsetInt == 8516) { // iterator.putCallout(needDebug); iterator.putCallout((context) => { console.log(\"into needDebug: context=\" + context); }); } } å°±ä¸ä¼šå´©æºƒ å¾ˆæ˜¯è¯¡å¼‚ã€‚æš‚æ—¶ä¸æ¸…æ¥šå…·ä½“åŸå› ã€‚ å¿ƒå¾—ï¼šFridaä¸­å¯¹äºjsçš„æ”¯æŒï¼Œè¿˜æ˜¯ä¸å¤Ÿå®Œå–„ å®¹æ˜“é‡åˆ°ä¸€äº›è¯¡å¼‚çš„bug console.logçš„å‚æ•°æ ¼å¼åŒ–ä¸æ”¯æŒ è¯¦è§åç»­ç« èŠ‚ï¼šconsole.logæ—¥å¿— crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-26 22:19:15 "},"summary_note/js/console_log.html":{"url":"summary_note/js/console_log.html","title":"console.logæ—¥å¿—","keywords":"","body":"console.log é—®é¢˜ console.logä¸æ”¯æŒå‚æ•°çš„æ ¼å¼åŒ– é—®é¢˜ Fridaä¸­console.logæ‰“å°å‚æ•°ï¼Œå»æ ¼å¼åŒ–å‚æ•°ï¼šconsole.log(\"moduleName=%s, moduleBaseAddress=%p\", moduleName, moduleBaseAddress) è¾“å‡ºï¼šmoduleName=%s, moduleBaseAddress=%p akd 0x10015c000 ç»“è®ºï¼šFridaä¸­jsçš„console.logï¼Œä¸æ”¯æŒå‚æ•°æ ¼å¼åŒ– == %sã€%dã€%oã€%pç­‰æ ¼å¼åŒ–å‚æ•°æ— æ•ˆ è§„é¿åŠæ³• ç”¨é€—å·=, æˆ– åŠ å·=+ å»æ‰“å°å‚æ•° console.log(\"moduleName=\", moduleName, \", moduleBaseAddress=\", moduleBaseAddress) console.log(\"moduleName=\" + moduleName + \", moduleBaseAddress=\" + moduleBaseAddress) å¿ƒå¾— ç”¨JSON.stringifyæ‰“å°å¯¹è±¡ æ—¢ç„¶console.logä¸­æ— æ³•ç›´æ¥ï¼ˆç”¨%oå»æ ¼å¼åŒ–ï¼‰æ‰“å°å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ç”¨JSON.stringifyå»è½¬åŒ–ä¸ºJSONå†å»æ‰“å°ï¼š ä¸¾ä¾‹ï¼š console.log(\"instruction: address=\" + instruction.address + \",next=\" + instruction.next + \",size=\" + instruction.size + \",mnemonic=\" + instruction.mnemonic + \",opStr=\" + instruction.opStr + \",operands=\" + JSON.stringify(instruction.operands) + \",regsRead=\" + JSON.stringify(instruction.regsRead) + \",regsWritten=\" + JSON.stringify(instruction.regsWritten) + \",groups=\" + JSON.stringify(instruction.groups) + \",toString()=\" + instruction.toString() ); è¾“å‡ºæ•ˆæœï¼š instruction: address=0x1091dbcd8,next=0x4,size=4,mnemonic=b,opStr=#0x1091dbce8,operands=[{\"type\":\"imm\",\"value\":\"4447911144\",\"access\":\"r\"}],regsRead=[],regsWritten=[],groups=[\"jump\",\"branch_relative\"],toString()=b #0x1091dbce8 [0x1091dbcd8] b #0x1091dbce8 +++ into iterator= instruction: address=0x1091dbce8,next=0x4,size=4,mnemonic=str,opStr=wzr, [x19, #0x90],operands=[{\"type\":\"reg\",\"value\":\"wzr\",\"access\":\"r\"},{\"type\":\"mem\",\"value\":{\"base\":\"x19\",\"disp\":144},\"access\":\"rw\"}],regsRead=[],regsWritten=[],groups=[],toString()=str wzr, [x19, #0x90] [0x1091dbce8] str wzr, [x19, #0x90] è®©console.logè¾“å‡ºæ—¥å¿—åˆ°æ–‡ä»¶ éœ€æ±‚ï¼šå¸Œæœ›Fridaä¸­console.logæ‰“å°çš„æ—¥å¿—ï¼Œä¸æ˜¯è¾“å‡ºåˆ°å½“å‰ç»ˆç«¯ï¼Œè€Œæ˜¯è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ ç›®çš„ï¼šæ–¹ä¾¿åç»­éšæ—¶æŸ¥çœ‹ï¼Œæ–¹ä¾¿è°ƒè¯• è§£å†³åŠæ³•ï¼š åœ¨è¿è¡ŒFridaå¸¦jsçš„å‘½ä»¤è¡Œæœ€ååŠ ä¸Šï¼š > xxx.log 2>&1 å‚æ•°è¯´æ˜ > xxx.logï¼šæŠŠæ™®é€šçš„=stdoutæ—¥å¿—ä¿¡æ¯ï¼Œéƒ½è¾“å‡ºåˆ°logæ–‡ä»¶ 2>&1ï¼šæŠŠç‰¹æ®Šçš„stderr=é”™è¯¯æ—¥å¿—ä¿¡æ¯ï¼Œè¾“å‡ºåˆ°ç»ˆç«¯ ä¸¾ä¾‹frida -U -p 13098 -l ./fridaStalker_akdSymbol2575.js > stalker_akd1575.log 2>&1 Fridaçš„Stalkerä¸­ä¼˜åŒ–hookåˆ°æŒ‡ä»¤æ—¶çš„logæ—¥å¿—è¾“å‡º éœ€æ±‚ï¼šFridaçš„Stalkerä¸­ï¼Œå¸Œæœ›è¾“å‡ºçš„logæ—¥å¿—ï¼Œå°½é‡ä¹Ÿæ¨¡æ‹Ÿä¹‹å‰Xcodeçš„æ±‡ç¼–ä»£ç çš„å½¢å¼ æ ¸å¿ƒä»£ç ï¼š var curRealAddr = instruction.address; var curOffsetHexPtr = curRealAddr.sub(funcRealStartAddr) var curOffsetInt = curOffsetHexPtr.toInt32() var instructionStr = instruction.toString() console.log(\"\\t\" + curRealAddr + \" : \" + instructionStr); è¾“å‡ºæ•ˆæœ+++ into iterator: startAddress=0x104b48470 0x104b48470 : stp x22, x21, [sp, #0xc0] 0x104b48474 : stp x20, x19, [sp, #0xd0] 0x104b48478 : stp x29, x30, [sp, #0xe0] 0x104b4847c : add x29, sp, #0xe0 0x104b48480 : nop 0x104b48484 : ldr x8, #0x104b9c7d8 æ³¨ï¼šå®Œæ•´ä»£ç å’Œè¾“å‡ºï¼Œè¯¦è§ï¼š___lldb_unnamed_symbol2575$$akd crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-26 22:46:48 "},"summary_note/build_frida_server/":{"url":"summary_note/build_frida_server/","title":"è‡ªå·±ç¼–è¯‘frida-server","keywords":"","body":"è‡ªå·±ç¼–è¯‘frida-server iPhone11ä¸­ï¼Œå·²ç”¨XinaA15è¿›è¡Œäº†rootlessè¶Šç‹±ï¼Œç„¶åå»ç”¨fridaï¼š crifan@licrifandeMacBook-Pro î‚° ~ î‚° frida -U -f com.apple.store.Jolly -l /Users/crifan/dev/dev_root/iosReverse/AppleStore/dynamicDebug/frida/hookNSFileManager.js ____ / _ | Frida 16.0.8 - A world-class dynamic instrumentation toolkit | (_| | > _ | Commands: /_/ |_| help -> Displays the help system . . . . object? -> Display information about 'object' . . . . exit/quit -> Exit . . . . . . . . More info at https://frida.re/docs/home/ . . . . . . . . Connected to iPhone (id=00008030-00011C49366B802E) Failed to attach: missing gProcessInfo ç»“æœæŠ¥é”™ï¼šFailed to attach missing gProcessInfo ä¹‹åå°±æ˜¯å°è¯•è§£å†³æ­¤é—®é¢˜ï¼Œæœ€ç»ˆæ¶‰åŠåˆ°ï¼šè‡ªå·±å»ç¼–è¯‘frida-serverçš„è¿‡ç¨‹ã€‚ æ­¤å¤„è®°å½•ç›¸å…³å†…å®¹å’Œå¿ƒå¾—ï¼Œä¾›å‚è€ƒã€‚ ç ”ç©¶gProcessInfoçš„æ¥æº ä¹‹å‰frida-ios-dumpä¹Ÿé‡åˆ°ç±»ä¼¼é—®é¢˜ è€Œä¹‹å‰å°±è§è¿‡æ­¤å¤„çš„missing gProcessInfoï¼Œæ‰¾åˆ°ä¹‹å‰çš„ï¼š åŸå› æ˜¯ï¼šå±äºå¶å°”çš„bug è§£å†³åŠæ³•ï¼šå¤šè¯•å‡ æ¬¡ -ã€‹æ­¤å¤„ï¼šç»§ç»­å°è¯•å¤šæ¬¡ï¼Œå§‹ç»ˆæ— æ³•è§„é¿ï¼Œå§‹ç»ˆæŠ¥é”™ã€‚ ç ”ç©¶fridaä¸­æ˜¯å¦å­˜åœ¨å¯¼å…¥å¤–éƒ¨å˜é‡gProcessInfo ä»æŠ¥é”™ä¿¡æ¯Failed to attach: missing gProcessInfoä¸­æ¨æµ‹ï¼š gProcessInfoæ˜¯ï¼ˆiOSçš„appå¯åŠ¨é˜¶æ®µæ¶‰åŠåˆ°çš„ï¼‰dyldä¸­çš„å˜é‡ æ€€ç–‘æ˜¯ç±»ä¼¼äºï¼š frida import å˜é‡ï¼šgProcessInfo dyld export å˜é‡ï¼šgProcessInfo è¿™ç§æœºåˆ¶ æ‰€ä»¥å»ç ”ç©¶çœ‹çœ‹ï¼š fridaä¸­ï¼Œæ˜¯å¦æœ‰importçš„å˜é‡ï¼Œå«åšgProcessInfo åæ¥ç¡®è®¤ï¼Œmissing gProcessInfoæ¥è‡ªiPhoneç«¯çš„frida-server å»å¯¼å‡ºfrida-server scp root@192.168.2.12:/var/sbin/frida-server frida-server ç„¶åç»§ç»­é™æ€åˆ†æï¼š rabin2 -i frida-server > fridaServer_rabin2_i_imports.txt rabin2 -E frida-server > fridaServer_rabin2_E_exports.txt æ²¡æ‰¾åˆ°gProcessInfo å¦å¤–æ‰¾åˆ°ï¼š dyld/dyldMain.cpp namespace dyld4 { ... #if TARGET_OS_OSX static void* getProcessInfo() { return gProcessInfo; } è€Œæ ¹æ®ï¼š ã€è®°å½•ã€‘dyldç›¸å…³èµ„æ–™ï¼šå¯åŠ¨è¿‡ç¨‹ çŸ¥é“äº†ï¼š dyld ä¹‹å‰æ˜¯ï¼šdyld2 åæ¥æ˜¯ï¼šdyld3 æ­¤å¤„æ˜¯ï¼šdyld4 å³ï¼šdyldæœ‰3ä¸ªç‰ˆæœ¬ï¼Œdyld2ã€dyld3ã€dyld4 æœ€åç¡®è®¤ï¼š ä¸æ˜¯Fridaï¼ˆçš„frida-serverï¼‰å¼•ç”¨äº†å¤–éƒ¨çš„å˜é‡ï¼š dyldæºç ä¸­çš„gProcessInfo è€Œæ˜¯ï¼š fridaæºç ä¸­æœ‰gProcessInfo å³ï¼š frida-core/src/fruity/injector.valaä¸­å°±æœ‰å¯¹åº”ä»£ç ï¼š ensure_libsystem_initialized_for_dyld_v4_and_above ... throw new Error.UNSUPPORTED (\"Missing gProcessInfo\"); Fridaæºç ä¸­æ‰¾åˆ°äº†ï¼šgProcessInfo missing gProcessInfoç›¸å…³å®Œæ•´çš„ä»£ç ï¼š frida-core/src/fruity/injector.valaprivate async void ensure_libsystem_initialized_for_dyld_v4_and_above (uint64 libdyld_initialize, Cancellable? cancellable) throws GLib.Error { uint64? process_info_ptr = dyld_symbols[\"_gProcessInfo\"]; if (process_info_ptr == null) throw new Error.UNSUPPORTED (\"Missing gProcessInfo\"); ... å…¶ä»–åœ°æ–¹ä¹Ÿæœ‰ï¼š frida-core/src/fruity/helpers/symbol-fetcher.c size_t frida_fetch_dyld_symbols (char * output_buffer, const void * dyld_load_address) { ... for (i = dyld.dysymtab->ilocalsym; i != dyld.dysymtab->nlocalsym; i++) { const struct nlist_64 * sym = &symbols[i]; const char * name = strings + sym->n_un.n_strx; if (frida_str_contains (name, \"libdyld_initialize\") || frida_str_contains (name, \"restartWithDyldInCache\") || frida_str_equals (name, \"_gProcessInfo\") || frida_str_contains (name, \"launchWithClosure\") || frida_str_contains (name, \"initializeMainExecutable\") || frida_str_contains (name, \"registerThreadHelpers\") || frida_str_has_prefix (name, \"_dlopen\") || frida_str_has_prefix (name, \"_strcmp\") || frida_str_contains (name, \"doModInitFunctions\") || frida_str_contains (name, \"doGetDOFSections\")) { if (n != 0) frida_append_char (&cursor, '\\n'); frida_append_uint64 (&cursor, (uint64_t) (dyld.base + sym->n_value)); frida_append_char (&cursor, '\\t'); frida_append_string (&cursor, name); n++; } } frida-core/src/darwin/frida-helper-backend-glue.m modern_entry_address = gum_darwin_module_resolve_symbol_address (dyld, \"__ZN5dyld44APIs19_libdyld_initializeEPKNS_16LibSystemHelpersE\"); instance->dyld_flavor = (modern_entry_address != 0) ? FRIDA_DYLD_V4_PLUS : FRIDA_DYLD_V3_MINUS; if (instance->dyld_flavor == FRIDA_DYLD_V4_PLUS) { instance->modern_entry_address = modern_entry_address; legacy_entry_address = 0; instance->info_ptr_address = gum_darwin_module_resolve_symbol_address (dyld, \"_gProcessInfo\"); if (instance->info_ptr_address == 0) goto dyld_probe_failed; } ... instance->dlopen_address = gum_darwin_module_resolve_symbol_address (dyld, \"_dlopen\"); if (instance->dlopen_address == 0) instance->dlopen_address = gum_darwin_module_resolve_symbol_address (dyld, \"_dlopen_internal\"); instance->register_helpers_address = gum_darwin_module_resolve_symbol_address (dyld, \"__ZL21registerThreadHelpersPKN4dyld16LibSystemHelpersE\"); instance->dlerror_clear_address = gum_darwin_module_resolve_symbol_address (dyld, \"__ZL12dlerrorClearv\"); instance->info_address = gum_darwin_module_resolve_symbol_address (dyld, \"__ZN4dyld12gProcessInfoE\"); instance->helpers_ptr_address = gum_darwin_module_resolve_symbol_address (dyld, \"__ZN4dyld17gLibSystemHelpersE\"); instance->do_modinit_strcmp_checks = frida_find_modinit_strcmp_checks (task, dyld); ... å¿ƒå¾—ï¼š å…¶ä¸­æœ‰å¾ˆå¤šè¿™ç§ï¼š ç¼–è¯‘å™¨ç¼–è¯‘åçš„å›ºå®šçš„å‡½æ•°åï¼š _dlopen _dlopen_internal __ZL21registerThreadHelpersPKN4dyld16LibSystemHelpersE __ZL12dlerrorClearv __ZN4dyld12gProcessInfoE å…¶ä¸­åŒ…å«ï¼šgProcessInfo __ZN4dyld17gLibSystemHelpersE ç ”ç©¶Fridaä¸­Missing gProcessInfoå‡ºé”™çš„é€»è¾‘å’ŒåŸå›  ç»è¿‡åç»­äº†è§£ï¼š ã€è®°å½•ã€‘dyldæºç ä¸­çš„gProcessInfo åº”è¯¥æŠŠï¼š åªåˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼š_gProcessInfo æ”¹ä¸ºï¼š åŒæ—¶åˆ¤æ–­å¤šç§æƒ…å†µï¼ˆå…ˆåé¡ºåºæ˜¯ï¼‰ _gProcessInfo å¯¹åº”åŸå§‹ä»£ç ä¸­ï¼šgProcessInfo __ZN5dyld412gProcessInfoE å¯¹åº”åŸå§‹ä»£ç ä¸­ï¼šdyld4::gProcessInfo __ZN4dyld12gProcessInfoE å¯¹åº”åŸå§‹ä»£ç ä¸­ï¼šdyld::gProcessInfo åº”è¯¥å°±å¯ä»¥äº†ã€‚ ç ”ç©¶äºŒè¿›åˆ¶/usr/lib/dyldä¸­æ˜¯å¦åŒ…å«æˆ–å¯¼å‡ºå˜é‡_gProcessInfo å¯¹äºiPhoneä¸­çš„dyldï¼š iPhone11-151:~ root# ls -lh /usr/lib/dyld -rwxr-xr-x 1 root wheel 630K Oct 15 2021 /usr/lib/dyld* ç”¨ï¼š scp root@192.168.2.12:/usr/lib/dyld dyld å¯¼å‡ºåï¼Œå†ä»dyldä¸­å¯¼å‡ºç¬¦å·ï¼š rabin2 -s dyld > dyld_rabin2_s_symbols.txt å‘ç°æ˜¯æœ‰çš„ï¼š dyld_rabin2_s_symbols.txt 2185 0x00064008 0x00064008 LOCAL FUNC 0 dyld4::gProcessInfo å¦å¤–ï¼Œçªç„¶æ³¨æ„åˆ°ï¼š fromiPhone/dyld_rabin2_s_symbols.txt891 0x0002e500 0x0002e500 LOCAL FUNC 0 dyld4::APIs::_dyld_shared_cache_optimized() 892 0x0002e57c 0x0002e57c LOCAL FUNC 0 dyld4::APIs::_dyld_register_for_image_loads(void (*)(mach_header const*, char const*, bool)) 893 0x0002e680 0x0002e680 LOCAL FUNC 0 ____ZN5dyld44APIs30_dyld_register_for_image_loadsEPFvPK11mach_headerPKcbE_block_invoke 894 0x0002e76c 0x0002e76c LOCAL FUNC 0 ____ZN5dyld44APIs30_dyld_register_for_image_loadsEPFvPK11mach_headerPKcbE_block_invoke_2 895 0x0002e7b4 0x0002e7b4 LOCAL FUNC 0 ____ZN5dyld44APIs35_dyld_register_for_bulk_image_loadsEPFvjPPK11mach_headerPPKcE_block_invoke_2 896 0x0002e7c8 0x0002e7c8 LOCAL FUNC 0 dyld4::APIs::dyld_shared_cache_file_path() 897 0x0002e810 0x0002e810 LOCAL FUNC 0 dyld4::APIs::dyld_has_inserted_or_interposing_libraries() 898 0x0002e874 0x0002e874 LOCAL FUNC 0 dyld4::APIs::dyld_shared_cache_find_iterate_text(unsigned char const*, char const**, void ( block_pointer)(dyld_shared_cache_dylib_text_info const*)) 899 0x0002ea8c 0x0002ea8c LOCAL FUNC 0 dyld4::findCacheInDirAndMap(dyld4::RuntimeState&, unsigned char const*, char const*, unsigned long&) 900 0x0002eb5c 0x0002eb5c LOCAL FUNC 0 ____ZN5dyld44APIs35dyld_shared_cache_find_iterate_textEPKhPPKcU13block_pointerFvPK33dyld_shared_cache_dylib_text_infoE_block_invoke.173 901 0x0002ebe0 0x0002ebe0 LOCAL FUNC 0 dyld4::APIs::dyld_shared_cache_iterate_text(unsigned char const*, void ( block_pointer)(dyld_shared_cache_dylib_text_info const*)) 902 0x0002ec60 0x0002ec60 LOCAL FUNC 0 dyld4::APIs::_dyld_fork_child() å³ï¼š æ­¤å¤„symbolä¸­ï¼Œä¹Ÿæ˜¯æœ‰ä¸€äº›ï¼š ____ZN5dyld44APIs30_dyld_register_for_image_loadsEPFvPK11mach_headerPKcbE_block_invoke è¿™ç§ç¼–è¯‘åçš„å‡½æ•°åçš„å€¼çš„ åŒæ—¶ï¼Œä¹Ÿæœ‰ï¼Œç¼–è¯‘å‰çš„ï¼Œæ™®é€šçš„å‡½æ•°åï¼š dyld4::APIs::_dyld_register_for_image_loads(void ()(mach_header const, char const*, bool)) -ã€‹æ‰€ä»¥çªç„¶æƒ³åˆ°ï¼š ä¼°è®¡æ˜¯ï¼Œç¼–è¯‘å‰çš„ï¼Œæ™®é€šå‡½æ•°åï¼Œæ˜¯ï¼š æ­¤å¤„rabin2ï¼Œè‡ªåŠ¨å¸®å¿™ç¿»è¯‘çš„ï¼ˆå› ä¸ºå…¶æ‡‚å¾—ç¼–è¯‘å’Œåç¼–è¯‘å‡½æ•°å symbolçš„å†…åœ¨é€»è¾‘ï¼Ÿï¼‰ -ã€‹æ‰€ä»¥å»æ‰¾æ‰¾ï¼š æ˜¯å¦æœ‰æœºä¼šï¼Œè®©rabin2ï¼Œåªè¾“å‡ºï¼š ç¼–è¯‘åçš„symbolåå­—ï¼Ÿ è¿™æ ·å°±èƒ½æ‰¾åˆ°ï¼Œç¡®è®¤ï¼š dyld4::gProcessInfo æ˜¯ä¸æ˜¯ï¼š __ZN5dyld44gProcessInfo äº† å»æ‰¾æ‰¾çœ‹ï¼š rabin2çš„å…¶ä»–å‚æ•°ï¼Œèƒ½è¾“å‡ºåŸå§‹çš„symbolçš„ï¼Ÿ å¯¹äº†ï¼Œæˆ–è®¸ä¹Ÿå¯ä»¥ç”¨å¦å¤–çš„å·¥å…·ï¼šjtool2 jtool2 -S dyld > dyld_jtool2_S_symbol.txt æœç„¶æ˜¯æˆ‘ä»¬å¸Œæœ›çš„ï¼ŒåŸå§‹çš„ï¼Œç¼–è¯‘åçš„ï¼Œæ²¡æœ‰è¢«è§£æçš„ï¼šgProcessInfo dyld_jtool2_S_symbol.txt0000000000064008 d __ZN5dyld412gProcessInfoE æ‰€ä»¥å°±æ˜¯ï¼š dyld4::gProcessInfo ç¼–è¯‘ç”Ÿæˆï¼š__ZN5dyld412gProcessInfoE ä¸æ˜¯æˆ‘ä»¥ä¸ºçš„ï¼š__ZN5dyld44gProcessInfo å†å»dyldæºç ä¸­ï¼Œå¤šæœæœï¼š namespace dyld4 çœ‹çœ‹æ˜¯å¦æœ‰å…¶ä»–æ–°å‘ç° namespace dyld4 /Users/crifan/dev/dev_src/ios_reverse/AppleOpenSource/dyld/dyld-dyld-1042.1/dyld/DebuggerSupport.h namespace dyld4 { using lsl::Allocator; void addImagesToAllImages(RuntimeState& state, uint32_t infoCount, const dyld_image_info info[], uint32_t initialImageCount); void removeImageFromAllImages(const mach_header* loadAddress); ... } extern \"C\" void lldb_image_notifier(enum dyld_image_mode mode, uint32_t infoCount, const dyld_image_info info[]); extern dyld_all_image_infos* gProcessInfo; ->ä¹Ÿè¿˜æ˜¯ï¼šgProcessInfo ->ä¸æ˜¯æ”¾åœ¨namespace dyld4ä¸­çš„ /Users/crifan/dev/dev_src/ios_reverse/AppleOpenSource/dyld/dyld-dyld-1042.1/dyld/DyldAPIs.cpp // internal libc.a variable that needs to be reset during fork() extern mach_port_t mach_task_self_; using dyld3::MachOFile; using dyld3::MachOLoaded; extern const dyld3::MachOLoaded __dso_handle; ... namespace dyld4 { ... } -ã€‹è‡ªå·±å½“å‰æ˜¯dyld4çš„namespaceï¼Œä½†æ˜¯ä¹Ÿä¼šå¼•ç”¨å¤–éƒ¨å˜é‡ï¼š å…¶ä¸­ä¹Ÿæœ‰ï¼š æ²¡æœ‰namespaceçš„ï¼š extern mach_port_t mach_task_self_; å’Œå¦å¤–çš„namespaceçš„ï¼šdyld3 extern const dyld3::MachOLoaded __dso_handle; ç„¶åå»ï¼š ã€æœªè§£å†³ã€‘rabin2è¾“å‡ºC++çš„æœªè§£æçš„åŸå§‹çš„ç¼–è¯‘åçš„å‡½æ•°åmangle name æ‰€ä»¥å»ï¼š ã€æœªè§£å†³ã€‘C++ä»£ç ä¸­å‡½æ•°å˜é‡ç¼–è¯‘ç”Ÿæˆç¬¦å·symbolçš„è§„åˆ™ æœŸé—´å»ï¼š ã€å·²è§£å†³ã€‘ä»C++çš„ç¼–è¯‘åçš„ç¬¦å·symbolå¾—åˆ°åŸå§‹çš„å˜é‡å‡½æ•°å å¦å¤–ï¼Œçœ‹çœ‹æ­¤å¤„çš„dyldç‰ˆæœ¬ï¼š iPhone11-151:~ root# /usr/lib/dyld --version -sh: /usr/lib/dyld: cannot execute binary file: Exec format error æ— æ³•æŸ¥çœ‹ã€‚ ã€å·²è§£å†³ã€‘iOS 13.3çš„iPhone7ä¸­/usr/lib/dyldçš„ç‰ˆæœ¬å’ŒgProcessInfoç›¸å…³ä¿¡æ¯ ä¹Ÿå»ç ”ç©¶ï¼šdyldæºç ä¸­çš„gProcessInfo è‡³æ­¤æ‰¾åˆ°ï¼š gProcessInfo å˜é‡æ¥æºï¼š dyld/dyld-dyld-1042.1/dyld/DebuggerSupport.cppstruct dyld_all_image_infos* gProcessInfo = &dyld_all_image_infos; ä»¥åŠï¼š struct dyld_all_image_infos å®šä¹‰ libdyld/dyld_process_info_internal.h struct dyld_all_image_infos_32 struct dyld_all_image_infos_64 include/mach-o/dyld_images.h struct __attribute__((aligned(16))) dyld_all_image_infos å…·ä½“å®šä¹‰è¯¦è§ï¼š ï¼ˆ1ï¼‰include/mach-o/dyld_images.h // Must be aligned to support atomic updates // Note sim cannot assume alignment until all host dylds are new enough #if TARGET_OS_SIMULATOR struct dyld_all_image_infos #else struct __attribute__((aligned(16))) dyld_all_image_infos #endif { uint32_t version; /* 1 in Mac OS X 10.4 and 10.5 */ uint32_t infoArrayCount; #if defined(__cplusplus) && (BUILDING_LIBDYLD || BUILDING_DYLD) std::atomic infoArray; #else const struct dyld_image_info* infoArray; #endif dyld_image_notifier notification; bool processDetachedFromSharedRegion; /* the following fields are only in version 2 (Mac OS X 10.6, iPhoneOS 2.0) and later */ bool libSystemInitialized; const struct mach_header* dyldImageLoadAddress; /* the following field is only in version 3 (Mac OS X 10.6, iPhoneOS 3.0) and later */ void* jitInfo; /* the following fields are only in version 5 (Mac OS X 10.6, iPhoneOS 3.0) and later */ const char* dyldVersion; const char* errorMessage; uintptr_t terminationFlags; /* the following field is only in version 6 (Mac OS X 10.6, iPhoneOS 3.1) and later */ void* coreSymbolicationShmPage; /* the following field is only in version 7 (Mac OS X 10.6, iPhoneOS 3.1) and later */ uintptr_t systemOrderFlag; /* the following field is only in version 8 (Mac OS X 10.7, iPhoneOS 3.1) and later */ uintptr_t uuidArrayCount; const struct dyld_uuid_info* uuidArray; /* only images not in dyld shared cache */ /* the following field is only in version 9 (Mac OS X 10.7, iOS 4.0) and later */ struct dyld_all_image_infos* dyldAllImageInfosAddress; /* the following field is only in version 10 (Mac OS X 10.7, iOS 4.2) and later */ uintptr_t initialImageCount; /* the following field is only in version 11 (Mac OS X 10.7, iOS 4.2) and later */ uintptr_t errorKind; const char* errorClientOfDylibPath; const char* errorTargetDylibPath; const char* errorSymbol; /* the following field is only in version 12 (Mac OS X 10.7, iOS 4.3) and later */ uintptr_t sharedCacheSlide; /* the following field is only in version 13 (Mac OS X 10.9, iOS 7.0) and later */ uint8_t sharedCacheUUID[16]; /* the following field is only in version 15 (macOS 10.12, iOS 10.0) and later */ uintptr_t sharedCacheBaseAddress; #if defined(__cplusplus) && (BUILDING_LIBDYLD || BUILDING_DYLD) // We want this to be atomic in libdyld so that we can see updates when we map it shared std::atomic infoArrayChangeTimestamp; #else uint64_t infoArrayChangeTimestamp; #endif const char* dyldPath; mach_port_t notifyPorts[DYLD_MAX_PROCESS_INFO_NOTIFY_COUNT]; #if __LP64__ uintptr_t reserved[11-(DYLD_MAX_PROCESS_INFO_NOTIFY_COUNT/2)]; #else uintptr_t reserved[9-DYLD_MAX_PROCESS_INFO_NOTIFY_COUNT]; #endif // The following fields were added in version 18 (previously they were reserved padding fields) uint64_t sharedCacheFSID; uint64_t sharedCacheFSObjID; /* the following field is only in version 16 (macOS 10.13, iOS 11.0) and later */ uintptr_t compact_dyld_image_info_addr; size_t compact_dyld_image_info_size; uint32_t platform; // FIXME: really a dyld_platform_t, but those aren't exposed here. /* the following field is only in version 17 (macOS 10.16) and later */ uint32_t aotInfoCount; const struct dyld_aot_image_info* aotInfoArray; uint64_t aotInfoArrayChangeTimestamp; uintptr_t aotSharedCacheBaseAddress; uint8_t aotSharedCacheUUID[16]; }; ï¼ˆ2ï¼‰è¿˜æœ‰ä¸ªåˆ†32å’Œ64çš„ï¼š struct dyld_all_image_infos_32 struct dyld_all_image_infos_64 -> libdyld/dyld_process_info_internal.h struct dyld_all_image_infos_32 { uint32_t version; uint32_t infoArrayCount; std::atomic infoArray; uint32_t notification; bool processDetachedFromSharedRegion; bool libSystemInitialized; uint32_t dyldImageLoadAddress; uint32_t jitInfo; uint32_t dyldVersion; uint32_t errorMessage; uint32_t terminationFlags; uint32_t coreSymbolicationShmPage; uint32_t systemOrderFlag; uint32_t uuidArrayCount; uint32_t uuidArray; uint32_t dyldAllImageInfosAddress; uint32_t initialImageCount; uint32_t errorKind; uint32_t errorClientOfDylibPath; uint32_t errorTargetDylibPath; uint32_t errorSymbol; uint32_t sharedCacheSlide; std::array sharedCacheUUID; uint32_t sharedCacheBaseAddress; std::atomic infoArrayChangeTimestamp; uint32_t dyldPath; uint32_t notifyMachPorts[8]; uint32_t reserved; uint64_t sharedCacheFSID; uint64_t sharedCacheFSObjID; uint32_t compact_dyld_image_info_addr; uint32_t compact_dyld_image_info_size; uint32_t platform; // the aot fields below will not be set in the 32 bit case uint32_t aotInfoCount; std::atomic aotInfoArray; uint64_t aotInfoArrayChangeTimestamp; uint64_t aotSharedCacheBaseAddress; std::array aotSharedCacheUUID[16]; }; struct dyld_all_image_infos_64 { uint32_t version; uint32_t infoArrayCount; std::atomic infoArray; uint64_t notification; bool processDetachedFromSharedRegion; bool libSystemInitialized; uint32_t paddingToMakeTheSizeCorrectOn32bitAndDoesntAffect64b; // NOT PART OF DYLD_ALL_IMAGE_INFOS! uint64_t dyldImageLoadAddress; uint64_t jitInfo; uint64_t dyldVersion; uint64_t errorMessage; uint64_t terminationFlags; uint64_t coreSymbolicationShmPage; uint64_t systemOrderFlag; uint64_t uuidArrayCount; uint64_t uuidArray; uint64_t dyldAllImageInfosAddress; uint64_t initialImageCount; uint64_t errorKind; uint64_t errorClientOfDylibPath; uint64_t errorTargetDylibPath; uint64_t errorSymbol; uint64_t sharedCacheSlide; std::array sharedCacheUUID; uint64_t sharedCacheBaseAddress; std::atomic infoArrayChangeTimestamp; uint64_t dyldPath; uint32_t notifyMachPorts[8]; uint64_t reserved[7]; uint64_t sharedCacheFSID; uint64_t sharedCacheFSObjID; uint64_t compact_dyld_image_info_addr; uint64_t compact_dyld_image_info_size; uint32_t platform; uint32_t aotInfoCount; std::atomic aotInfoArray; uint64_t aotInfoArrayChangeTimestamp; uint64_t aotSharedCacheBaseAddress; std::array aotSharedCacheUUID[16]; }; ç„¶åï¼š ã€æœªè§£å†³ã€‘dyld-932.4ä¸­gProcessInfoç¼–è¯‘åsymbolå´æ˜¯__ZN5dyld412gProcessInfoE è‡ªå·±ç¼–è¯‘arm64eç‰ˆçš„Frida å®‰è£…ä¾èµ–åº“ï¼š pip install colorama prompt-toolkit pygments è®¾ç½®Pythonç”¨æ–°ç‰ˆ3.10.6 localå†å»è®¾ç½®ä¸º3.10.6çš„ç‰ˆæœ¬ï¼š crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida î‚° pyenv versions system 3.5.2 3.6.6 3.7.3 * 3.9.4 (set by /Users/crifan/.pyenv/version) 3.10.6 crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida î‚° pyenv local 3.10.6 crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida î‚° python --version Python 3.10.6 clone fridaçš„ä»£ç ï¼š git clone --recurse-submodules https://github.com/frida/frida.git å…ˆmakeçœ‹çœ‹æœ‰å“ªäº›ç¼–è¯‘é€‰é¡¹ï¼š crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida î‚° î‚  main î‚° make make[1]: Entering directory '/Users/crifan/dev/dev_src/ios_reverse/frida/frida' Usage: make TARGET [VARIABLE=value] Where TARGET specifies one or more of: /* gum */ gum-macos Build for macOS gum-ios Build for iOS gum-watchos Build for watchOS gum-tvos Build for tvOS gum-android-x86 Build for Android/x86 gum-android-x86_64 Build for Android/x86-64 gum-android-arm Build for Android/arm gum-android-arm64 Build for Android/arm64 check-gum-macos Run tests for macOS /* core */ core-macos Build for macOS core-ios Build for iOS core-watchos Build for watchOS core-tvos Build for tvOS core-android-x86 Build for Android/x86 core-android-x86_64 Build for Android/x86-64 core-android-arm Build for Android/arm core-android-arm64 Build for Android/arm64 check-core-macos Run tests for macOS /* python */ python-macos Build Python bindings for macOS check-python-macos Test Python bindings for macOS /* node */ node-macos Build Node.js bindings for macOS check-node-macos Test Node.js bindings for macOS /* tools */ tools-macos Build CLI tools for macOS check-tools-macos Test CLI tools for macOS And optionally also VARIABLE values: PYTHON Absolute path of Python interpreter including version suffix NODE Absolute path of Node.js binary For example: $ make python-macos PYTHON=/usr/local/bin/python3.6 $ make node-macos NODE=/usr/local/bin/node make[1]: Leaving directory '/Users/crifan/dev/dev_src/ios_reverse/frida/frida' æ­¤å¤„è¦å»ç¼–è¯‘ï¼šiOSçš„ï¼Œæ‰€ä»¥çœ‹èµ·æ¥æ˜¯ï¼š core-ios Build for iOS æ‰€ä»¥æœ€åå»ï¼š make core-ios æœŸé—´è§£å†³äº†è¯ä¹¦é—®é¢˜ï¼š ã€å·²è§£å†³ã€‘Macä¸­ç¼–è¯‘frida-coreæŠ¥é”™ï¼šFAILED /usr/bin/codesign IOS_CERTID not set ç»§ç»­ï¼š âœ˜ crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida î‚° î‚  main î‚° export MACOS_CERTID=frida-cert crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida î‚° î‚  main î‚° export IOS_CERTID=frida-cert crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida î‚° î‚  main î‚° export WATCHOS_CERTID=frida-cert crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida î‚° î‚  main î‚° export TVOS_CERTID=frida-cert crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida î‚° î‚  main î‚° make core-ios make[1]: Entering directory '/Users/crifan/dev/dev_src/ios_reverse/frida/frida' . build/frida-env-ios-arm64.rc; \\ builddir=build/tmp-ios-arm64/frida-core; \\ if [ ! -f $builddir/build.ninja ]; then \\ meson_args=\"--native-file build/frida-macos-x86_64.txt\"; if [ ios-arm64 != macos-x86_64 ]; then meson_args=\"$meson_args --cross-file build/frida-ios-arm64.txt\"; fi; python3 /Users/crifan/dev/dev_src/ios_reverse/frida/frida/releng/meson/meson.py setup $meson_args \\ --prefix /usr \\ --default-library static -Doptimization=s -Db_ndebug=true --strip -Dconnectivity=enabled -Dmapper=auto \\ -Dassets=installed \\ frida-core $builddir || exit 1; \\ fi \\ && python3 /Users/crifan/dev/dev_src/ios_reverse/frida/frida/releng/meson/meson.py compile -C $builddir \\ && DESTDIR=\"/Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64\" python3 /Users/crifan/dev/dev_src/ios_reverse/frida/frida/releng/meson/meson.py install -C $builddir INFO: autodetecting backend as ninja INFO: calculating backend command to run: /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/toolchain-macos-x86_64/bin/ninja -C /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/tmp-ios-arm64/frida-core ninja: Entering directory `/Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/tmp-ios-arm64/frida-core' [85/85] Generating lib/gadget/frida-gadget with a custom command ninja: Entering directory `/Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/tmp-ios-arm64/frida-core' ninja: no work to do. Installing lib/base/libfrida-base-1.0.a to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib Installing lib/base/frida-base.h to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/include/frida-1.0 Installing lib/base/frida-base-1.0.vapi to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/share/vala/vapi Installing lib/payload/libfrida-payload-1.0.a to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib Installing lib/payload/frida-payload.h to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/include/frida-1.0 Installing lib/payload/frida-payload-1.0.vapi to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/share/vala/vapi Installing lib/agent/frida-agent.dylib to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib/frida Installing lib/gadget/frida-gadget.dylib to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib/frida Installing src/frida-helper to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib/frida Installing src/api/frida-core.h to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/include/frida-1.0 Installing src/api/frida-core-1.0.vapi to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/share/vala/vapi Installing src/api/frida-core-1.0.deps to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/share/vala/vapi Installing src/api/libfrida-core-1.0.a to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib Installing server/frida-server to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/bin Installing portal/frida-portal to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/bin Installing inject/frida-inject to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/bin Installing /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/tmp-ios-arm64/frida-core/meson-private/frida-base-1.0.pc to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib/pkgconfig Installing /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/tmp-ios-arm64/frida-core/meson-private/frida-payload-1.0.pc to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib/pkgconfig Installing /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/tmp-ios-arm64/frida-core/meson-private/frida-core-1.0.pc to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/lib/pkgconfig make[1]: Leaving directory '/Users/crifan/dev/dev_src/ios_reverse/frida/frida' å³å¯ï¼šç¼–è¯‘å®Œæˆã€‚ æˆ‘ä»¬è¦æ‰¾åˆ°çš„ï¼šfrida-serverï¼Œè²Œä¼¼æ˜¯ï¼š Installing server/frida-server to /Users/crifan/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/bin å»çœ‹çœ‹buildç›®å½• crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida î‚° î‚  main î‚° cd build crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build î‚° î‚  main î‚° ll total 56 -rw-r--r-- 1 crifan staff 190B 1 16 11:45 frida-env-ios-arm64.rc -rw-r--r-- 1 crifan staff 193B 1 16 11:45 frida-env-macos-x86_64.rc drwxr-xr-x 3 crifan staff 96B 1 16 11:47 frida-ios-arm64 -rwxr-xr-x 1 crifan staff 430B 1 16 11:45 frida-ios-arm64-pkg-config -rw-r--r-- 1 crifan staff 2.9K 1 16 11:45 frida-ios-arm64.txt -rwxr-xr-x 1 crifan staff 436B 1 16 11:45 frida-macos-x86_64-pkg-config -rw-r--r-- 1 crifan staff 2.9K 1 16 11:45 frida-macos-x86_64.txt -rw-r--r-- 1 crifan staff 217B 1 16 11:44 frida-version.h drwxr-xr-x 8 crifan staff 256B 1 16 11:45 sdk-ios-arm64 drwxr-xr-x 8 crifan staff 256B 1 16 11:44 sdk-macos-x86_64 drwxr-xr-x 4 crifan staff 128B 1 16 11:47 tmp-ios-arm64 drwxr-xr-x 8 crifan staff 256B 1 16 11:44 toolchain-macos-x86_64 crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build î‚° î‚  main î‚° cd frida-ios-arm64 crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64 î‚° î‚  main î‚° ll total 0 drwxr-xr-x 6 crifan staff 192B 1 16 11:47 usr crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64 î‚° î‚  main î‚° cd usr crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr î‚° î‚  main î‚° ll total 0 drwxr-xr-x 6 crifan staff 192B 1 16 15:14 bin drwxr-xr-x 3 crifan staff 96B 1 16 11:47 include drwxr-xr-x 13 crifan staff 416B 1 16 15:14 lib drwxr-xr-x 3 crifan staff 96B 1 16 11:47 share crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr î‚° î‚  main î‚° cd bin crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/bin î‚° î‚  main î‚° ll total 40752 -rwxr-xr-x 1 crifan staff 6.2M 1 16 15:13 frida-inject -rwxr-xr-x 1 crifan staff 5.2M 1 16 15:13 frida-portal -rwxr-xr-x 1 crifan staff 6.4M 1 16 15:13 frida-server -rwxr-xr-x 1 crifan staff 2.1M 1 16 11:47 gum-graft crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_src/ios_reverse/frida/frida/build/frida-ios-arm64/usr/bin î‚° î‚  main î‚° file ./frida-server ./frida-server: Mach-O 64-bit executable arm64 çš„ç¡®æ˜¯ç¼–è¯‘æˆåŠŸäº† å›å»çœ‹çœ‹ä¹‹å‰frida-serverçš„å¤§å°å’Œfileè¾“å‡ºä¿¡æ¯ crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_root/iosReverse/AppleStore/debug/gProcessInfo/iPhone11_151 î‚° ll total 55248 -rwxr-xr-x@ 1 crifan staff 629K 1 13 10:06 dyld -rw-r--r-- 1 crifan staff 2.5M 1 13 22:14 dyld.id0 -rw-r--r-- 1 crifan staff 1.6M 1 13 22:13 dyld.id1 -rw-r--r-- 1 crifan staff 40K 1 13 22:13 dyld.nam -rw-r--r-- 1 crifan staff 1.3K 1 13 22:13 dyld.til -rw-r--r-- 1 crifan staff 173K 1 13 10:44 dyld_jtool2_S_symbol.txt -rw-r--r-- 1 crifan staff 277B 1 13 10:07 dyld_rabin2_E_exports.txt -rw-r--r-- 1 crifan staff 125B 1 13 10:07 dyld_rabin2_i_imports.txt -rw-r--r-- 1 crifan staff 249K 1 13 21:33 dyld_rabin2_s_r_symbols.txt -rw-r--r-- 1 crifan staff 381K 1 13 10:13 dyld_rabin2_s_symbols.txt -rwxr-xr-x 1 crifan staff 20M 1 12 17:55 frida-server -rw-r--r-- 1 crifan staff 169B 1 12 17:58 fridaServer_rabin2_E_exports.txt -rw-r--r-- 1 crifan staff 17K 1 12 17:58 fridaServer_rabin2_i_imports.txt -rw-r--r-- 1 crifan staff 1.9M 1 13 10:18 fridaSever_rabin2_s_symbols.txt crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_root/iosReverse/AppleStore/debug/gProcessInfo/iPhone11_151 î‚° file ./frida-server ./frida-server: Mach-O universal binary with 3 architectures: [arm64:Mach-O 64-bit executable arm64] [arm64e] [arm64e] ./frida-server (for architecture arm64): Mach-O 64-bit executable arm64 ./frida-server (for architecture arm64e): Mach-O 64-bit executable arm64e ./frida-server (for architecture arm64e): Mach-O 64-bit executable arm64e -ã€‹æ­¤å¤„frida-serverå¾ˆå¤§ï¼š20M ä¸è¿‡æ˜æ˜¾æ˜¯ï¼šFATæ ¼å¼ï¼ŒåŒ…å«å¤šä¸ªæ¶æ„ï¼š arm64 arm64e é‚£çœ‹èµ·æ¥ï¼Œè²Œä¼¼æœ‰ä¸ªé—®é¢˜ï¼š æ­¤å¤„ï¼Œä»iPhoneå¯¼å‡ºçš„çœŸå®åœ¨ç”¨çš„frida-serverï¼Œæ”¯æŒï¼šarm64e è€Œæ­¤å¤„è‡ªå·±ç¼–è¯‘å‡ºæ¥çš„ï¼Œåªæ”¯æŒarm64ï¼Œä¸æ”¯æŒarm64e è€Œè®°å¾—ï¼šæ­¤å¤„çš„iPhoneä¸­çš„æ¶æ„éƒ½æ˜¯ï¼šarm64eçš„ï¼Ÿ æ„Ÿè§‰éœ€è¦ï¼š ç¡®è®¤iOS 15.1çš„iPhone11ä¸­ï¼Œæ­¤å¤„armçš„æ¶æ„æ˜¯ï¼šarm64eè¿˜æ˜¯arm64 ç¡®å®šå…¶ä¸­çš„frida-serveræ˜¯å¦éœ€è¦æ”¯æŒarm64e å¦‚æœéœ€è¦æ”¯æŒarm64eï¼Œå†å»çœ‹ï¼šfridaç¼–è¯‘core-iosæ—¶ï¼Œå¦‚ä½•æŒ‡å®šæˆ–åŠ ä¸Šarm64eçš„æ”¯æŒ å…ˆå»ï¼š ã€åŸºæœ¬è§£å†³ã€‘iOS 15.1çš„iPhone11ä¸­frida-serveræ‰€ç”¨æ¶æ„æ˜¯arm64eè¿˜æ˜¯arm64 -ã€‹arm64çš„äºŒè¿›åˆ¶ï¼Œæ˜¯èƒ½æ”¾åˆ°arm64eçš„A13çš„iPhone11ä¸­è¿è¡Œçš„ã€‚ é‚£å…ˆç»§ç»­çœ‹çœ‹ï¼š ã€æœªè§£å†³ã€‘è‡ªå·±ç¼–è¯‘å‡ºçš„arm64çš„frida-serverèƒ½å¦åœ¨iPhone11æ­£å¸¸è¿è¡Œ å…¶ä»–è¿‡ç¨‹è¯¦è§ï¼š ã€æœªè§£å†³ã€‘ç”¨fridaæºç è‡ªå·±ç¼–è¯‘å‡ºfridaçš„iOSçš„åŒ…å«frida-serverçš„debå®‰è£…åŒ… ã€æœªè§£å†³ã€‘è‡ªå·±ç¼–è¯‘å‡ºåŒ…å«arm64å’Œarm64eçš„FATæ ¼å¼çš„frida-serveräºŒè¿›åˆ¶ ã€æœªè§£å†³ã€‘è‡ªå·±ä¿®æ”¹ç¼–è¯‘frida-coreæºç ä»¥å°è¯•è§£å†³Fridaçš„Missing gProcessInfoé—®é¢˜ ã€æœªè§£å†³ã€‘Fridaä¸­å¦‚ä½•ç¼–è¯‘å‡ºiOSçš„arm64eçš„frida-serveräºŒè¿›åˆ¶ ã€æœªè§£å†³ã€‘è‡ªå·±ç¼–è¯‘Fridaçš„frida-coreä»£ç ç”Ÿæˆå¯ç”¨äºŒè¿›åˆ¶frida-server æ‰¾arm64eç‰ˆçš„Frida ä»Fridaæºç å’Œbuildä¸­æ‰¾ ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»Fridaæºç å’Œbuildä¸­æ‰¾ ä»Fridaçš„githubä¸­æ‰¾ ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»Fridaçš„githubä¸­æ‰¾ è‡ªå·±ç»™makeåŠ echoæ‰“å°æ—¥å¿—è°ƒè¯• ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šè‡ªå·±ç»™makeåŠ echoæ‰“å°æ—¥å¿—è°ƒè¯• ä»githubçš„ciçš„workflowä¸­æ‰¾arm64e ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»githubçš„ciçš„workflowä¸­æ‰¾arm64e ä»ç¼–è¯‘æ—¥å¿—ä¸­çš„Downloading ios-arm64å…¥æ‰‹ ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»ç¼–è¯‘æ—¥å¿—ä¸­çš„Downloading ios-arm64å…¥æ‰‹ makeæ—¶å¦‚ä½•ä¼ å…¥arm64eçš„archå‚æ•° ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šmakeæ—¶å¦‚ä½•ä¼ å…¥arm64eçš„archå‚æ•° ä»makeç¼–è¯‘æ—¶çš„logæ—¥å¿—å…¥æ‰‹ ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»makeç¼–è¯‘æ—¶çš„logæ—¥å¿—å…¥æ‰‹ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 22:18:57 "},"common_issue/":{"url":"common_issue/","title":"å¸¸è§é—®é¢˜","keywords":"","body":"å¸¸è§é—®é¢˜ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 15:57:12 "},"common_issue/universal/":{"url":"common_issue/universal/","title":"é€šç”¨","keywords":"","body":"é€šç”¨ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 16:00:50 "},"common_issue/universal/process_terminated.html":{"url":"common_issue/universal/process_terminated.html","title":"Process terminated","keywords":"","body":"Process terminated å…³äºProcess terminated=è¿›ç¨‹ç»“æŸ=å´©æºƒé€€å‡ºï¼Œç›®å‰é‡åˆ°å¤šç§ç°è±¡å’Œå¯èƒ½åŸå› ï¼š ç”±äºhookå‡½æ•°å¤ªå¤šå¯¼è‡´å´©æºƒ ç°è±¡ä¸€ï¼šç”¨frida-traceå»hookå¤ªå¤šçš„ç±»Objçš„å‡½æ•°frida-trace -U -F com.apple.Preferences -m \"*[AA* *]\" -m \"*[AK* *]\" -m \"*[AS* *]\" -m \"*[NS* *]\" -M \"-[ASDBundle copyWithZone:]\" -M \"-[ASDInstallationEvent copyWithZone:]\" å¯¼è‡´å´©æºƒé€€å‡ºæŠ¥é”™ï¼šProcess terminated åŸå› ï¼šfrida-traceå»hookçš„å‡½æ•°å¤ªå¤šäº†ï¼Œä¼°è®¡æ˜¯ï¼ŒåŠ äº†-m \"*[NS* *]\"åå¯¼è‡´å´©æºƒ æ³¨ï¼šiOSçš„ObjCçš„å†…éƒ¨çš„å¤šæ•°ï¼Œç”šè‡³æ˜¯å¤§å¤šæ•°ï¼Œéƒ½æ˜¯NSå¼€å¤´çš„ï¼Œå¯¼è‡´åŒ¹é…åˆ°å¤ªå¤šçš„ç±»å’Œå‡½æ•°ï¼Œç³»ç»Ÿå¤„ç†ä¸è¿‡æ¥äº†ï¼Œå¯¼è‡´fridaå´©æºƒï¼ŒåŒæ—¶å¯¼è‡´è¢«è°ƒè¯•çš„appå´©æºƒã€‚ æ³¨ï¼šNS=NextStepï¼Œæ˜¯iOSç³»ç»Ÿå‰èº«çš„è‹¹æœæ”¶è´­çš„NextStepå…¬å¸åå­— è§£å†³åŠæ³•ï¼šå‡å°‘hookçš„èŒƒå›´=ç¼©å°åŒ¹é…èŒƒå›´ï¼Œæ¯”å¦‚æ­¤å¤„æ”¹ä¸ºï¼š-m \"*[NSXPC* *]\"ï¼Œæš‚æ—¶åªå…³æ³¨æˆ‘ä»¬è¦è°ƒè¯•çš„NSXPCConnectionçš„ç›¸å…³å†…å®¹ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ï¼šé¿å…å´©æºƒ fridaçš„new ObjC.Objectæ–¹é¢çš„bug ç°è±¡ï¼š æ¦‚è¿°fridaè°ƒè¯•æ—¶ï¼Œç”±äºåŠ äº†new ObjC.Object(someArg)çš„ptrè½¬æ¢æˆObjCçš„å¯¹è±¡ï¼Œç»“æœå°±ä¼šæ—¶ä¸æ—¶çš„é‡åˆ°Process terminatedï¼Œè€Œå´©æºƒåœæ­¢é€€å‡ºè°ƒè¯• è¯¦è§£=å…·ä½“ç°è±¡ ä»£ç ï¼š ... function hook_class_method(class_name, method_name) { var hook = ObjC.classes[class_name][method_name]; Interceptor.attach(hook.implementation, { onEnter: function(args) { console.log(\"=========== [*] Detected call to: \" + class_name + \" -> \" + method_name); //objcçš„å‡½æ•°ï¼Œç¬¬0ä¸ªå‚æ•°æ˜¯idï¼Œç¬¬1ä¸ªå‚æ•°æ˜¯SELï¼ŒçœŸæ­£çš„å‚æ•°ä»args[2]å¼€å§‹ const argId = args[0]; // console.log(\"argId: \", argId); const argSel = args[1]; // console.log(\"argSel: \", argSel); const argSelStr = ObjC.selectorAsString(argSel); console.log(\"argSelStr: \", argSelStr); const argCount = occurrences(argSelStr, \":\"); console.log(\"argCount: \", argCount); for (let curArgIdx = 0; curArgIdx å¯ä»¥hookè¾“å‡ºéƒ¨åˆ†logæ—¥å¿—ï¼Œä½†æ˜¯å¾ˆå¿«ï¼Œæ—¶ä¸æ—¶çš„ï¼Œå°±å´©æºƒé€€å‡ºäº†ï¼š âœ˜ crifan@licrifandeMacBook-Pro î‚° ~/dev/dev_root/iosReverse/AppleStore/Preferences_app/dynamicDebug/frida î‚° frida -U -l hookAccountLogin_NSURL.js -F ____ / _ | Frida 16.0.10 - A world-class dynamic instrumentation toolkit | (_| | > _ | Commands: /_/ |_| help -> Displays the help system . . . . object? -> Display information about 'object' . . . . exit/quit -> Exit . . . . . . . . More info at https://frida.re/docs/home/ . . . . . . . . Connected to iPhone (id=abdc0dd961c3cb96f5c4afe109de4eb48b88433a) [*] Started: Hook all methods of a specific class [+] Class Name: NSURL [*] Omit hooking + allocWithZone: [*] Omit hooking - _cfTypeID [*] Omit hooking - retain [*] Omit hooking - release [*] Omit hooking - copyWithZone: [*] Completed: Hook all methods of a specific class [iPhone::è®¾ç½® ]-> =========== [*] Detected call to: NSURL -> - scheme argSelStr: scheme argCount: 0 =========== [*] Detected call to: NSURL -> - _cfurl argSelStr: _cfurl argCount: 0 =========== [*] Detected call to: NSURL -> - scheme argSelStr: scheme argCount: 0 =========== [*] Detected call to: NSURL -> - _cfurl argSelStr: _cfurl argCount: 0 =========== [*] Detected call to: NSURL -> + fileURLWithPath:isDirectory: argSelStr: fileURLWithPath:isDirectory: argCount: 2 ---------- [0] curArg=0x282336580 curArg className: undefined curArgObj: /var/mobile/Library/Caches/com.apple.AppleAccount curArgObj className: NSPathStore2 ---------- [1] curArg=0x0 =========== [*] Detected call to: NSURL -> - initFileURLWithPath:isDirectory: argSelStr: initFileURLWithPath:isDirectory: argCount: 2 ---------- [0] curArg=0x282336580 curArg className: undefined curArgObj: /var/mobile/Library/Caches/com.apple.AppleAccount curArgObj className: NSPathStore2 ---------- [1] curArg=0x0 =========== [*] Detected call to: NSURL -> - setResourceValues:error: argSelStr: setResourceValues:error: argCount: 2 Process terminated [iPhone::è®¾ç½® ]-> Thank you for using Frida! åŸå› ï¼šæš‚ä¸å®Œå…¨æ¸…æ¥š å¯èƒ½åŸå› ï¼šfridaçš„ObjCçš„Objcectè½¬æ¢æ–¹é¢çš„bugï¼Œæš‚æ—¶æ— æ³•è§£å†³ è¯¦è§ï¼š ã€æœªè§£å†³ã€‘fridaä¸­hookå‡½æ•°æ‰“å°å‚æ•°å€¼æ—¶æœ€åappå´©æºƒfridaè¾“å‡ºProcess terminated ã€æœªè§£å†³ã€‘fridaä¸­hookè°ƒè¯•iOSçš„ObjCçš„å‡½æ•°å‚æ•°æ—¶å§‹ç»ˆå‡ºç°å´©æºƒProcess terminated crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 15:57:08 "},"common_issue/universal/unable_find_process.html":{"url":"common_issue/universal/unable_find_process.html","title":"unable to find process with name","keywords":"","body":"Failed to spawn: unable to find process with name æŠ¥é”™ï¼šFailed to spawn: unable to find process with name 'Preferences' åŸå› ï¼šfridaå‘½ä»¤ç”¨çš„æ˜¯frida -U -l ./hookAccountLogin.js -n Preferences å…¶ä¸­-næ˜¯åŠ äºŒè¿›åˆ¶åç§°ï¼Œæ­¤å¤„Preferencesæ˜¯appï¼Œæ‰€ä»¥å±äºå‚æ•°ä½¿ç”¨é”™è¯¯ï¼Œè°ƒè¯•ç›®æ ‡è¯­æ³•æé”™äº† è§£å†³åŠæ³•ï¼š ææ‡‚fridaçš„è°ƒè¯•ç›®æ ‡æ–¹å¼ï¼Œæ”¹ä¸ºåˆ«çš„æ–¹å¼å³å¯ æ–¹å¼1ï¼šç”¨-N app_package_idfrida -U -l ./hookAccountLogin.js -N com.apple.Preferences æ–¹å¼2ï¼šæ¢-p PIDfrida -U -l ./hookAccountLogin.js -p 18031 å…¶ä¸­æ˜¯ç”¨iPhoneä¸­sshä¸­é€šè¿‡psæŸ¥çœ‹åˆ°~ ps -A | grep Preferences ... 18031 ?? 0:02.43 /Applications/Preferences.app/Preferences å¾—çŸ¥Preferencesçš„PIDæ˜¯18031 æ–¹å¼3ï¼šç”¨-Ffrida -U -l ./hookAccountLogin.js -F æ³¨ï¼šç¡®ä¿Preferences=ç³»ç»Ÿçš„è®¾ç½®appï¼Œå¤„äºæœ€å‰å°åœ¨è¿è¡Œæ‰èƒ½ç”¨-F crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 16:01:33 "},"common_issue/universal/unable_to_attach_to_the_specified_proces.html":{"url":"common_issue/universal/unable_to_attach_to_the_specified_proces.html","title":"unable to attach to the specified proces","keywords":"","body":"Failed to attach unable to attach to the specified proces èƒŒæ™¯ï¼šç”¨palera1nCè¶Šç‹±å æ³¨ï¼šä¹‹å‰åªæœ‰palera1nCèƒ½è¶Šç‹±15.6çš„ç³»ç»Ÿ ç°è±¡ï¼šfrida-traceå»hookè°ƒè¯•æŠ¥é”™~% frida-trace -U -i CCCrypt -p 12959 Failed to attach: unable to attach to the specified proces åŸå› ï¼šiPhoneç«¯çš„fridaï¼ˆfrida-serverï¼‰æ²¡æœ‰æ­£å¸¸è¿è¡Œ å¦‚ä½•ç¡®è®¤=å¦‚ä½•æ‰¾åˆ°çš„é—®é¢˜çš„åŸå› ï¼ŸiPhone:~ root# ps -A l grep frida 3576 ttys000 0:00.00 grep frida iPhone:~root# è§£å†³åŠæ³• iPhoneç«¯ï¼Œé‡æ–°å®‰è£…fridaï¼Œç¡®ä¿å®‰è£…åfrida-serverå·²æ­£å¸¸å¯åŠ¨åœ¨è¿è¡Œ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-23 17:16:38 "},"common_issue/universal/pause_or_no_pause.html":{"url":"common_issue/universal/pause_or_no_pause.html","title":"--no-pauseå’Œ--pause","keywords":"","body":"--no-pauseå’Œ--pause å…³äºfridaå¯åŠ¨åï¼Œè¢«è°ƒè¯•çš„ç›®æ ‡ï¼Œæ˜¯å¦æš‚åœè¿è¡Œçš„é—®é¢˜ï¼š èƒŒæ™¯ fridaå¯åŠ¨è°ƒè¯•åï¼Œè¢«è°ƒè¯•çš„ç›®æ ‡ï¼ˆappæˆ–è¿›ç¨‹ï¼‰ï¼Œæ˜¯å¦å·²ç»æš‚åœè¿è¡Œ æ—§ç‰ˆfridaï¼šè‡ªåŠ¨æš‚åœè¿è¡Œ æ”¯æŒå‚æ•°ï¼š--no-pause æ–°ç‰ˆfridaï¼šï¼ˆé€»è¾‘å·²ç»å˜æˆäº†ï¼‰ä¸æš‚åœè¿è¡Œ = å·²ç»ç»§ç»­è¿è¡Œäº† æ”¯æŒå‚æ•°ï¼š--pause æ‰€ä»¥ æ—§ç‰ˆfrida å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæ¯æ¬¡fridaï¼ˆä»¥AttachåSpawnå»ï¼‰å¯åŠ¨è°ƒè¯•åï¼Œç¨‹åºè‡ªåŠ¨æš‚åœè¿è¡Œ è§£å†³åŠæ³•ï¼šæ‰‹åŠ¨è¾“å…¥%resume æ‰€ä»¥å°±å¸Œæœ›ï¼šfridaè°ƒè¯•å¼€å§‹åï¼Œè‡ªåŠ¨ç»§ç»­è¿è¡Œï¼Œä¸è¦æ¯æ¬¡éƒ½è¾“å…¥%resumeæ‰ç»§ç»­è¿è¡Œ è§£å†³åŠæ³•ï¼šåŠ --no-pauseå‚æ•° å‚æ•°å«ä¹‰ï¼š--no-pause automatically start main thread after startup ä¸¾ä¾‹frida -U --no-pause -f com.ss.iphone.ugc.Aweme -l frida/dyldImage.js æ–°ç‰ˆfrida ç”¨æ–°ç‰ˆfridaï¼ŒåŠ äº†å‚æ•°--no-pauseï¼ŒæŠ¥é”™ä¸æ”¯æŒæ­¤å‚æ•°ï¼šfrida: error: unrecognized arguments: --no-pause è§£å†³åŠæ³•ï¼šä¸è¦åŠ ä»»ä½•å‚æ•° ä¸¾ä¾‹frida -U -N com.apple.Preferences -l hookAccountLogin_singleClassAllMethod.js -ã€‹ å¦‚æœéœ€è¦å¯åŠ¨å è‡ªåŠ¨ç»§ç»­è¿è¡Œ åˆ™ï¼šæ— éœ€åŠ ä»»ä½•å‚æ•° å› ä¸ºæ–°ç‰ˆfridaå·²ç»å˜æˆè¿™ä¸ªé€»è¾‘äº† è‡ªåŠ¨æš‚åœè¿è¡Œ å†å»åŠ æ–°ç‰ˆæ‰æ”¯æŒçš„å‚æ•°ï¼š--pause å‚æ•°å«ä¹‰ï¼š--pause leave main thread paused after spawning program crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 16:04:01 "},"common_issue/universal/bad_access_invalid_address.html":{"url":"common_issue/universal/bad_access_invalid_address.html","title":"Bad access due to invalid address","keywords":"","body":"Process crashed: Bad access due to invalid address é—®é¢˜ï¼š Called: -[WARegistrationURLBuilder clientLogRequestURLWithCurrentScreen:previousScreen:actionTaken:] ... argCount: 3 ---------- [0] curArgPtr=0xc Process crashed: Bad access due to invalid address ... åŸå›  è¡¨é¢åŸå› ï¼šè®¿é—®äº†éæ³•åœ°å€ï¼š0xc æ·±å±‚æ¬¡åŸå› ï¼šå¯¹äºå€¼æ˜æ˜¾å¼‚å¸¸çš„åœ°å€ï¼Œæ²¡æœ‰åšè¿‡æ»¤ï¼Œæ²¡æœ‰æ’é™¤æ‰ è§£å†³åŠæ³•ï¼šåŠ ä¸Šè¿‡æ»¤ï¼Œæ’é™¤æ‰ï¼Œåœ°å€å€¼æ˜æ˜¾å¼‚å¸¸çš„åœ°å€ å…·ä½“æ­¥éª¤ï¼š ä»£ç æ”¹ä¸ºï¼š // check pointer is valid or not // example // 0x103e79560 => true // 0xc => false function isValidPointer(curPtr){ let MinValidPointer = 0x10000 var isValid = curPtr > MinValidPointer return isValid } ... if (isValidPointer(curArg)) { ... } å³å¯é¿å…è®¿é—®éæ³•åœ°å€æŒ‡é’ˆï¼Œé¿å…å´©æºƒã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 16:04:45 "},"common_issue/universal/file_descriptor_cannot_negative_integer.html":{"url":"common_issue/universal/file_descriptor_cannot_negative_integer.html","title":"ValueError file descriptor cannot be a negative integer","keywords":"","body":"ValueError: file descriptor cannot be a negative integer é—®é¢˜ï¼šfrida-psã€frida-ls-devicesç­‰frida-toolså·¥å…·è¿è¡Œæ—¶æŠ¥é”™ï¼šValueError: file descriptor cannot be a negative integer (-42) åŸå› ï¼šå½“å‰12.0.3çš„frida-toolsæœ‰bug è§£å†³åŠæ³•ï¼šå‡çº§åˆ°æœ€æ–°ç‰ˆfrida-tools å…·ä½“æ­¥éª¤ï¼špip install --upgrade frida_tools æ³¨ï¼šæŸ¥çœ‹å½“å‰frida-toolsçš„ç‰ˆæœ¬ï¼špip show frida_tools crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 15:55:41 "},"common_issue/universal/stuck_spawning.html":{"url":"common_issue/universal/stuck_spawning.html","title":"å¡æ­»åœ¨Spawning","keywords":"","body":"å¡æ­»åœ¨Spawning ç°è±¡ï¼šfridaå»hookæ—¶ï¼Œä¸€ç›´æ˜¾ç¤º=å¡æ­»åœ¨Spawningâœ frida frida -U -f com.ss.android.ugc.aweme -l hook_douyin.js ____ / _ | Frida 16.4.6 - A world-class dynamic instrumentation toolkit | (_| | > _ | Commands: /_/ |_| help -> Displays the help system . . . . object? -> Display information about 'object' . . . . exit/quit -> Exit . . . . . . . . More info at https://frida.re/docs/home/ . . . . . . . . Connected to Pixel 5 (id=9C181A8D3C3F3B) Spawning `com.ss.android.ugc.aweme`... -> å½“æ—¶çš„é”™è¯¯æ“ä½œï¼šä»¥ä¸ºçœŸçš„å¡æ­»äº†ï¼Œæ‰€ä»¥å»æ‰¾åˆ«çš„å¯èƒ½çš„åŸå› ï¼Œæ‰€ä»¥å°±å»ç›´æ¥ç”¨Ctrl+Cä¸­æ–­è¿è¡Œäº† åŸå› ï¼šå…¶å®å¹¶æ²¡æœ‰å¡æ­»ï¼Œè€Œæ˜¯å¤šç­‰ä¼šï¼Œä¼šæœ‰æœ€ç»ˆç»“æœ æ˜¯è¶…æ—¶æŠ¥é”™ï¼Œè¿˜æ˜¯èƒ½æ­£å¸¸è¿è¡Œ è§£å†³åŠæ³•ï¼šå¤šç­‰ä¸€ä¼šï¼Œçœ‹çœ‹æœ€ç»ˆçš„ç»“æœ ç»“æœ1ï¼šæ­£å¸¸ ç»“æœ1ï¼šæ­£å¸¸ç»§ç»­hookå’Œè¾“å‡ºlog âœ frida frida -U -f com.ss.android.ugc.aweme -l hook_douyin.js ... Spawning `com.ss.android.ugc.aweme`... Java is available Java.androidVersion=13 Spawned `com.ss.android.ugc.aweme`. Resuming main thread! [Pixel 5::com.ss.android.ugc.aweme ]-> è§£å†³åŠæ³•ï¼šæ— éœ€ä»»ä½•æ“ä½œï¼Œåªæ˜¯ç¨å¾®å¤šç­‰ä¼š ç»“æœ2ï¼šå¼‚å¸¸ ç»“æœ1ï¼šæŠ¥é”™è¶…æ—¶ç­‰å¼‚å¸¸ æƒ…å†µ1 âœ frida frida -U -f com.ss.android.ugc.aweme -l hook_douyin.js ... . . . . Connected to Pixel 5 (id=9C181A8D3C3F3B) Failed to spawn: timeout was reached æ­¤å¤„çš„èƒŒæ™¯ æ­¤å¤„ä¹‹å‰Fridaçš„hookï¼Œè§¦å‘è¾“å‡ºå¤ªå¤šlogï¼Œè‡ªå·±å¼ºåˆ¶è¾“å…¥ï¼ˆå¤šæ¬¡è¾“å…¥ï¼Œå› ä¸ºè¾“å‡ºlogå¤ªå¤šï¼Œéƒ½æ— æ³•é¡ºåˆ©è¾“å…¥ï¼‰exité€€å‡ºFridaåï¼Œç„¶åä¸çŸ¥é“ä»€ä¹ˆæƒ…å†µï¼Œæ€»ä¹‹æ˜¯ï¼šå¯¼è‡´äº†å®‰å“ç«¯çš„Fridaå¼‚å¸¸ è§£å†³åŠæ³•ï¼šé‡å¯Androidæ‰‹æœº æƒ…å†µ2 âœ frida frida -U -f com.ss.android.ugc.aweme -l hook_douyin.js ... . . . . Connected to Pixel 5 (id=9C181A8D3C3F3B) Failed to spawn: unexpectedly timed out while waiting for app to launch è§£å†³åŠæ³•ï¼šå¤šè¯•è¯•å‡ æ¬¡ï¼ˆæœ‰æ—¶å€™å°±æ­£å¸¸äº†ï¼‰ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-26 09:57:19 "},"common_issue/ios/":{"url":"common_issue/ios/","title":"iOS","keywords":"","body":"iOS crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:25:54 "},"common_issue/ios/xinaa15_frida.html":{"url":"common_issue/ios/xinaa15_frida.html","title":"XinaA15ä¸­çš„frida","keywords":"","body":"XinaA15ä¸­çš„frida XinaA15 æˆªè‡³XinaA15 v1.1.8 + Sileo Nightly v2.4 + Frida v16.0.11ï¼šåœ¨rootlessè¶Šç‹±çš„XinaA15ä¸­ï¼Œæ— æ³•é€šè¿‡Sileo Nightlyæ­£å¸¸å®‰è£…å’Œä½¿ç”¨Frida åªè¦ä¸€ä½¿ç”¨fridaå·¥å…·ï¼ˆæ¯”å¦‚frida-ps -Uç­‰ï¼‰å°±ä¼šå¯¼è‡´iPhoneé‡å¯ ä¸”å®‰è£…å’Œå¸è½½éƒ½ä¼šå‡ºç°ä¸€äº›å¼‚å¸¸æŠ¥é”™ å®‰è£…Frida /var/jb/var/ib/Library/LaunchDaemons/re.frida.server.plist service is disabled ä¸”æ­¤å¤„Sileo Nightly v2.4ä¸­çœ‹åˆ°çš„æœ€æ–°ç‰ˆFrida v16.0.13ï¼Œç«Ÿç„¶è¿˜ä¼šå‡ºç°æ— æ³•å®‰è£…ï¼š404é”™è¯¯ å¸è½½Frida /var/jb/var/jb/Library/LaunchDaemons/re.frida.server.plist: Could not find specified service crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-22 15:26:24 "},"common_issue/ios/need_gadget_attach.html":{"url":"common_issue/ios/need_gadget_attach.html","title":"need Gadget to attach on jailed iOS","keywords":"","body":"Failed to attach: need Gadget to attach on jailed iOS é—®é¢˜ï¼šMacä¸­ç”¨fridaå¯åŠ¨iOSç‰ˆæŠ–éŸ³frida -U -f com.ss.iphone.ugc.Aweme æŠ¥é”™Failed to attach: need Gadget to attach on jailed iOS; its default location is: /Users/crifan/.cache/frida/gadget-ios.dylib åŸå› ï¼šç¼ºå°‘å¯¹åº”çš„Fridaçš„gadgetåº“æ–‡ä»¶ è§£å†³åŠæ³• æ¦‚è¿°ï¼šä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„gadgetåº“æ–‡ä»¶ï¼Œæ”¾åˆ°å¯¹åº”ä½ç½®ï¼ˆæ­¤å¤„æç¤ºçš„/Users/crifan/.cache/frida/gadget-ios.dylibï¼‰å³å¯ è¯¦è§ï¼šå®‰è£…Fridaä¸­çš„å®‰è£…Fridaçš„gadget crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 16:05:41 "},"common_issue/ios/iphone_reboot.html":{"url":"common_issue/ios/iphone_reboot.html","title":"å¯¼è‡´iPhoneé‡å¯","keywords":"","body":"å¯¼è‡´iPhoneé‡å¯ ä¹‹å‰é‡åˆ°è¿‡ï¼š XinaA15çš„rootlessè¶Šç‹±çš„iPhone11ä¸­ï¼Œç”¨æœ€æ–°ç‰ˆv16.0.10çš„Fridaï¼Œä½†æ˜¯å´ä¼šå¯¼è‡´iPhoneé‡å¯ï¼ˆä»è€Œä¸¢å¤±XinaA15çš„è¶Šç‹±ï¼Œéœ€è¦å†å»æ¢å¤è¶Šç‹±ï¼‰ ä½†æ˜¯ï¼šæ²¡æœ‰è§£å†³æ–¹æ¡ˆã€‚ ç›®å‰çš„ç»“è®ºæ˜¯ï¼š ï¼ˆXinaA15ç­‰ï¼‰rootlessè¶Šç‹±åï¼ŒFridaçš„ä½¿ç”¨ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸ªå¤§é—®é¢˜ï¼Œæœ‰æ—¶å€™ï¼ˆæŸä¸ªæ—§ç‰ˆæœ¬ï¼‰èƒ½ç”¨ï¼Œæœ‰æ—¶å€™ï¼ˆæ­¤å¤„æ–°ç‰ˆv16.0.10ï¼‰å´åˆæ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 15:49:46 "},"common_issue/ios/waiting_usb_device_appear.html":{"url":"common_issue/ios/waiting_usb_device_appear.html","title":"Waiting for USB device to appear","keywords":"","body":"Waiting for USB device to appear é—®é¢˜ï¼šMacä¸­è¿è¡Œfridaå»è°ƒè¯•appfrida -U -f com.apple.store.Jolly ä½†æ˜¯æŠ¥é”™Waiting for USB device to appear... åŸå› ï¼šï¼ˆè¿æ¥iPhoneåˆ°Macçš„ï¼‰USBæ•°æ®çº¿æ²¡æ’å¥½ è§£å†³åŠæ³•ï¼šé‡æ–°æ‹”æ’USBæ•°æ®çº¿ï¼Œç¡®ä¿USBè¿æ¥æ­£å¸¸ æ³¨ï¼š å¦‚ä½•ç¡®è®¤iPhoneæ˜¯å¦å·²æ’å¥½ æ–¹å¼1ï¼šé€šè¿‡çˆ±æ€åŠ©æ‰‹å¯ä»¥ç¡®è®¤ å·²æ’å¥½ï¼šèƒ½çœ‹åˆ°iPhoneè¯¦æƒ… æ²¡æ’å¥½ï¼šçœ‹ä¸åˆ°iPhoneè®¾å¤‡ æ–¹å¼2ï¼šç”¨fridaçš„å·¥å…·frida-ls-devices crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 16:05:19 "},"common_issue/ios/unable_intercept_function_at.html":{"url":"common_issue/ios/unable_intercept_function_at.html","title":"unable to intercept function at","keywords":"","body":"Error unable to intercept function at please file a bug ç°è±¡ï¼šFridaçš„hookçš„jsä»£ç ä¸­ï¼Œå‡½æ•°åœ°å€å†™çš„æ˜¯ï¼švar akdSymbol2575_functionAddress = 0x1000a0460; å¯¼è‡´æŠ¥é”™ï¼šmoduleName= akd moduleBaseAddress= 0x102b40000 functionRealAddress)= 0x202be0460 Error: unable to intercept function at 0x202be0460; please file a bug at value (frida/runtime/core.js:367) åŸå› ï¼šå‡½æ•°åœ°å€å†™é”™äº† -ã€‹ æ‰¾ä¸åˆ°å‡½æ•°åœ°å€ -ã€‹ æ‰€ä»¥æŠ¥é”™ è§£å†³åŠæ³•ï¼šç¡®ä¿å‡½æ•°åœ°å€æ˜¯æ­£ç¡®çš„ å…·ä½“åšæ³•ï¼šä»£ç æ”¹ä¸ºï¼švar akdSymbol2575_functionAddress = 0xa0460; è¯´æ˜ 0x1000a0460 æ˜¯ åŠ äº†VM è™šæ‹Ÿåœ°å€åçš„ akdäºŒè¿›åˆ¶å†…å‡½æ•°çš„åœ°å€ 0xa0460ï¼šæ˜¯ä¸å¸¦VMçš„ï¼ŒçœŸæ­£çš„å‡½æ•°å†…çš„åç§»åœ°å€ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 15:54:49 "},"common_issue/android/":{"url":"common_issue/android/","title":"Android","keywords":"","body":"Android crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-21 16:02:35 "},"common_issue/android/java_js_mapping.html":{"url":"common_issue/android/java_js_mapping.html","title":"Javaå’Œjså˜é‡çš„æ˜ å°„å…³ç³»","keywords":"","body":"Fridaä¸­çš„Javaå’Œjså˜é‡ç±»å‹çš„æ˜ å°„å…³ç³» æ­¤å¤„Javaä¸­çš„å˜é‡ç±»å‹ï¼Œè½¬æ¢æˆFridaä¸­çš„ç±»å‹çš„å†™æ³•æ˜¯ï¼š Fridaï¼ˆçš„jsï¼‰ä¸­çš„å˜é‡ç±»å‹ï¼Œå…¶åº•å±‚æ¥è‡ªäºDex æ‰€ä»¥å…¶å®å°±æ˜¯ï¼š Fridaçš„ç±»å‹ == Dexä¸­çš„ç±»å‹ çš„è¯­æ³• å³ï¼š Javaå˜é‡ç±»å‹ -ã€‹ Frida=Dexå˜é‡ç±»å‹ éæ•°ç»„åˆ—è¡¨ ç®€å•ç±»å‹ å®Œæ•´å†™æ³• int int byte byte short short long long float float double double char char -ã€‹ ç¼©å†™ ShortyDescriptor ç¼©å†™ è¯´æ˜ V voidï¼›ä»…å¯¹è¿”å›ç±»å‹æœ‰æ•ˆ Z boolean B byte S short C char I int J long F float D double ç‰¹æ®Šçš„å¯¹è±¡Object == å¸¦çˆ¶ç±»ï¼Œå¸¦è·¯å¾„çš„Javaçš„ç±»ï¼šå‰ç¼€L + ç‚¹. å˜æˆ æ–œæ / + åç¼€åˆ†å·; è¯­æ³•ï¼šLfully/qualified/Name; è¯´æ˜ï¼šç±»fully.qualified.Name ä¸¾ä¾‹ Ljava/lang/String; Ljava/lang/Object; Ljava/lang/System; Ljava/io/PrintStream; Ljava/net/InetAddress; Ljava/time/LocalDateTime; Ljava/lang/ClassLoader; åˆ—è¡¨=æ•°ç»„ï¼šå‰é¢å†åŠ ä¸ªï¼šå·¦ä¸­æ‹¬å·[ è¯­æ³• [descriptor è¯´æ˜ descriptor çš„æ•°ç»„ï¼Œå¯é€’å½’åœ°ç”¨äºâ€œæ•°ç»„çš„æ•°ç»„â€ï¼Œä½†ç»´æ•°ä¸èƒ½è¶…è¿‡ 255 ä¸¾ä¾‹ æ™®é€šç±»å‹ï¼šå­—æ¯ç¼©å†™ int[] -> [I byte[] -> [B short[] -> [S long[] -> [J float[] -> [F double[] -> [D char[] -> [C ç‰¹æ®Šç±»å‹ï¼šç”¨ï¼ˆFrida=Dexä¸­çš„ï¼‰å®Œæ•´ç±»åå†™æ³• [Ljava/lang/String; [Ljava/lang/Object; [Ldalvik/system/DexPathList$Element; å«ä¹‰ = ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ï¼š ï¼ˆ1ï¼‰Javaç›¸å…³ï¼šå‡½æ•°çš„ç­¾å=å®šä¹‰ ä¸¾ä¾‹1ï¼š runtime/native/dalvik_system_DexFile.cc - platform/art - Git at Google (googlesource.com) NATIVE_METHOD(DexFile, createCookieWithArray, \"([BII)Ljava/lang/Object;\"), -ã€‹ ([BII)Ljava/lang/Object; ([BII) æ‹¬å·å†…æ˜¯å‡½æ•°å‚æ•° [BII [B = byte[] = å­—èŠ‚ç æ•°ç»„åˆ—è¡¨ I = int I = int Ljava/lang/Object; ç±»å‹ï¼šObject -ã€‹æ‰€ä»¥å‡½æ•°çš„å®Œæ•´å®šä¹‰ ç±»å‹ å°±æ˜¯è¿™æ ·çš„ï¼š Object createCookieWithArray(byte[], int, int) ä¸¾ä¾‹2ï¼š NATIVE_METHOD(DexFile, isProfileGuidedCompilerFilter, \"(Ljava/lang/String;)Z\"), -ã€‹ (Ljava/lang/String;)Z (Ljava/lang/String;) Ljava/lang/String; Z -ã€‹ void isProfileGuidedCompilerFilter(String) ï¼ˆ2ï¼‰Fridaä¸­ Fridaä¸­ï¼Œå®šä¹‰Objectæ•°ç»„çš„å†™æ³•ï¼š var JavaObjArr = Java.use(\"[Ljava.lang.Object;\") console.log(\"JavaObjArr=\" + JavaObjArr) è¾“å‡ºï¼š JavaObjArr= æŠŠå˜é‡è½¬æ¢ä¸ºObjectçš„æ•°ç»„ï¼š var objArr = Java.cast(obj, JavaObjArr) console.log(\"objArr=\" + objArr) è¾“å‡ºï¼š objArr=[Ljava.lang.Object;@fc9e9af crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-11-22 16:38:41 "},"common_issue/android/java_lang_classnotfoundexception.html":{"url":"common_issue/android/java_lang_classnotfoundexception.html","title":"java.lang.ClassNotFoundException","keywords":"","body":"Error java.lang.ClassNotFoundException Didn't find class on path DexPathList zip file æƒ…å†µ1ï¼šç±»åé”™äº† ç°è±¡ hookæŠ¥é”™ï¼š Error: java.lang.ClassNotFoundException: Didn't find class zzz.xxx on path: DexPathList[[zip file å³ï¼šæ‰¾ä¸åˆ°ç±»å åŸå› ï¼šç±»åå†™é”™äº† æ ¹æœ¬åŸå› ï¼š ä¹‹å‰Jadxåç¼–è¯‘å‡ºçš„æºç ä¸­çš„æ–‡ä»¶åsources/zzz/xxx.javaä¸­çš„xxxä¸æ˜¯çœŸæ­£çš„ç±»å è€Œæ³¨é‡Šä¸­renamed from: yyyæ‰æ˜¯çœŸæ­£çš„ç±»å è§£å†³åŠæ³•ï¼šæŠŠåå­—æ”¹ä¸ºçœŸæ­£çš„Javaçš„ç±»åï¼šyyy æƒ…å†µ2ï¼šç±»ä¸åœ¨å½“å‰hookçš„äºŒè¿›åˆ¶ä¸­ èƒŒæ™¯ å®‰å“é€†å‘æœŸé—´ï¼Œå»æ ¹æ®ä¹‹å‰Logcatæ—¥å¿—ï¼š 2023-08-31 10:26:23.911 6481-6481 AppButtonsPrefCtl com.android.settings D Stopping package com.wallpaper.hd.funny æ‰¾åˆ°äº†å®‰å“å†…éƒ¨çš„ç±»ï¼šcom.android.server.pm.Settingsä¸­çš„å‡½æ•°ï¼šcreateNewSettingï¼Œè¾“å‡ºäº†ä¸Šè¿°çš„log ç°è±¡ å»Fridaä¸­ç”¨jsä»£ç ï¼š var SettingsCls = Java.use(\"com.android.server.pm.Settings\") å»hookå®‰å“å†…éƒ¨çš„ç±»ï¼šcom.android.server.pm.Settings frida -U -f com.android.settings -l hook_360Wallpaper.js æŠ¥é”™ï¼š Error: java.lang.ClassNotFoundException: Didn't find class \"com.android.server.pm.Settings\" on path: DexPathList[[zip file \"/system_ext/priv-app/SettingsGoogle/SettingsGoogle.apk\"],nativeLibraryDirectories=[/system_ext/priv-app/SettingsGoogle/lib/arm64, /system/lib64, /system_ext/lib64, /system/lib64, /system_ext/lib64]] at (frida/node_modules/frida-java-bridge/lib/env.js:124) at (frida/node_modules/frida-java-bridge/lib/class-factory.js:502) at value (frida/node_modules/frida-java-bridge/lib/class-factory.js:945) at value (frida/node_modules/frida-java-bridge/lib/class-factory.js:950) at _make (frida/node_modules/frida-java-bridge/lib/class-factory.js:165) at use (frida/node_modules/frida-java-bridge/lib/class-factory.js:62) at use (frida/node_modules/frida-java-bridge/index.js:258) at (/Users/crifan/dev/dev_root/androidReverse/keepAlive/360Wallpaper/dynamicDebug/Frida/frida/hook_360Wallpaper.js:139) at (frida/node_modules/frida-java-bridge/lib/vm.js:12) at _performPendingVmOps (frida/node_modules/frida-java-bridge/index.js:250) at (frida/node_modules/frida-java-bridge/index.js:242) at apply (native) at ne (frida/node_modules/frida-java-bridge/lib/class-factory.js:673) at (frida/node_modules/frida-java-bridge/lib/class-factory.js:651) åŸå›  æ­¤å¤„å®‰å“ç³»ç»Ÿçš„appï¼šè®¾ç½®ï¼ŒåŒ…åï¼šcom.android.settings å¥½åƒæ²¡åŒ…å«ï¼Œæ­¤å¤„è¾“å‡ºçš„Stopping packageçš„æ—¥å¿—çš„ä»£ç ï¼š ç±» com.android.server.pm.Settings çš„ å‡½æ•°createNewSetting å› ä¸ºæ˜¯å¦å¤–çš„äºŒè¿›åˆ¶ç¨‹åºsystem_serveræ‰åŒ…å«æ­¤å‡½æ•° è§£å†³åŠæ³• ç»è¿‡å®æµ‹ï¼Œæ¢system_serverå»hookï¼Œå³å¯æ‰¾åˆ°ã€‚ å…·ä½“æ­¥éª¤ frida -U -n system_server -l hook_360Wallpaper.js å³å¯æ‰¾åˆ°è¯¥ç±»ï¼Œæ­£å¸¸è¾“å‡ºï¼š SettingsCls= crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-07-31 17:56:15 "},"frida_base_tool/":{"url":"frida_base_tool/","title":"åŸºäºFridaçš„å·¥å…·","keywords":"","body":"åŸºäºFridaçš„å·¥å…· åŸºäºFridaçš„å·¥å…· è„±å£³/ç ¸å£³å·¥å…· frida-ios-dump https://github.com/AloneMonkey/frida-ios-dump pull decrypted ipa from jailbreak device frida-unpack https://github.com/dstmath/frida-unpack åŸºäºFridaçš„è„±å£³å·¥å…· è°ƒè¯•å·¥å…· frick https://github.com/iGio90/frick frick - aka the first debugger built on top of frida frickï¼šåŸºäºï¼ˆUnicornã€capstoneå’Œï¼‰fridaçš„è°ƒè¯•å·¥å…· frida-ios-hook https://github.com/noobpk/frida-ios-hook A tool that helps you easy trace classes, functions, and modify the return values of methods on iOS platform Fridump https://github.com/Nightbringer21/fridump A universal memory dumper using Frida for Android frida_dump https://github.com/lasting-yang/frida_dump frida dump dex, frida dump so frida-cycript https://github.com/nowsecure/frida-cycript Cycript fork powered by Frida r2frida https://github.com/nowsecure/r2frida Radare2 and Frida better together frida-trace https://github.com/nowsecure/frida-trace Trace APIs declaratively through Frida crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-24 21:31:58 "},"frida_use_case/":{"url":"frida_use_case/","title":"Fridaçš„ç”¨é€”","keywords":"","body":"Fridaçš„ç”¨é€” å¯ä»¥ç”¨Fridaå®ç°å„ç§é€†å‘çš„ç”¨é€”ã€‚ å…¶ä¸­ Frida Codeshare å°±æœ‰å¾ˆå¤šä¾‹å­ï¼Œæ„Ÿå…´è¶£çš„è‡ªå·±å»æŒ–æ˜æŒ–æ˜ã€‚ ä¸‹é¢æ•´ç†å‡ºéƒ¨åˆ†ç›¸å…³å†…å®¹ã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 23:00:31 "},"frida_use_case/anti_debug.html":{"url":"frida_use_case/anti_debug.html","title":"åè°ƒè¯•","keywords":"","body":"åè°ƒè¯• æ®è¯´ï¼Œå¯ä»¥ç”¨fridaè„šæœ¬ï¼ˆä¸´æ—¶ï¼‰å»è§„é¿æ‰åè°ƒè¯•çš„ptraceï¼š ä½¿ç”¨Fridaç»•è¿‡iOSåè°ƒè¯• | La0s ä¸€ä¾‹ç®€å•çš„fridaåè°ƒè¯•ç»•è¿‡ - ç½‘å®‰ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 22:28:26 "},"frida_use_case/anti_obfuscation.html":{"url":"frida_use_case/anti_obfuscation.html","title":"è¾…åŠ©åæ··æ·†","keywords":"","body":"è¾…åŠ©åæ··æ·† æ®è¯´å¯ä»¥å€ŸåŠ©äºFridaçš„Stalkerï¼Œè¿½è¸ªæç¤ºçœŸæ­£æŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹åï¼Œç„¶åï¼šç”¨äºè¾…åŠ©åæ··æ·†ã€‚ å…³äºStalkerçš„ä½¿ç”¨æ¡ˆä¾‹ï¼Œè¯¦è§ï¼šStalker crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 22:36:43 "},"frida_use_case/bypass_encrypted_para.html":{"url":"frida_use_case/bypass_encrypted_para.html","title":"ç»•è¿‡å‚æ•°åŠ å¯†","keywords":"","body":"ç»•è¿‡å‚æ•°åŠ å¯† é€šè¿‡fridaçš„hookå»å®ç°ç»•è¿‡å‚æ•°åŠ å¯† ç”¨fridaç»•è¿‡apkä¸­åŠ å¯†å‚æ•°ï¼Ÿ éƒ¨åˆ†å‚è€ƒèµ„æ–™ï¼š åˆ©ç”¨fridaå¿«é€Ÿè§£å†³APPä¸­æŸtongåŠ å¯† | å¤§ç†Šã®ç¬”è®° fridaè·‘åŠ å¯†ç®—æ³•å’Œç»•è¿‡æŠ“åŒ…éªŒè¯_ä¸æƒ³å†™ç¨‹åº(â•¥â•¯^â•°â•¥)çš„åšå®¢-CSDNåšå®¢ ã€ä¿å§†çº§æ•™å­¦ã€‘æŸé‡‘èapp FRIDA hookåŠ è§£å¯†ç®—æ³•+jsrpc=ä¹±æ€ - T00ls.Com æŸé‡‘èappçš„åŠ è§£å¯†hook+rpc+ç»•è¿‡SSLPinningæŠ“åŒ… - T00ls.Com crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 22:29:51 "},"frida_use_case/reverse_app/":{"url":"frida_use_case/reverse_app/","title":"é€†å‘app","keywords":"","body":"é€†å‘app æŠ–éŸ³ ä»appå¯åŠ¨æœ€å¼€å§‹å°±å¼€å§‹hookè°ƒè¯• äº¤äº’å¼è°ƒè¯•frida -U -f com.ss.iphone.ugc.Aweme ç”¨jsè„šæœ¬ è°ƒè¯•dyldfrida -U -f com.ss.iphone.ugc.Aweme -l frida/dyldImage.js å…¶ä»– ã€æœªè§£å†³ã€‘Macä¸­Fridaå¯åŠ¨æŠ–éŸ³appè¿›ç¨‹å¹¶è°ƒè¯•å’Œhookå‡½æ•° ã€æœªè§£å†³ã€‘ç”¨Fridaçš„frida-traceå»hookå‡½æ•°iOSç‰ˆæŠ–éŸ³ ã€æœªè§£å†³ã€‘fridaè°ƒè¯•æŠ–éŸ³appå»hookå‡½æ•°ï¼š_dyld_get_image_name ã€æœªè§£å†³ã€‘fridaå»hookå‡½æ•°_dyld_get_image_nameæ—¶æ‰“å°å‚æ•°ä¸ºå­—ç¬¦ä¸² ã€æœªè§£å†³ã€‘ç”¨FridaåŠ¨æ€è°ƒè¯•iOSç‰ˆæŠ–éŸ³app ã€æœªè§£å†³ã€‘Macä¸­ç”¨Fridaè°ƒè¯•iOSç‰ˆæŠ–éŸ³ ã€å·²è§£å†³ã€‘ç”¨fridaå¯åŠ¨hookè°ƒè¯•iOSæŠ–éŸ³app ã€æœªè§£å†³ã€‘å°è¯•Fridaçš„stalkerèƒ½å¦ä¿®å¤æŠ–éŸ³AwemeCoreä¸­å‡½æ•°åå¸¸é‡å­—ç¬¦ä¸² Appleè´¦å· ~= AppleStore Appleè´¦å· ~= AppleStore = Preferences + ï¼ˆAuthKitçš„daemonï¼‰akd + AppleAccount + AppleAccountUI + AppleMediaServices + libMobileGestalt + å…¶ä»– ã€è®°å½•ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨fridaå’Œfrida-traceå»hookæ‰“å°æ›´å¤šè´¦å·ç›¸å…³å‡½æ•°è°ƒç”¨ ã€æ— æ³•è§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨fridaçš„ssl bypyassè„šæœ¬å°è¯•è§£å†³CharlesæŠ“åŒ…ä»£ç†æŠ¥é”™ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨Fridaå»ç›‘æ§NSURLå»è°ƒè¯•Appleè´¦å·ç™»å½•è¿‡ç¨‹ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨Fridaå»è°ƒè¯•NSURLæ ¸å¿ƒç½‘ç»œè¯·æ±‚å‡½æ•°è°ƒç”¨ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šåˆ†æç ”ç©¶fridaæŠ“åŒ…åˆ°çš„Appleè´¦å·ç™»å½•è¿‡ç¨‹å’Œç½‘ç»œç›¸å…³çš„å†…å®¹ è¿…é›· è¿…é›· ã€è®°å½•ã€‘ç”¨fridaåŠ¨æ€è°ƒè¯•é‡æ–°æ‰“åŒ…åçš„å®‰å“è¿…é›·apk ã€æœªè§£å†³ã€‘Macä¸­æ­å»ºFridaçš„åŠ¨æ€è°ƒè¯•å®‰å“apkçš„å¼€å‘ç¯å¢ƒ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-27 22:38:29 "},"appendix/":{"url":"appendix/","title":"é™„å½•","keywords":"","body":"é™„å½• ä¸‹é¢åˆ—å‡ºç›¸å…³å‚è€ƒèµ„æ–™ã€‚ crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2023-06-22 22:04:13 "},"appendix/reference.html":{"url":"appendix/reference.html","title":"å‚è€ƒèµ„æ–™","keywords":"","body":"å‚è€ƒèµ„æ–™ ã€æ•´ç†ã€‘Fridaç›¸å…³èµ„æ–™ ã€å·²è§£å†³ã€‘frida-coreä»£ç å¯¹åº”ç€fridaä¸­æ˜¯å“ªä¸ªæ–‡ä»¶ ã€æœªè§£å†³ã€‘Macä¸­å®‰è£…frida ã€è®°å½•ã€‘iOSçš„iPhoneä¸­å®‰è£…Frida ã€è®°å½•ã€‘Sileoä¸­å®‰è£…tweakæ’ä»¶ï¼šFrida ã€å·²è§£å†³ã€‘Mac M2 Maxä¸­å®‰è£…Fridaç¯å¢ƒ ã€å·²è§£å†³ã€‘Macä¸­å‡çº§Fridaåˆ°æœ€æ–°ç‰ˆæœ¬16.0.11 ã€æœªè§£å†³ã€‘Macä¸­å®‰è£…frida ã€å·²è§£å†³ã€‘Macä¸­å‡çº§Fridaåˆ°æ–°ç‰ˆæœ¬16.0.10 ã€è®°å½•ã€‘palera1næ™®é€šè¶Šç‹±åå®‰è£…æ’ä»¶ï¼šFrida ã€è§„é¿è§£å†³ã€‘palera1nçš„rootlessè¶Šç‹±iPhoneä¸­åˆå§‹åŒ–fridaå¼€å‘ç¯å¢ƒ ã€è®°å½•ã€‘ä¸‹è½½Fridaçš„åŠ¨æ€åº“ï¼šFridaGadget.dylib ã€è®°å½•ã€‘iPhone8ä¸­çš„å‡çº§fridaåˆ°æœ€æ–°ç‰ˆ16.0.11 ã€è®°å½•ã€‘iOSçš„iPhoneä¸­å®‰è£…Frida ã€å·²è§£å†³ã€‘ç¡®è®¤palera1nçš„rootfulæ™®é€šè¶Šç‹±ä¸­Fridaæ˜¯å¦å¯ç”¨ ã€å·²è§£å†³ã€‘frida-ios-dumpç ¸å£³ipaæŠ¥é”™ï¼šneed Gadget to attach on jailed iOS ã€å·²è§£å†³ã€‘fridaå¯åŠ¨æ—¶åˆ°åº•æœ‰å“ªå‡ ç§attachå’Œspwanå¯åŠ¨æ–¹å¼ ã€æ•´ç†ã€‘å†æ¬¡ç ”ç©¶ç¡®è®¤Fridaè°ƒè¯•ç›®æ ‡çš„å‡ ç§æ–¹å¼ ã€å·²è§£å†³ã€‘iOSé€†å‘ï¼šFridaè°ƒè¯•è®¾ç½®å‡ºç°é¡µé¢å¼¹æ¡†ï¼šæ¥å…¥äº’è”ç½‘ä»¥ç™»å½•iPhone ã€æœªè§£å†³ã€‘XinaA15è¶Šç‹±çš„rootlessçš„iPhone11ä¸­fridaå‡ºé”™ï¼šå®‰è£…å’Œå¸è½½æ—¶çš„è·¯å¾„å¼‚å¸¸/var/jb/var/jb/ ã€è®°å½•ã€‘iPhone11é‡æ–°å®‰è£…XinaA15åé‡æ–°å®‰è£…Frida ã€å·²è§£å†³ã€‘XinaA15è¶Šç‹±çš„iPhone11ä¸­å®‰è£…Frida ã€è®°å½•ã€‘XinaA15æ¢å¤è¶Šç‹±ç¯å¢ƒåé‡æ–°å®‰è£…Frida ã€è®°å½•ã€‘iPhone8ä¸­ç”¨Sileoå®‰è£…Frida ã€è®°å½•ã€‘iPhone11ä¸­Sileoä¸­å®‰è£…æœ€æ–°ç‰ˆ16.0.11çš„Frida ã€è®°å½•ã€‘Sileoä¸­å®‰è£…tweakæ’ä»¶ï¼šFrida ã€è®°å½•ã€‘iPhone11ä¸­ç”¨Sileoé‡æ–°å®‰è£…æœ€æ–°ç‰ˆ16.0.10çš„Frida ã€å·²è§£å†³ã€‘iPhoneä¸­Cydiaä¸­å®‰è£…å‡çº§æœ€æ–°ç‰ˆçš„16.0.2çš„Frida ã€æœªè§£å†³ã€‘Fridaä»16.0.8åˆ°å‡çº§åˆ°æ–°ç‰ˆæœ¬16.0.10 ã€å·²è§£å†³ã€‘è¶Šç‹±åçš„iPhone11ä¸­å¸è½½å’Œé‡æ–°å®‰è£…Frida ã€å·²ç¡®è®¤ã€‘iPhone11ä¸­é‡æ–°ç¡®è®¤æ–°ç‰ˆXinaAå’Œæ–°ç‰ˆFridaæ˜¯å¦å¯ä»¥æ­£å¸¸ä½¿ç”¨ ã€å·²è§£å†³ã€‘Fridaå¯åŠ¨jsè„šæœ¬æŠ¥é”™ï¼šError could not parse line 1 expecting , ã€åŸºæœ¬è§£å†³ã€‘Fridaçš„Stalker.followä¸­eventsçš„å«ä¹‰å’Œç”¨æ³• ã€å·²è§£å†³ã€‘ä¼˜åŒ–Fridaè°ƒç”¨è„šæœ¬æ—¶æ— éœ€æ¯æ¬¡æŸ¥çœ‹PIDç›´æ¥ä¼ å…¥è¿›ç¨‹å ã€å·²è§£å†³ã€‘iOSé€†å‘ï¼šfridaè°ƒè¯•hookç±»NSXPCConnectionçš„setExportedObject ã€å·²è§£å†³ã€‘Fridaä¸­Stalkerå¦‚ä½•åœ¨Stalker.followä¸­å†™ä»£ç è¿½è¸ªæŒ‡ä»¤ä»£ç è¿è¡Œ ã€å·²è§£å†³ã€‘ç”¨fridaå»hookæ‰“å°ä¸€ä¸ªç±»çš„æ‰€æœ‰çš„æ–¹æ³• ã€å·²è§£å†³ã€‘fridaå»hookå‡½æ•°æ—¶ç¡®ä¿å·²æ‰§è¡Œå‡½æ•°ä½†ä¸è§¦å‘ä¸è¾“å‡ºæ—¥å¿—log ã€å·²è§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨fridaæ‰“å°com.apple.ak.auth.xpcçš„NSXPCConnectionçš„å…¶ä»–å±æ€§å€¼ ã€è®°å½•ã€‘iOSé€†å‘akdï¼šfrida-traceè¿½è¸ªå‡ºiPhone8ä¸­iOS15.0ä¸­è´¦å·éªŒè¯çš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹ç»“æœ ã€å·²è§£å†³ã€‘Macä¸­å¦‚ä½•ä½¿ç”¨fridaçš„Stalkerçš„jsè„šæœ¬ ã€å·²è§£å†³ã€‘Fridaè°ƒè¯•æ—¶å¦‚ä½•æŒ‡å®šè¿›ç¨‹ ã€å·²è§£å†³ã€‘Fridaä¸­å¦‚ä½•é€šè¿‡fridaå¯åŠ¨è¢«æµ‹appç¨‹åºiOSç‰ˆæŠ–éŸ³ ã€å·²è§£å†³ã€‘ç”¨fridaå»hookæŠ¥é”™ï¼šFailed to spawn unable to find process with name ã€å·²è§£å†³ã€‘fridaè°ƒè¯•è¿›ç¨‹ç›´æ¥è¿è¡Œä¸è¦æ¯æ¬¡éƒ½è¾“å…¥%resumeæ‰è¿è¡Œ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨fridaå»hookæ‰“å°æ‰€æœ‰iOSçš„ObjCå‡½æ•°è°ƒç”¨ ã€å·²è§£å†³ã€‘Fridaä¸­jsä»£ç ä¸­ä¸¤ä¸ªåœ°å€æŒ‡é’ˆæ•°å€¼ç›¸åŠ  ã€å·²è§£å†³ã€‘fridaä¸­ptrçš„å«ä¹‰ ã€å·²è§£å†³ã€‘jsä¸­æŠŠObjCå‡½æ•°è°ƒç”¨å†™æ³•è½¬æ¢æˆFridaä¸­ObjCå‡½æ•°è°ƒç”¨å†™æ³• ã€å·²è§£å†³ã€‘fridaæ‰“å°iOSçš„ObjCå‡½æ•°çš„å‚æ•°çš„å€¼ ã€å·²è§£å†³ã€‘fridaåŠ¨æ€åˆ¤æ–­iOSçš„ObjCå‡½æ•°çš„å‚æ•°ä¸ªæ•°å¹¶æ‰“å°å‚æ•°å€¼ ã€å·²è§£å†³ã€‘fridaå»hookå•ä¸ªç±»çš„å•ä¸ªå‡½æ•° ã€å·²è§£å†³ã€‘ç”¨fridaå»hookæ‰“å°ä¸€ä¸ªç±»çš„æ‰€æœ‰çš„æ–¹æ³• ã€å·²è§£å†³ã€‘fridaå»hookç›‘æ§ObjCå‡½æ•°æ—¶æŠŠç±»åå’Œå‡½æ•°åæ•´åˆæˆObjcçš„è¯­æ³• ã€å·²è§£å†³ã€‘Fridaä¸­hookæ‰“å°iOSä¸­çš„ç±»å’Œå‡½æ•° ã€å·²è§£å†³ã€‘iOSé€†å‘ï¼šFridaçš„hookä¸­onLeaveä¸­å¦‚ä½•è·å–åˆ°selfç±»æœ¬èº«çš„å®ä¾‹å˜é‡ ã€å·²è§£å†³ã€‘fridaä¸­ObjC.Objectçš„è¯­æ³•å’Œå«ä¹‰ ã€æœªè§£å†³ã€‘fridaä¸­æ‰“å°ObjCå‚æ•°ç±»å‹NSPathStore2çš„å€¼ ã€å·²è§£å†³ã€‘fridaçš„hookä¸­å¦‚ä½•æŠŠNSStringè½¬æ¢ä¸ºCçš„stringå¹¶æ‰“å° ã€æœªè§£å†³ã€‘fridaå»hookæ—¶åˆ¤æ–­å‡½æ•°å‚æ•°çš„ç±»å‹æ˜¯å¦æ˜¯NSString ã€å·²è§£å†³ã€‘fridaä¸­æ‰“å°æ“ä½œObjcçš„å‚æ•°SELå¯¼è‡´ç¨‹åºå´©æºƒ ã€å·²è§£å†³ã€‘Macä¸­Fridaå»hookå‡½æ•°ï¼šç”¨fridaè¿˜æ˜¯frida-trace ã€æœªè§£å†³ã€‘Macä¸­frida-traceæŠ¥é”™ï¼šFailed to spawn unable to find process with name ã€å·²è§£å†³ã€‘iOSé€†å‘akdï¼šç”¨frida-traceè¿½è¸ªè´¦å·éªŒè¯çš„è¿‡ç¨‹ ã€å·²è§£å†³ã€‘frida-traceä¸­æŠŠæ›´å¤šå‚æ•°æ”¾åˆ°å‚æ•°æ–‡ä»¶ä¸­ ã€å·²è§£å†³ã€‘frida-traceå»hookå¯¼è‡´appå´©æºƒæœ€åè¾“å‡ºProcess terminated ã€å·²è§£å†³ã€‘frida-traceè¾“å‡ºlogæ—¥å¿—åˆ°æ–‡ä»¶ä¸­ ã€è®°å½•ã€‘iOSé€†å‘Appleè´¦å·ï¼šåˆ†æfrida-traceå»hookåˆ°çš„ä¸‹ä¸€æ­¥æŒ‰é’®å†…éƒ¨çš„å‡½æ•°è°ƒç”¨é€»è¾‘ ã€è®°å½•ã€‘iOSé€†å‘akdï¼šfrida-traceè¿½è¸ªå‡ºiPhone8ä¸­iOS15.0ä¸­è´¦å·éªŒè¯çš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹ç»“æœ ã€è®°å½•ã€‘iOSé€†å‘Appleè´¦å·ï¼šfrida-traceå»hooké€»è¾‘åŠ ä¸ŠNSStringå’ŒNSErrorç­‰é€šç”¨çš„ç±» ã€å·²è§£å†³ã€‘iOSé€†å‘è°ƒè¯•ï¼šç”¨Frida-traceå®æ—¶è¿½è¸ªç›¸å…³ObjCå‡½æ•°è°ƒç”¨ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨frida-traceå»hookç›‘æ§NSURLç½‘ç»œè¯·æ±‚ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨Fridaå»hookç½‘ç»œè¯·æ±‚NSURLç›¸å…³å‡½æ•°è°ƒç”¨ ã€è®°å½•ã€‘iOSé€†å‘Appleè´¦å·ï¼šfrida-traceè¿½è¸ªå¤šä¸ªObjCå‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ ã€è®°å½•ã€‘iOSé€†å‘Appleè´¦å·ï¼šä¼˜åŒ–frida-traceçš„å‡½æ•°hookèŒƒå›´ä»¥å®šä½è´¦å·ç™»å½•è¿‡ç¨‹æ ¸å¿ƒé€»è¾‘ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨frida-traceè°ƒè¯•signin/v2/loginçš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹ ã€è®°å½•ã€‘frida-traceè°ƒè¯•è¿½è¸ªåˆ°çš„è¾“å…¥å¯†ç ä¸‹ä¸€æ­¥çš„è´¦å·ç™»å½•è¿‡ç¨‹ä¸­çš„ObjCå‡½æ•°è°ƒç”¨è¿‡ç¨‹ ã€è®°å½•ã€‘Macä¸­æµ‹è¯•Fridaå„ä¸ªå‘½ä»¤çš„æ•ˆæœ ã€å·²è§£å†³ã€‘Macä¸­fridaæŠ¥é”™ï¼šValueError file descriptor cannot be a negative integer -42 ã€è®°å½•ã€‘fridaçš„frida-psç”¨æ³• ã€æ•´ç†ã€‘fridaå¿ƒå¾—ï¼šfrida-psç”¨æ³•è¯¦è§£ ã€æœªè§£å†³ã€‘iPhone11ä¸­å¦‚ä½•åœæ­¢frida-server ã€æœªè§£å†³ã€‘iPhoneä¸­ç”¨launchctlå»å¯åŠ¨å’Œåœæ­¢frida-serveræœåŠ¡è¿›ç¨‹ ã€æœªè§£å†³ã€‘fridaå¯¼è‡´iPhoneé‡å¯ï¼šåˆ†æpanic-fullçš„ipsæ˜¯å¦å’Œfrida-serverå´©æºƒæœ‰å…³ç³» ã€åŸºæœ¬è§£å†³ã€‘iOS 15.1çš„iPhone11ä¸­frida-serveræ‰€ç”¨æ¶æ„æ˜¯arm64eè¿˜æ˜¯arm64 ã€æœªè§£å†³ã€‘Fridaçš„stalker trace ã€åŸºæœ¬è§£å†³ã€‘Fridaçš„Stalker.followä¸­eventsçš„å«ä¹‰å’Œç”¨æ³• ã€å·²è§£å†³ã€‘Fridaå»hookå‡½æ•°æŠ¥é”™ï¼šError unable to intercept function at please file a bug ã€æ— æ³•è§£å†³ã€‘Fridaçš„Stalkerä¸­transformä¸­çš„instructionæ˜¯å¦å¯ä»¥è·å–åˆ°byteså³opcode ã€å·²è§£å†³ã€‘ä¼˜åŒ–Fridaçš„Stalkerçš„ä»£ç è¿½è¸ªé€»è¾‘ ã€å·²è§£å†³ã€‘Fridaçš„Stalkerä¸­å‡½æ•°åœ°å€å’ŒæŒ‡ä»¤åœ°å€åŒ¹é…ä¸ä¸Š ã€å·²è§£å†³ã€‘ææ‡‚Fridaçš„Stalker.followçš„transformçš„è°ƒè¯•æŒ‡ä»¤è¿è¡Œçš„é€»è¾‘ ã€å·²è§£å†³ã€‘Fridaçš„Stalker.followä¸­transformä¸­çš„æŒ‡ä»¤instruction ã€è®°å½•ã€‘åˆ†æFridaçš„Stalkerå¯¹äº___lldb_unnamed_symbol2575ä»£ç è¿½è¸ªçš„è¾“å‡ºç»“æœ ã€è®°å½•ã€‘å­¦ä¹ Fridaå®˜ç½‘æ–‡æ¡£Stalkerææ‡‚åŸºæœ¬ç”¨æ³•å’Œé€»è¾‘ ã€å·²è§£å†³ã€‘Fridaçš„Stalkerä¸­å»åˆ¤æ–­æ˜¯å¦æ˜¯å‡½æ•°çš„ä»£ç æŒ‡ä»¤çš„é€»è¾‘ ã€æ•´ç†ã€‘Fridaä¸­å¯¹äºjsä»£ç çš„æ”¯æŒä¸å¤Ÿå®Œç¾ ã€è§„é¿è§£å†³ã€‘fridaä¸­console.logæ‰“å°æ—¶å‚æ•°æ ¼å¼åŒ–æ— æ•ˆ ã€æœªè§£å†³ã€‘Fridaä¸­jsçš„console.logæ—¥å¿—æ‰“å°æ ¼å¼åŒ–å‚æ•° ã€å·²è§£å†³ã€‘fridaçš„è„šæœ¬ä¸­console.logæ‰“å°argsæŠ¥é”™ï¼šRangeError invalid array index ã€å·²è§£å†³ã€‘ç»™Fridaçš„Stalkerä¸­è¾“å‡ºlogæ—¥å¿—åˆ°æ–‡ä»¶ ã€å·²è§£å†³ã€‘Fridaçš„Stalkerä¸­ä¼˜åŒ–hookåˆ°æŒ‡ä»¤æ—¶çš„logæ—¥å¿—è¾“å‡º ã€å·²è§£å†³ã€‘jsä¸­console.logå¦‚ä½•æ‰“å°å¯¹è±¡[object Object] ã€å·²è§£å†³ã€‘Fridaå¯åŠ¨jsè„šæœ¬æŠ¥é”™ï¼šError could not parse line 1 expecting , ã€å·²è§£å†³ã€‘Fridaçš„Stalkerä¸­è°ƒè¯•æŠ¥é”™ï¼šFatal Python error _enter_buffered_busy: could not acquire lock ã€æœªè§£å†³ã€‘fridaæŠ¥é”™ï¼šFailed to spawn: the connection is closed ã€å·²è§£å†³ã€‘fridaå¯åŠ¨æŠ–éŸ³appæŠ¥é”™ï¼šFailed to attach need Gadget to attach on jailed iOS ã€å·²è§£å†³ã€‘fridaè¿è¡ŒæŠ¥é”™ï¼šWaiting for USB device to appear ã€æœªè§£å†³ã€‘Macä¸­ç”¨Fridaä½†æŠ¥é”™Failed to enumerate processes the connection is closedä¸”å¯¼è‡´iPhoneé‡å¯ ã€æœªè§£å†³ã€‘frida-serverè¿è¡ŒæŠ¥é”™ï¼šFailed to spawn this feature requires an iOS Developer Disk Image to be mounted ã€å·²è§£å†³ã€‘fridaå»hookå‡½æ•°æŠ¥é”™ï¼šTypeError cannot read property implementation of undefined ã€æœªè§£å†³ã€‘fridaä¸­hookå‡½æ•°æ‰“å°å‚æ•°å€¼æ—¶æœ€åappå´©æºƒfridaè¾“å‡ºProcess terminated ã€æœªè§£å†³ã€‘fridaå»hookç›‘æ§iOSçš„ObjCå‡½æ•°æ—¶ç»å¸¸ä¼šå´©æºƒProcess terminated ã€æœªè§£å†³ã€‘ç ”ç©¶fridaå´©æºƒProcess terminatedï¼šé€šè¿‡Preferencesçš„å´©æºƒæ—¥å¿—æ‰¾åŸå›  ã€è®°å½•ã€‘Fridaè°ƒè¯•å¯¼è‡´iPhone8é‡å¯è€Œä¸¢å¤±palera1nè¶Šç‹± ã€æœªè§£å†³ã€‘Macä¸­FridaæŠ¥é”™ä¸”å¯¼è‡´iPhoneé‡å¯ï¼šé‡æ–°ä¿®å¤XinaA15è¶Šç‹±ç¯å¢ƒ ã€æœªè§£å†³ã€‘fridaå¯¼è‡´iPhoneé‡å¯ï¼šä»å´©æºƒæ—¥å¿—ipsæ–‡ä»¶åˆ†æå»æ‰¾å¯èƒ½åŸå›  ã€æœªè§£å†³ã€‘Macä¸­ç”¨Fridaä½†æŠ¥é”™Failed to enumerate processes the connection is closedä¸”å¯¼è‡´iPhoneé‡å¯ ã€æœªè§£å†³ã€‘Fridaè°ƒè¯•Apple StoreæŠ¥é”™ï¼šFailed to attach missing gProcessInfo ã€å·²è§£å†³ã€‘frida-ios-dumpç»™iOS 15.1çš„iPhoneä¸­appç ¸å£³æŠ¥é”™ï¼šmissing gProcessInfo ã€å·²è§£å†³ã€‘ç ”ç©¶fridaä¸­æ˜¯å¦å­˜åœ¨å¯¼å…¥å¤–éƒ¨å˜é‡gProcessInfo ã€æœªè§£å†³ã€‘ç ”ç©¶Fridaä¸­Missing gProcessInfoå‡ºé”™çš„é€»è¾‘å’ŒåŸå›  ã€å·²è§£å†³ã€‘ç ”ç©¶äºŒè¿›åˆ¶/usr/lib/dyldä¸­æ˜¯å¦åŒ…å«æˆ–å¯¼å‡ºå˜é‡_gProcessInfo ã€è®°å½•ã€‘dyldæºç ä¸­çš„gProcessInfo ã€å·²è§£å†³ã€‘Fridaæºç ä¸­æ‰¾åˆ°äº†ï¼šgProcessInfo ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»Fridaæºç å’Œbuildä¸­æ‰¾ ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»Fridaçš„githubä¸­æ‰¾ ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šè‡ªå·±ç»™makeåŠ echoæ‰“å°æ—¥å¿—è°ƒè¯• ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»githubçš„ciçš„workflowä¸­æ‰¾arm64e ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»ç¼–è¯‘æ—¥å¿—ä¸­çš„Downloading ios-arm64å…¥æ‰‹ ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šmakeæ—¶å¦‚ä½•ä¼ å…¥arm64eçš„archå‚æ•° ã€æœªè§£å†³ã€‘æ‰¾Fridaä¸­iOSçš„arm6e4ï¼šä»makeç¼–è¯‘æ—¶çš„logæ—¥å¿—å…¥æ‰‹ ã€åŸºæœ¬è§£å†³ã€‘iOS 15.1çš„iPhone11ä¸­frida-serveræ‰€ç”¨æ¶æ„æ˜¯arm64eè¿˜æ˜¯arm64 ã€æœªè§£å†³ã€‘è‡ªå·±ç¼–è¯‘å‡ºçš„arm64çš„frida-serverèƒ½å¦åœ¨iPhone11æ­£å¸¸è¿è¡Œ ã€æœªè§£å†³ã€‘ç”¨fridaæºç è‡ªå·±ç¼–è¯‘å‡ºfridaçš„iOSçš„åŒ…å«frida-serverçš„debå®‰è£…åŒ… ã€æœªè§£å†³ã€‘è‡ªå·±ç¼–è¯‘å‡ºåŒ…å«arm64å’Œarm64eçš„FATæ ¼å¼çš„frida-serveräºŒè¿›åˆ¶ ã€æœªè§£å†³ã€‘è‡ªå·±ä¿®æ”¹ç¼–è¯‘frida-coreæºç ä»¥å°è¯•è§£å†³Fridaçš„Missing gProcessInfoé—®é¢˜ ã€æœªè§£å†³ã€‘Fridaä¸­å¦‚ä½•ç¼–è¯‘å‡ºiOSçš„arm64eçš„frida-serveräºŒè¿›åˆ¶ ã€æœªè§£å†³ã€‘è‡ªå·±ç¼–è¯‘Fridaçš„frida-coreä»£ç ç”Ÿæˆå¯ç”¨äºŒè¿›åˆ¶frida-server ã€å·²è§£å†³ã€‘iOSé€†å‘ï¼šå¦‚ä½•å†™Fridaçš„Stalkerä»£ç å»ç›‘æ§å‡½æ•°___lldb_unnamed_symbol2575$$akdçš„æŒ‡ä»¤è¿è¡Œ ã€æœªè§£å†³ã€‘iOSé€†å‘ï¼šå¦‚ä½•åä»£ç æ··æ·†åæ··æ·†å»æ··æ·† ã€æœªè§£å†³ã€‘Macä¸­Fridaå¯åŠ¨æŠ–éŸ³appè¿›ç¨‹å¹¶è°ƒè¯•å’Œhookå‡½æ•° ã€æœªè§£å†³ã€‘ç”¨Fridaçš„frida-traceå»hookå‡½æ•°iOSç‰ˆæŠ–éŸ³ ã€æœªè§£å†³ã€‘fridaè°ƒè¯•æŠ–éŸ³appå»hookå‡½æ•°ï¼š_dyld_get_image_name ã€æœªè§£å†³ã€‘fridaå»hookå‡½æ•°_dyld_get_image_nameæ—¶æ‰“å°å‚æ•°ä¸ºå­—ç¬¦ä¸² ã€æœªè§£å†³ã€‘ç”¨FridaåŠ¨æ€è°ƒè¯•iOSç‰ˆæŠ–éŸ³app ã€æœªè§£å†³ã€‘Macä¸­ç”¨Fridaè°ƒè¯•iOSç‰ˆæŠ–éŸ³ ã€å·²è§£å†³ã€‘ç”¨fridaå¯åŠ¨hookè°ƒè¯•iOSæŠ–éŸ³app ã€æœªè§£å†³ã€‘å°è¯•Fridaçš„stalkerèƒ½å¦ä¿®å¤æŠ–éŸ³AwemeCoreä¸­å‡½æ•°åå¸¸é‡å­—ç¬¦ä¸² ã€è®°å½•ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨fridaå’Œfrida-traceå»hookæ‰“å°æ›´å¤šè´¦å·ç›¸å…³å‡½æ•°è°ƒç”¨ ã€æ— æ³•è§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨fridaçš„ssl bypyassè„šæœ¬å°è¯•è§£å†³CharlesæŠ“åŒ…ä»£ç†æŠ¥é”™ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨Fridaå»ç›‘æ§NSURLå»è°ƒè¯•Appleè´¦å·ç™»å½•è¿‡ç¨‹ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šç”¨Fridaå»è°ƒè¯•NSURLæ ¸å¿ƒç½‘ç»œè¯·æ±‚å‡½æ•°è°ƒç”¨ ã€æœªè§£å†³ã€‘iOSé€†å‘Appleè´¦å·ï¼šåˆ†æç ”ç©¶fridaæŠ“åŒ…åˆ°çš„Appleè´¦å·ç™»å½•è¿‡ç¨‹å’Œç½‘ç»œç›¸å…³çš„å†…å®¹ ã€è®°å½•ã€‘ç”¨fridaåŠ¨æ€è°ƒè¯•é‡æ–°æ‰“åŒ…åçš„å®‰å“è¿…é›·apk ã€æœªè§£å†³ã€‘Macä¸­æ­å»ºFridaçš„åŠ¨æ€è°ƒè¯•å®‰å“apkçš„å¼€å‘ç¯å¢ƒ ã€å·²è§£å†³ã€‘iPhoneå’ŒMacä¸­å‡çº§Fridaåˆ°æœ€æ–°ç‰ˆ16.1.1 ã€å·²è§£å†³ã€‘iOSé€†å‘WhatsAppï¼šFridaçš„jsçš„å‡½æ•°å †æ ˆæ‰“å°ä¼˜åŒ–ï¼šç»™ä¸ªåˆ«ç‰¹å®šå‡½æ•°åŠ åˆ°æ’é™¤åˆ—è¡¨ ã€å·²è§£å†³ã€‘iOSé€†å‘WhatsAppï¼šç”¨Fridaçš„å¸¦å‡½æ•°å †æ ˆè°ƒç”¨çš„jså»hookæ³¨å†Œè¿‡ç¨‹ ã€å·²è§£å†³ã€‘jsä¸­åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åœ¨åˆ—è¡¨ä¸­ ã€å·²è§£å†³ã€‘Fridaä¸­jsæ‰“å°æ—¥å¿—logä¼˜åŒ–ï¼šè‡ªåŠ¨ç”Ÿæˆä¸­é—´å­—ç¬¦ä¸²åŠ ä¸Šå·¦å³å¯¹ç§°çš„å•è¡Œlogæ—¥å¿— ã€å·²è§£å†³ã€‘Fridaæ‰“å°iOSå‡½æ•°è°ƒç”¨å †æ ˆï¼šä¼˜åŒ–åŒä¸€å‡½æ•°åªè¾“å‡ºä¸€æ¬¡ ã€å·²è§£å†³ã€‘iOSé€†å‘WhatsAppï¼šåŠ äº†ä»£ç†åFridaå»hookå´å§‹ç»ˆå´©æºƒ ã€å·²è§£å†³ã€‘Fridaå»hookæŠ–éŸ³æŠ¥é”™ï¼šError java.lang.ClassNotFoundException Didn't find class on path DexPathList zip file ã€å·²è§£å†³ã€‘Fridaå»hookå®‰å“ç±»æ‰¾ä¸åˆ°ï¼šError java.lang.ClassNotFoundException Didn't find class com.android.server.pm.Settings åˆå§‹åŒ–Fridaå¼€å‘ç¯å¢ƒ Â· Androidé€†å‘ï¼šåŠ¨æ€è°ƒè¯• (crifan.org) frida-ios-dump Â· iOSé€†å‘å¼€å‘ï¼šç ¸å£³ipa (crifan.org) æŸé‡‘èappçš„åŠ è§£å¯†hook+rpc+ç»•è¿‡SSLPinningæŠ“åŒ… - T00ls.Com ã€ä¿å§†çº§æ•™å­¦ã€‘æŸé‡‘èapp FRIDA hookåŠ è§£å¯†ç®—æ³•+jsrpc=ä¹±æ€ - T00ls.Com åˆ©ç”¨fridaå¿«é€Ÿè§£å†³APPä¸­æŸtongåŠ å¯† | å¤§ç†Šã®ç¬”è®° fridaè·‘åŠ å¯†ç®—æ³•å’Œç»•è¿‡æŠ“åŒ…éªŒè¯_ä¸æƒ³å†™ç¨‹åº(â•¥â•¯^â•°â•¥)çš„åšå®¢-CSDNåšå®¢ ä½¿ç”¨Fridaç»•è¿‡iOSåè°ƒè¯• | La0s ä¸€ä¾‹ç®€å•çš„fridaåè°ƒè¯•ç»•è¿‡ - ç½‘å®‰ ã€iOSé€†å‘ã€‘æŸè¥ä¸šå…ç®—æ³•åˆ†æ_å°é™ˆ_InfoQå†™ä½œç¤¾åŒº [åŸåˆ›] sktraceï¼šåŸºäº Frida Stalker çš„ trace å·¥å…·-Androidå®‰å…¨-çœ‹é›ª-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|kanxue.com oleavr (Ole AndrÃ© Vadla RavnÃ¥s) Frida 12.3 Debuts New Crash Reporting Feature - NowSecure ã€iOSé€†å‘ä¸å®‰å…¨ã€‘frida-traceå…¥é—¨ - ç§»åŠ¨ç«¯å°é™ˆ - åšå®¢å›­ Frida HandBook regex - How do you access the matched groups in a JavaScript regular expression? - Stack Overflow NativePointer - JavaScript API frida-ios-hook/hook-all-methods-of-specific-class.js at master Â· noobpk/frida-ios-hook Â· GitHub mikeash.com: objc_msgSend's New Prototype Frida basics - Frida HandBook iOS security overview & reverse engineering tools / Habr objc_msgSend | Apple Developer Documentation Frida CodeShare Project: iOS Utils Frida CodeShare BROWSE CODE Project: iOS SSL Bypass personal_script/Frida_script at master Â· lich4/personal_script Â· GitHub Fridaåœ¨iOSå¹³å°è¿›è¡ŒOCå‡½æ•°hookçš„å¸¸ç”¨æ–¹æ³• | 8Biiit's Blog frida-ios-hook/frida-scripts 0xdea/frida-scripts Beginning Frida: by example. Frida, https://frida.re/, is one ofâ€¦ | by RomÃ¡n RamÃ­rez | Medium Hacking | Frida â€¢ A world-class dynamic instrumentation toolkit Frida 1.6.3 Released | Frida â€¢ A world-class dynamic instrumentation toolkit Frida 1.6.2 Released | Frida â€¢ A world-class dynamic instrumentation toolkit frida/frida: Clone this repo to build Frida frida-core frida-gum frida-tools frida-python frida-node frida-swift frida-clr frida-go frida-rust frida-qml frida-objc-bridge frida-java-bridge Capstone Frida Docs Quick-start guide Installation Modes of Operation Gadget Hacking Stalker Presentations Functions Messages iOS Android Windows macOS Linux iOS Android JavaScript Frida CLI frida-ps frida-trace frida-discover frida-ls-devices frida-kill gum-graft JavaScript API C API Swift API Go API Best Practices Troubleshooting Building Footprint GSoC Ideas 2015 GSoD Ideas 2023 History frida-presentations ã€Frida å®æˆ˜ã€‘APIæŸ¥æ‰¾å™¨å’Œæ‹¦æˆªå™¨çš„ç»„åˆä½¿ç”¨ â€“ exchen's blog Stalkerçš„API DefinitelyTyped/index.d.ts Tampering and Reverse Engineering on iOS - OWASP MASTG (gitbook.io) Cesar Rodriguez | Personal blog (cmrodriguez.me) Dalvik å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ | Android Open Source Project runtime/native/dalvik_system_DexFile.cc - platform/art - Git at Google (googlesource.com) crifan.orgï¼Œä½¿ç”¨ç½²å4.0å›½é™…(CC BY 4.0)åè®®å‘å¸ƒ all right reservedï¼Œpowered by Gitbookæœ€åæ›´æ–°ï¼š 2024-11-22 16:34:36 "}}