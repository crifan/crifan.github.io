
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <title>Segment · 可执行文件格式：Mach-O</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.7">
        <meta name="author" content="Crifan Li <admin@crifan.com>">
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-expandable-menu/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-prism/prism-atom-dark.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-splitter-nosessionbutcookie/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-callouts/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="__text/" />
    
    
    <link rel="prev" href="../load_commands/lc_dyld_exports_trie.html" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"repo":"exec_file_format_macho","user":"crifan","type":"star","count":true,"size":"small"},{"user":"crifan","type":"follow","width":"120","count":false,"size":"small"}]};
    </script>

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://www.crifan.org" target="_blank" class="custom-link">主页</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                        <b>1.1.</b>
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../../macho_overview/">
            
                <a href="../../../macho_overview/">
            
                    
                        <b>1.2.</b>
                    
                    Mach-O概览
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../../macho_overview/background/">
            
                <a href="../../../macho_overview/background/">
            
                    
                        <b>1.2.1.</b>
                    
                    背景知识
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../../../macho_overview/background/xnu.html">
            
                <a href="../../../macho_overview/background/xnu.html">
            
                    
                        <b>1.2.1.1.</b>
                    
                    XNU
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="../../../macho_overview/background/compile_link_load.html">
            
                <a href="../../../macho_overview/background/compile_link_load.html">
            
                    
                        <b>1.2.1.2.</b>
                    
                    编译链接加载过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="../../../macho_overview/background/pic.html">
            
                <a href="../../../macho_overview/background/pic.html">
            
                    
                        <b>1.2.1.3.</b>
                    
                    PIC
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../">
            
                <a href="../../">
            
                    
                        <b>1.3.</b>
                    
                    Mach-O格式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../summary/">
            
                <a href="../../summary/">
            
                    
                        <b>1.3.1.</b>
                    
                    Mach-O结构概述
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../summary/macho_layout.html">
            
                <a href="../../summary/macho_layout.html">
            
                    
                        <b>1.3.1.1.</b>
                    
                    Mach-O结构图
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.3.2.</b>
                    
                    Mach-O结构详情
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../header/">
            
                <a href="../header/">
            
                    
                        <b>1.3.2.1.</b>
                    
                    Header
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.1" data-path="../header/magic.html">
            
                <a href="../header/magic.html">
            
                    
                        <b>1.3.2.1.1.</b>
                    
                    magic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.1.2" data-path="../header/cputype_cpusubtype.html">
            
                <a href="../header/cputype_cpusubtype.html">
            
                    
                        <b>1.3.2.1.2.</b>
                    
                    cputype和cpusubtype
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.1.3" data-path="../header/filetype.html">
            
                <a href="../header/filetype.html">
            
                    
                        <b>1.3.2.1.3.</b>
                    
                    filetype
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.1.4" data-path="../header/flags.html">
            
                <a href="../header/flags.html">
            
                    
                        <b>1.3.2.1.4.</b>
                    
                    flags
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../load_commands/">
            
                <a href="../load_commands/">
            
                    
                        <b>1.3.2.2.</b>
                    
                    Load Commands
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.1" data-path="../load_commands/lc_uuid.html">
            
                <a href="../load_commands/lc_uuid.html">
            
                    
                        <b>1.3.2.2.1.</b>
                    
                    LC_UUID
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2" data-path="../load_commands/lc_segment.html">
            
                <a href="../load_commands/lc_segment.html">
            
                    
                        <b>1.3.2.2.2.</b>
                    
                    LC_SEGMENT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.3" data-path="../load_commands/lc_segment_64.html">
            
                <a href="../load_commands/lc_segment_64.html">
            
                    
                        <b>1.3.2.2.3.</b>
                    
                    LC_SEGMENT_64
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.4" data-path="../load_commands/lc_symtab.html">
            
                <a href="../load_commands/lc_symtab.html">
            
                    
                        <b>1.3.2.2.4.</b>
                    
                    LC_SYMTAB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.5" data-path="../load_commands/lc_dyld_chained_fixups.html">
            
                <a href="../load_commands/lc_dyld_chained_fixups.html">
            
                    
                        <b>1.3.2.2.5.</b>
                    
                    LC_DYLD_CHAINED_FIXUPS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.6" data-path="../load_commands/lc_dyld_exports_trie.html">
            
                <a href="../load_commands/lc_dyld_exports_trie.html">
            
                    
                        <b>1.3.2.2.6.</b>
                    
                    LC_DYLD_EXPORTS_TRIE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3.2.3" data-path="./">
            
                <a href="./">
            
                    
                        <b>1.3.2.3.</b>
                    
                    Segment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.1" data-path="__text/">
            
                <a href="__text/">
            
                    
                        <b>1.3.2.3.1.</b>
                    
                    __TEXT
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.1.1" data-path="__text/__text.html">
            
                <a href="__text/__text.html">
            
                    
                        <b>1.3.2.3.1.1.</b>
                    
                    __text
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.3.2" data-path="__data/">
            
                <a href="__data/">
            
                    
                        <b>1.3.2.3.2.</b>
                    
                    __DATA
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.2.1" data-path="__data/__la_symbol_ptr.html">
            
                <a href="__data/__la_symbol_ptr.html">
            
                    
                        <b>1.3.2.3.2.1.</b>
                    
                    __la_symbol_ptr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3.2.2" data-path="__data/__got.html">
            
                <a href="__data/__got.html">
            
                    
                        <b>1.3.2.3.2.2.</b>
                    
                    __got
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.3.3" data-path="__import.html">
            
                <a href="__import.html">
            
                    
                        <b>1.3.2.3.3.</b>
                    
                    __IMPORT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3.4" data-path="__linkedit.html">
            
                <a href="__linkedit.html">
            
                    
                        <b>1.3.2.3.4.</b>
                    
                    __LINKEDIT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3.5" data-path="__objc.html">
            
                <a href="__objc.html">
            
                    
                        <b>1.3.2.3.5.</b>
                    
                    __OBJC
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../section/">
            
                <a href="../section/">
            
                    
                        <b>1.3.2.4.</b>
                    
                    Section
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.4.1" data-path="../section/symbol.html">
            
                <a href="../section/symbol.html">
            
                    
                        <b>1.3.2.4.1.</b>
                    
                    symbol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4.2" data-path="../section/string.html">
            
                <a href="../section/string.html">
            
                    
                        <b>1.3.2.4.2.</b>
                    
                    string
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../fat/">
            
                <a href="../../fat/">
            
                    
                        <b>1.3.3.</b>
                    
                    FAT
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../../fat/examples.html">
            
                <a href="../../fat/examples.html">
            
                    
                        <b>1.3.3.1.</b>
                    
                    举例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../../fat/issues.html">
            
                <a href="../../fat/issues.html">
            
                    
                        <b>1.3.3.2.</b>
                    
                    常见问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="../../fat/tools/">
            
                <a href="../../fat/tools/">
            
                    
                        <b>1.3.3.3.</b>
                    
                    工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.3.1" data-path="../../fat/tools/lipo.html">
            
                <a href="../../fat/tools/lipo.html">
            
                    
                        <b>1.3.3.3.1.</b>
                    
                    lipo
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../codesign/">
            
                <a href="../../codesign/">
            
                    
                        <b>1.3.4.</b>
                    
                    codesign
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../../vm_addr/">
            
                <a href="../../vm_addr/">
            
                    
                        <b>1.3.5.</b>
                    
                    虚拟地址
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../../size_limit/">
            
                <a href="../../size_limit/">
            
                    
                        <b>1.3.6.</b>
                    
                    大小限制
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../../macho_tool/">
            
                <a href="../../../macho_tool/">
            
                    
                        <b>1.4.</b>
                    
                    Mach-O工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../../macho_tool/machoview/">
            
                <a href="../../../macho_tool/machoview/">
            
                    
                        <b>1.4.1.</b>
                    
                    MachOView
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../../macho_tool/machoview/examples/">
            
                <a href="../../../macho_tool/machoview/examples/">
            
                    
                        <b>1.4.1.1.</b>
                    
                    举例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1.1" data-path="../../../macho_tool/machoview/examples/main_arm64.html">
            
                <a href="../../../macho_tool/machoview/examples/main_arm64.html">
            
                    
                        <b>1.4.1.1.1.</b>
                    
                    main_arm64
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.1.2" data-path="../../../macho_tool/machoview/examples/awemecore.html">
            
                <a href="../../../macho_tool/machoview/examples/awemecore.html">
            
                    
                        <b>1.4.1.1.2.</b>
                    
                    AwemeCore
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.1.3" data-path="../../../macho_tool/machoview/examples/zzzzheibaoLib_dylib.html">
            
                <a href="../../../macho_tool/machoview/examples/zzzzheibaoLib_dylib.html">
            
                    
                        <b>1.4.1.1.3.</b>
                    
                    zzzzHeiBaoLib.dylib
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../../../macho_tool/machoview/summary/">
            
                <a href="../../../macho_tool/machoview/summary/">
            
                    
                        <b>1.4.1.2.</b>
                    
                    心得
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.2.1" data-path="../../../macho_tool/machoview/summary/self_compile.html">
            
                <a href="../../../macho_tool/machoview/summary/self_compile.html">
            
                    
                        <b>1.4.1.2.1.</b>
                    
                    自己编译
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../../macho_tool/rabin2/">
            
                <a href="../../../macho_tool/rabin2/">
            
                    
                        <b>1.4.2.</b>
                    
                    rabin2
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../../macho_tool/rabin2/usage/">
            
                <a href="../../../macho_tool/rabin2/usage/">
            
                    
                        <b>1.4.2.1.</b>
                    
                    用法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../../../macho_tool/rabin2/examples/">
            
                <a href="../../../macho_tool/rabin2/examples/">
            
                    
                        <b>1.4.2.2.</b>
                    
                    举例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.2.1" data-path="../../../macho_tool/rabin2/examples/awemecore.html">
            
                <a href="../../../macho_tool/rabin2/examples/awemecore.html">
            
                    
                        <b>1.4.2.2.1.</b>
                    
                    AwemeCore
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2.2" data-path="../../../macho_tool/rabin2/examples/maskpro_dylib.html">
            
                <a href="../../../macho_tool/rabin2/examples/maskpro_dylib.html">
            
                    
                        <b>1.4.2.2.2.</b>
                    
                    MaskPro.dylib
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../../../macho_tool/rabin2/help.html">
            
                <a href="../../../macho_tool/rabin2/help.html">
            
                    
                        <b>1.4.2.3.</b>
                    
                    help
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../../macho_tool/jtool2/">
            
                <a href="../../../macho_tool/jtool2/">
            
                    
                        <b>1.4.3.</b>
                    
                    jtool2
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../../../macho_tool/jtool2/usage/">
            
                <a href="../../../macho_tool/jtool2/usage/">
            
                    
                        <b>1.4.3.1.</b>
                    
                    用法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../../../macho_tool/jtool2/examples/">
            
                <a href="../../../macho_tool/jtool2/examples/">
            
                    
                        <b>1.4.3.2.</b>
                    
                    举例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.2.1" data-path="../../../macho_tool/jtool2/examples/awemecore.html">
            
                <a href="../../../macho_tool/jtool2/examples/awemecore.html">
            
                    
                        <b>1.4.3.2.1.</b>
                    
                    AwemeCore
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2.2" data-path="../../../macho_tool/jtool2/examples/maskpro_dylib.html">
            
                <a href="../../../macho_tool/jtool2/examples/maskpro_dylib.html">
            
                    
                        <b>1.4.3.2.2.</b>
                    
                    MaskPro.dylib
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2.3" data-path="../../../macho_tool/jtool2/examples/akd.html">
            
                <a href="../../../macho_tool/jtool2/examples/akd.html">
            
                    
                        <b>1.4.3.2.3.</b>
                    
                    akd
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../../../macho_tool/jtool2/help.html">
            
                <a href="../../../macho_tool/jtool2/help.html">
            
                    
                        <b>1.4.3.3.</b>
                    
                    help
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../../../macho_tool/otool/">
            
                <a href="../../../macho_tool/otool/">
            
                    
                        <b>1.4.4.</b>
                    
                    otool
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../../../macho_tool/otool/usage/">
            
                <a href="../../../macho_tool/otool/usage/">
            
                    
                        <b>1.4.4.1.</b>
                    
                    用法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../../../macho_tool/otool/examples/">
            
                <a href="../../../macho_tool/otool/examples/">
            
                    
                        <b>1.4.4.2.</b>
                    
                    举例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.2.1" data-path="../../../macho_tool/otool/examples/aweme.html">
            
                <a href="../../../macho_tool/otool/examples/aweme.html">
            
                    
                        <b>1.4.4.2.1.</b>
                    
                    Aweme
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2.2" data-path="../../../macho_tool/otool/examples/awemecore.html">
            
                <a href="../../../macho_tool/otool/examples/awemecore.html">
            
                    
                        <b>1.4.4.2.2.</b>
                    
                    AwemeCore
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2.3" data-path="../../../macho_tool/otool/examples/maskpro_dylib.html">
            
                <a href="../../../macho_tool/otool/examples/maskpro_dylib.html">
            
                    
                        <b>1.4.4.2.3.</b>
                    
                    MaskPro.dylib
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4.3" data-path="../../../macho_tool/otool/help.html">
            
                <a href="../../../macho_tool/otool/help.html">
            
                    
                        <b>1.4.4.3.</b>
                    
                    help
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../../../macho_tool/pagestuff/">
            
                <a href="../../../macho_tool/pagestuff/">
            
                    
                        <b>1.4.5.</b>
                    
                    pagestuff
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.5.1" data-path="../../../macho_tool/pagestuff/help.html">
            
                <a href="../../../macho_tool/pagestuff/help.html">
            
                    
                        <b>1.4.5.1.</b>
                    
                    help
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../../appendix/">
            
                <a href="../../../appendix/">
            
                    
                        <b>1.5.</b>
                    
                    附录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../../appendix/doc_material.html">
            
                <a href="../../../appendix/doc_material.html">
            
                    
                        <b>1.5.1.</b>
                    
                    Mach-O文档和资料
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../../appendix/reference.html">
            
                <a href="../../../appendix/reference.html">
            
                    
                        <b>1.5.2.</b>
                    
                    参考资料
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            本书使用 HonKit 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Segment</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <html><head></head><body><h1 id="segment"><a name="segment" class="plugin-anchor" href="#segment"><i class="fa fa-link" aria-hidden="true"></i></a>segment</h1>
<ul>
<li>Mach-O中包含1个或多个segment<ul>
<li>一个segment中包含0或多个section</li>
</ul>
</li>
<li>segment和sectoin的基本定义<ul>
<li><img src="../../../assets/img/macho_segments_sections.png" alt="macho_segments_sections"></li>
</ul>
</li>
</ul>
<h2 id="常见segment"><a name="常见segment" class="plugin-anchor" href="#常见segment"><i class="fa fa-link" aria-hidden="true"></i></a>常见segment</h2>
<ul>
<li>概述<ul>
<li>最常用的segment：<code>__PAGEZERO</code>、<code>__TEXT</code>、<code>__DATA</code>、<code>__LINKEDIT</code><ul>
<li>举例<ul>
<li>MachOView查看某Mach-O的效果<ul>
<li><img src="../../../assets/img/machoview_four_segments.png" alt="machoview_four_segments"></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>详解<ul>
<li><code>__PAGEZERO</code><ul>
<li>The static linker creates a <code>__PAGEZERO</code> segment as the first segment of an executable file. This segment is located at virtual memory location 0 and has no protection rights assigned, the combination of which causes accesses to NULL, a common C programming error, to immediately crash. The <code>__PAGEZERO</code> segment is the size of one full VM page for the current architecture (for Intel-based and PowerPC-based Macintosh computers, this is 4096 bytes or 0x1000 in hexadecimal). Because there is no data in the <code>__PAGEZERO</code> segment, it occupies no space in the file (the file size in the segment command is 0).</li>
</ul>
</li>
<li><code>__TEXT</code><ul>
<li>The <code>__TEXT</code> segment contains executable code and other read-only data. To allow the kernel to map it directly from the executable into sharable memory, the static linker sets this segment’s virtual memory permissions to disallow writing. When the segment is mapped into memory, it can be shared among all processes interested in its contents. (This is primarily used with frameworks, bundles, and shared libraries, but it is possible to run multiple copies of the same executable in OS X, and this applies in that case as well.) The read-only attribute also means that the pages that make up the <code>__TEXT</code> segment never need to be written back to disk. When the kernel needs to free up physical memory, it can simply discard one or more <code>__TEXT</code> pages and re-read them from disk when they are next needed.</li>
</ul>
</li>
<li><code>__DATA</code><ul>
<li>The <code>__DATA</code> segment contains writable data. The static linker sets the virtual memory permissions of this segment to allow both reading and writing. Because it is writable, the <code>__DATA</code> segment of a framework or other shared library is logically copied for each process linking with the library. When memory pages such as those making up the <code>__DATA</code> segment are readable and writable, the kernel marks them copy-on-write; therefore when a process writes to one of these pages, that process receives its own private copy of the page.</li>
</ul>
</li>
<li><code>__OBJC</code><ul>
<li>The __OBJC segment contains data used by the Objective-C language runtime support library.</li>
</ul>
</li>
<li><code>__IMPORT</code><ul>
<li>The __IMPORT segment contains symbol stubs and non-lazy pointers to symbols not defined in the executable. This segment is generated only for executables targeted for the IA-32 architecture.</li>
</ul>
</li>
<li><code>__LINKEDIT</code><ul>
<li>The __LINKEDIT segment contains raw data used by the dynamic linker, such as symbol, string, and relocation table entries.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="主要segment的section"><a name="主要segment的section" class="plugin-anchor" href="#主要segment的section"><i class="fa fa-link" aria-hidden="true"></i></a>主要segment的section</h2>
<ul>
<li>segment段<ul>
<li><code>__TEXT</code>段<ul>
<li>Section节<ul>
<li><code>__text</code>: The compiled machine code for the executable</li>
<li><code>__const</code>: The general constant data for the executable</li>
<li><code>__cstring</code>: Literal string constants (quoted strings in source code)</li>
<li><code>__picsymbol_stub</code>: Position-independent code stub routines used by the dynamic linker (dyld)</li>
</ul>
</li>
</ul>
</li>
<li><code>__DATA</code>段<ul>
<li>Section节<ul>
<li><code>__data</code>: Initialized global variables (for example <code>int a = 1;</code> or <code>static int a = 1;</code>)</li>
<li><code>__const</code>: Constant data needing relocation (for example, <code>char * const p = &quot;foo&quot;;</code>)</li>
<li><code>__bss</code>: Uninitialized static variables (for example, <code>static int a;</code>)</li>
<li><code>__common</code>: Uninitialized external globals (for example, <code>int a;</code> outside function blocks)</li>
<li><code>__dyld</code>: A placeholder section, used by the dynamic linker</li>
<li><code>__la_symbol_ptr</code>: <strong>Lazy</strong> symbol pointers. Symbol pointers for each undefined function called by the executable</li>
<li><code>__nl_symbol_ptr</code>: <strong>Non lazy</strong> symbol pointers. Symbol pointers for each undefined data symbol referenced by the executable</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="举例"><a name="举例" class="plugin-anchor" href="#举例"><i class="fa fa-link" aria-hidden="true"></i></a>举例</h3>
<ul>
<li>举例1<ul>
<li><img src="../../../assets/img/machoview_file_text_data.png" alt="machoview_file_text_data"></li>
</ul>
</li>
<li>举例2<ul>
<li>MachOView查看zzzzHeiBaoLib.dylib<ul>
<li><img src="../../../assets/img/machoview_heibao_text_data.png" alt="machoview_heibao_text_data"></li>
</ul>
</li>
</ul>
</li>
<li>举例3<pre class="language-"><code class="lang-bash"><span class="token comment"># Sections:</span>
<span class="token comment"># Address    Size        Segment    Section</span>
0x100001DC0    0x00A38B42    __TEXT    __text
0x100A3A902    0x00001C9E    __TEXT    __stubs
0x100A3C5A0    0x0000204A    __TEXT    __stub_helper
0x100A3E5EC    0x000231B0    __TEXT    __gcc_except_tab
0x100A617A0    0x000178D0    __TEXT    __const
0x100A79070    0x0008A5DA    __TEXT    __cstring
0x100B0364A    0x0005F462    __TEXT    __objc_methname
0x100B62AAC    0x00008794    __TEXT    __objc_classname
0x100B6B240    0x0003B4EB    __TEXT    __objc_methtype
0x100BA672C    0x00001742    __TEXT    __ustring
0x100BA7E6E    0x00000172    __TEXT    __entitlements
0x100BA7FE0    0x0000037B    __TEXT    __dof_RACSignal
0x100BA835B    0x000002E8    __TEXT    __dof_RACCompou
0x100BA8644    0x00012964    __TEXT    __unwind_info
0x100BBAFA8    0x00000058    __TEXT    __eh_frame
0x100BBB000    0x00000008    __DATA    __nl_symbol_ptr
0x100BBB008    0x00000BD8    __DATA    __got
0x100BBBBE0    0x00002628    __DATA    __la_symbol_ptr
0x100BBE208    0x00000070    __DATA    __mod_init_func
0x100BBE280    0x0001CEE0    __DATA    __const
0x100BDB160    0x00039CA0    __DATA    __cfstring
0x100C14E00    0x00002B00    __DATA    __objc_classlist
0x100C17900    0x000000A0    __DATA    __objc_nlclslist
0x100C179A0    0x00000680    __DATA    __objc_catlist
0x100C18020    0x000000D0    __DATA    __objc_nlcatlist
0x100C180F0    0x00000638    __DATA    __objc_protolist
0x100C18728    0x00000008    __DATA    __objc_imageinfo
0x100C18730    0x001252F8    __DATA    __objc_const
0x100D3DA28    0x000150B0    __DATA    __objc_selrefs
0x100D52AD8    0x00000150    __DATA    __objc_protorefs
0x100D52C28    0x00002A38    __DATA    __objc_classrefs
0x100D55660    0x000019F8    __DATA    __objc_superrefs
0x100D57058    0x000085E8    __DATA    __objc_ivar
0x100D5F640    0x0001AE00    __DATA    __objc_data
0x100D7A440    0x0000CC70    __DATA    __data
0x100D870B0    0x00004698    __DATA    __bss
0x100D8B750    0x00001298    __DATA    __common
</code></pre>
</li>
</ul>
<footer class="page-footer"><span class="copyright">crifan.org，使用<a href="https://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank">署名4.0国际(CC BY 4.0)协议</a>发布 all right reserved，powered by Gitbook</span><span class="footer-modification">最后更新：
2023-10-07 22:08:22
</span></footer></body></html>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../load_commands/lc_dyld_exports_trie.html" class="navigation navigation-prev " aria-label="Previous page: LC_DYLD_EXPORTS_TRIE">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="__text/" class="navigation navigation-next " aria-label="Next page: __TEXT">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Segment","level":"1.3.2.3","depth":3,"next":{"title":"__TEXT","level":"1.3.2.3.1","depth":4,"path":"macho_format/detail/segment/__text/README.md","ref":"macho_format/detail/segment/__text/README.md","articles":[{"title":"__text","level":"1.3.2.3.1.1","depth":5,"path":"macho_format/detail/segment/__text/__text.md","ref":"macho_format/detail/segment/__text/__text.md","articles":[]}]},"previous":{"title":"LC_DYLD_EXPORTS_TRIE","level":"1.3.2.2.6","depth":4,"path":"macho_format/detail/load_commands/lc_dyld_exports_trie.md","ref":"macho_format/detail/load_commands/lc_dyld_exports_trie.md","articles":[]},"articles":[{"title":"__TEXT","level":"1.3.2.3.1","depth":4,"path":"macho_format/detail/segment/__text/README.md","ref":"macho_format/detail/segment/__text/README.md","articles":[{"title":"__text","level":"1.3.2.3.1.1","depth":5,"path":"macho_format/detail/segment/__text/__text.md","ref":"macho_format/detail/segment/__text/__text.md","articles":[]}]},{"title":"__DATA","level":"1.3.2.3.2","depth":4,"path":"macho_format/detail/segment/__data/README.md","ref":"macho_format/detail/segment/__data/README.md","articles":[{"title":"__la_symbol_ptr","level":"1.3.2.3.2.1","depth":5,"path":"macho_format/detail/segment/__data/__la_symbol_ptr.md","ref":"macho_format/detail/segment/__data/__la_symbol_ptr.md","articles":[]},{"title":"__got","level":"1.3.2.3.2.2","depth":5,"path":"macho_format/detail/segment/__data/__got.md","ref":"macho_format/detail/segment/__data/__got.md","articles":[]}]},{"title":"__IMPORT","level":"1.3.2.3.3","depth":4,"path":"macho_format/detail/segment/__import.md","ref":"macho_format/detail/segment/__import.md","articles":[]},{"title":"__LINKEDIT","level":"1.3.2.3.4","depth":4,"path":"macho_format/detail/segment/__linkedit.md","ref":"macho_format/detail/segment/__linkedit.md","articles":[]},{"title":"__OBJC","level":"1.3.2.3.5","depth":4,"path":"macho_format/detail/segment/__objc.md","ref":"macho_format/detail/segment/__objc.md","articles":[]}],"dir":"ltr"},"config":{"plugins":["theme-comscore","anchors","expandable-menu","-lunr","-search","search-plus","disqus","-highlight","prism","prism-themes","github-buttons","-splitter","splitter-nosessionbutcookie","-sharing","sharing-plus","tbfed-pagefooter","donate","sitemap-general","copy-code-button","callouts","toolbar-button"],"root":"./src","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"crifan.org，使用<a href='https://creativecommons.org/licenses/by/4.0/deed.zh'>署名4.0国际(CC BY 4.0)协议</a>发布","modify_label":"最后更新：","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"css":["prism-themes/themes/prism-atom-dark.css"]},"disqus":{"useIdentifier":false,"shortName":"crifan"},"callouts":{"showTypeInHeader":false},"toolbar-button":{"label":"下载PDF","url":"https://book.crifan.org/books/exec_file_format_macho/pdf/exec_file_format_macho.pdf","icon":"fa-file-pdf-o"},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"donate":{"title":"","button":"打赏","wechat":"https://www.crifan.org/files/res/crifan_com/crifan_wechat_pay.jpg","alipay":"https://www.crifan.org/files/res/crifan_com/crifan_alipay_pay.jpg","wechatText":"微信打赏给Crifan","alipayText":"支付宝打赏给Crifan"},"sitemap-general":{"prefix":"https://book.crifan.org/books/exec_file_format_macho/website/"},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-comscore":{},"splitter-nosessionbutcookie":{},"prism-themes":{},"github-buttons":{"buttons":[{"repo":"exec_file_format_macho","user":"crifan","type":"star","count":true,"size":"small"},{"user":"crifan","type":"follow","width":"120","count":false,"size":"small"}]},"expandable-menu":{},"copy-code-button":{},"sharing":{"qq":true,"all":["douban","facebook","google","instapaper","line","linkedin","messenger","pocket","qq","qzone","stumbleupon","twitter","viber","vk","weibo","whatsapp"],"douban":false,"facebook":true,"weibo":true,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":false,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"anchors":{},"search-plus":{}},"theme":"default","author":"Crifan Li <admin@crifan.com>","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"可执行文件格式：Mach-O","language":"zh-hans","links":{"sidebar":{"主页":"http://www.crifan.org"}},"gitbook":"*","description":"介绍Mac和iOS等Apple苹果系统的常见可执行文件格式：Mach-O；先是Mach-O概览；包括背景知识的XNU、编译链接加载过程、PIC等；然后介绍Mach-O格式，包括结构概述和结构图，以及结构详情，包括Header、Load Commands和Segment的data；其中Header包括magic、cputype和cpusubtype、filetype、flags；Load Commands包括LC_UUID、LC_SEGMENT、LC_SEGMENT_64、LC_SYMTAB、LC_DYLD_CHAINED_FIXUPS、LC_DYLD_EXPORTS_TRIE等；Segment包括__TEXT、__DATA、__IMPORT、__LINKEDIT、__OBJC；以及各个Segment的section，比如symbol、strings等；然后是Mach-O格式的子项，包括FAT、codesign、虚拟地址、大小限制等；然后整理Mach-O的各种工具，包括MachOView、rabin2、jtool2、otool、pagestuff，以及每个工具的用法、举例、help语法等；"},"file":{"path":"macho_format/detail/segment/README.md","mtime":"2023-10-07T14:08:22.264Z","type":"markdown"},"gitbook":{"version":"4.0.7","time":"2023-10-07T15:27:55.016Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-expandable-menu/expandable-chapters.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-splitter-nosessionbutcookie/splitter.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-toolbar-button/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

