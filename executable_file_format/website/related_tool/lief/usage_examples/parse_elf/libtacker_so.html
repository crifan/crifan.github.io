
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <title>libtacker.so · 可执行文件格式</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.7">
        <meta name="author" content="Crifan Li <admin@crifan.com>">
        
        
    
    <link rel="stylesheet" href="../../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-expandable-menu/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-prism/prism-atom-dark.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-splitter-nosessionbutcookie/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-callouts/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../../../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../../../../sub_books/" />
    
    
    <link rel="prev" href="./" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"repo":"executable_file_format","user":"crifan","type":"star","count":true,"size":"small"},{"user":"crifan","type":"follow","width":"120","count":false,"size":"small"}]};
    </script>

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://www.crifan.org" target="_blank" class="custom-link">主页</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../../">
            
                <a href="../../../../">
            
                    
                        <b>1.1.</b>
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../../../exec_file_fmt_overview/">
            
                <a href="../../../../exec_file_fmt_overview/">
            
                    
                        <b>1.2.</b>
                    
                    可执行文件格式概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../../../common_part/">
            
                <a href="../../../../common_part/">
            
                    
                        <b>1.3.</b>
                    
                    通用内容
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../../../common_format/">
            
                <a href="../../../../common_format/">
            
                    
                        <b>1.4.</b>
                    
                    常见格式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../../../common_format/coff.html">
            
                <a href="../../../../common_format/coff.html">
            
                    
                        <b>1.4.1.</b>
                    
                    COFF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../../../common_format/pe.html">
            
                <a href="../../../../common_format/pe.html">
            
                    
                        <b>1.4.2.</b>
                    
                    PE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../../../common_format/elf.html">
            
                <a href="../../../../common_format/elf.html">
            
                    
                        <b>1.4.3.</b>
                    
                    ELF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../../../../common_format/mach_o.html">
            
                <a href="../../../../common_format/mach_o.html">
            
                    
                        <b>1.4.4.</b>
                    
                    Mach-O
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../../">
            
                <a href="../../../">
            
                    
                        <b>1.5.</b>
                    
                    相关工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../../file.html">
            
                <a href="../../../file.html">
            
                    
                        <b>1.5.1.</b>
                    
                    file
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../">
            
                <a href="../../">
            
                    
                        <b>1.5.2.</b>
                    
                    LIEF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.5.2.1.</b>
                    
                    LIEF用法举例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1.1" data-path="../parse_macho.html">
            
                <a href="../parse_macho.html">
            
                    
                        <b>1.5.2.1.1.</b>
                    
                    Mach-O
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.2" data-path="../parse_android/">
            
                <a href="../parse_android/">
            
                    
                        <b>1.5.2.1.2.</b>
                    
                    Android
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1.2.1" data-path="../parse_android/oat.html">
            
                <a href="../parse_android/oat.html">
            
                    
                        <b>1.5.2.1.2.1.</b>
                    
                    OAT
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.3" data-path="./">
            
                <a href="./">
            
                    
                        <b>1.5.2.1.3.</b>
                    
                    ELF
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.2.1.3.1" data-path="libtacker_so.html">
            
                <a href="libtacker_so.html">
            
                    
                        <b>1.5.2.1.3.1.</b>
                    
                    libtacker.so
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../../../sub_books/">
            
                <a href="../../../../sub_books/">
            
                    
                        <b>1.6.</b>
                    
                    子教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../../../appendix/">
            
                <a href="../../../../appendix/">
            
                    
                        <b>1.7.</b>
                    
                    附录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../../../appendix/reference.html">
            
                <a href="../../../../appendix/reference.html">
            
                    
                        <b>1.7.1.</b>
                    
                    参考资料
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            本书使用 HonKit 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../.." >libtacker.so</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <html><head></head><body><h1 id="lief修改elf的libtackerso"><a name="lief修改elf的libtackerso" class="plugin-anchor" href="#lief修改elf的libtackerso"><i class="fa fa-link" aria-hidden="true"></i></a>LIEF修改ELF的libtacker.so</h1>
<p>此处举例说明LIEF的用法：</p>
<ul>
<li>用LIEF解析修改ELF格式的so库文件：<code>libtacker.so</code></li>
</ul>
<h2 id="基本用法：打印解析后对象的信息"><a name="基本用法：打印解析后对象的信息" class="plugin-anchor" href="#基本用法：打印解析后对象的信息"><i class="fa fa-link" aria-hidden="true"></i></a>基本用法：打印解析后对象的信息</h2>
<p>代码：</p>
<pre class="language-"><code class="lang-py"><span class="token keyword">import</span> lief

libtackerObj <span class="token operator">=</span> lief<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&apos;modifyElf/input/libtacker_arm64_v8a.so&apos;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;libtackerObj=&quot;</span><span class="token punctuation">,</span> libtackerObj<span class="token punctuation">)</span>
</code></pre>
<p>输出：</p>
<pre class="language-"><code class="lang-bash">➜  libtacker_so python modifyElf/modifyLibtackerSo.py
<span class="token assign-left variable">intputElfFile</span><span class="token operator">=</span> modifyElf/input/libtacker_armeabi_v7a.so
<span class="token assign-left variable">inputFileName</span><span class="token operator">=</span> libtacker_armeabi_v7a.so
<span class="token assign-left variable">pureFileName</span><span class="token operator">=</span>%s, <span class="token assign-left variable">fileExt</span><span class="token operator">=</span>%s <span class="token punctuation">(</span><span class="token string">&apos;libtacker_armeabi_v7a&apos;</span>, <span class="token string">&apos;.so&apos;</span><span class="token punctuation">)</span>
Loaded file:  modifyElf/input/libtacker_armeabi_v7a.so
<span class="token assign-left variable">libtackerElf</span><span class="token operator">=</span> Header
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
Magic:                           7f <span class="token number">45</span> 4c <span class="token number">46</span>
Class:                           CLASS32
Endianness:                      LSB
Version:                         CURRENT
OS/ABI:                          SYSTEMV
ABI Version:                     <span class="token number">0</span>
Machine type:                    ARM
File type:                       DYNAMIC
Object <span class="token function">file</span> version:             CURRENT
Entry Point:                     0xb9c8
Program header offset:           0x34
Section header offset:           <span class="token number">815008</span>
Processor Flag:                  <span class="token number">83886592</span> SOFT_FLOAT EABI_VER5
Header size:                     <span class="token number">52</span>
Size of program header:          <span class="token number">32</span>
Number of program header:        <span class="token number">9</span>
Size of section header:          <span class="token number">40</span>
Number of section headers:       <span class="token number">27</span>
Section Name Table idx:          <span class="token number">26</span>

Sections
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
                    NULL           <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>
.note.android.ident NOTE           <span class="token number">154</span>       <span class="token number">98</span>        <span class="token number">154</span>       <span class="token number">1.09412</span>   ALLOC                         LOAD NOTE
.note.gnu.build-id  NOTE           1ec       <span class="token number">24</span>        1ec       <span class="token number">4.13606</span>   ALLOC                         LOAD NOTE
.dynsym             DYNSYM         <span class="token number">210</span>       6d0       <span class="token number">210</span>       <span class="token number">3.54702</span>   ALLOC                         LOAD
.gnu.version        HIOS           8e0       da        8e0       <span class="token number">1.48975</span>   ALLOC                         LOAD
.gnu.version_r      GNU_VERNEED    9bc       <span class="token number">40</span>        9bc       <span class="token number">2.16157</span>   ALLOC                         LOAD
.gnu.hash           GNU_HASH       9fc       1ec       9fc       <span class="token number">6.3602</span>    ALLOC                         LOAD
.hash               HASH           be8       <span class="token number">370</span>       be8       <span class="token number">1.38896</span>   ALLOC                         LOAD
.dynstr             STRTAB         f58       b8f       f58       <span class="token number">4.66594</span>   ALLOC                         LOAD
.rel.dyn            REL            1ae8      2dd0      1ae8      <span class="token number">3.36673</span>   ALLOC                         LOAD
.ARM.exidx          ARM_EXIDX      48b8      1ad8      48b8      <span class="token number">5.18866</span>   ALLOC LINK_ORDER              LOAD ARM_UNWIND
.rel.plt            REL            <span class="token number">6390</span>      <span class="token number">120</span>       <span class="token number">6390</span>      <span class="token number">3.54485</span>   ALLOC INFO_LINK               LOAD
.ARM.extab          PROGBITS       64b0      334c      64b0      <span class="token number">4.80098</span>   ALLOC                         LOAD
.rodata             PROGBITS       97fc      21c7      97fc      <span class="token number">5.26982</span>   ALLOC MERGE STRINGS           LOAD
.text               PROGBITS       b9c8      b72c4     b9c8      <span class="token number">6.55022</span>   ALLOC EXECINSTR               LOAD
.plt                PROGBITS       c2c90     <span class="token number">260</span>       c2c90     <span class="token number">3.78829</span>   ALLOC EXECINSTR               LOAD
.data.rel.ro        PROGBITS       c3ef0     <span class="token number">1790</span>      c2ef0     <span class="token number">4.42226</span>   WRITE ALLOC                   LOAD GNU_RELRO
.fini_array         FINI_ARRAY     c5680     <span class="token number">8</span>         c4680     <span class="token number">1.75</span>      WRITE ALLOC                   LOAD GNU_RELRO
.init_array         INIT_ARRAY     c5688     <span class="token number">114</span>       c4688     <span class="token parameter variable">-0</span>        WRITE ALLOC                   LOAD GNU_RELRO
.dynamic            DYNAMIC        c579c     e8        c479c     <span class="token number">3.17459</span>   WRITE ALLOC                   LOAD DYNAMIC GNU_RELRO
.got                PROGBITS       c5884     <span class="token number">70</span>        c4884     <span class="token number">3.63662</span>   WRITE ALLOC                   LOAD GNU_RELRO
.got.plt            PROGBITS       c58f4     9c        c48f4     <span class="token number">1.98777</span>   WRITE ALLOC                   LOAD GNU_RELRO
.data               PROGBITS       c6990     <span class="token number">2410</span>      c4990     <span class="token number">7.22773</span>   WRITE ALLOC                   LOAD
.bss                NOBITS         c8da0     22d       c6da0     <span class="token number">5.11609</span>   WRITE ALLOC                   LOAD
.comment            PROGBITS       <span class="token number">0</span>         c6        c6da0     <span class="token number">5.05236</span>   MERGE STRINGS
.ARM.attributes     ARM_ATTRIBUTES <span class="token number">0</span>         3c        c6e66     <span class="token number">4.587</span>
.shstrtab           STRTAB         <span class="token number">0</span>         fe        c6ea2     <span class="token number">4.2632</span>

Segments
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
PHDR              r--       <span class="token number">34</span>        <span class="token number">34</span>        <span class="token number">34</span>        <span class="token number">120</span>       <span class="token number">120</span>       <span class="token number">4</span>

LOAD              r-x       <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>         c2ef0     c2ef0     <span class="token number">1000</span>
Sections <span class="token keyword">in</span> this segment <span class="token builtin class-name">:</span>
    .note.android.ident
    .note.gnu.build-id
    .dynsym
    .gnu.version
    .gnu.version_r
    .gnu.hash
    .hash
    .dynstr
    .rel.dyn
    .ARM.exidx
    .rel.plt
    .ARM.extab
    .rodata
    .text
    .plt

LOAD              rw-       c2ef0     c3ef0     c3ef0     1aa0      1aa0      <span class="token number">1000</span>
Sections <span class="token keyword">in</span> this segment <span class="token builtin class-name">:</span>
    .data.rel.ro
    .fini_array
    .init_array
    .dynamic
    .got
    .got.plt

LOAD              rw-       c4990     c6990     c6990     <span class="token number">2410</span>      263d      <span class="token number">1000</span>
Sections <span class="token keyword">in</span> this segment <span class="token builtin class-name">:</span>
    .data
    .bss

DYNAMIC           rw-       c479c     c579c     c579c     e8        e8        <span class="token number">4</span>
Sections <span class="token keyword">in</span> this segment <span class="token builtin class-name">:</span>
    .dynamic

GNU_RELRO         r--       c2ef0     c3ef0     c3ef0     1aa0      <span class="token number">2110</span>      <span class="token number">1</span>
Sections <span class="token keyword">in</span> this segment <span class="token builtin class-name">:</span>
    .data.rel.ro
    .fini_array
    .init_array
    .dynamic
    .got
    .got.plt

GNU_STACK         rw-       <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>         <span class="token number">0</span>

NOTE              r--       <span class="token number">154</span>       <span class="token number">154</span>       <span class="token number">154</span>       <span class="token function">bc</span>        <span class="token function">bc</span>        <span class="token number">4</span>
Sections <span class="token keyword">in</span> this segment <span class="token builtin class-name">:</span>
    .note.android.ident
    .note.gnu.build-id

ARM_UNWIND        r--       48b8      48b8      48b8      1ad8      1ad8      <span class="token number">4</span>
Sections <span class="token keyword">in</span> this segment <span class="token builtin class-name">:</span>
    .ARM.exidx


Dynamic entries
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
NEEDED              b71       liblog.so
NEEDED              b7b       libm.so
NEEDED              b5b       libdl.so
NEEDED              b69       libc.so
SONAME              b83       libforce.so
FLAGS               <span class="token number">8</span>          BIND_NOW
FLAGS_1             <span class="token number">1</span>          NOW
REL                 1ae8
RELSZ               2dd0
RELENT              <span class="token number">8</span>
RELCOUNT            <span class="token number">573</span>
JMPREL              <span class="token number">6390</span>
PLTRELSZ            <span class="token number">120</span>
PLTGOT              c58f4
PLTREL              <span class="token number">11</span>
SYMTAB              <span class="token number">210</span>
SYMENT              <span class="token number">10</span>
STRTAB              f58
STRSZ               b8f
GNU_HASH            9fc
HASH                be8
INIT_ARRAY          c5688     <span class="token punctuation">[</span>0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0<span class="token punctuation">]</span>
INIT_ARRAYSZ        <span class="token number">114</span>
FINI_ARRAY          c5680     <span class="token punctuation">[</span>0xb9dc, 0xb9c8<span class="token punctuation">]</span>
FINI_ARRAYSZ        <span class="token number">8</span>
VERSYM              8e0
VERNEED             9bc
VERNEEDNUM          <span class="token number">2</span>
NULL                <span class="token number">0</span>

Dynamic symbols
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
                              NOTYPE    LOCAL     <span class="token number">0</span>         <span class="token number">0</span>         * Local *
__cxa_finalize                FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__cxa_atexit                  FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__android_log_print           FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         * Global *
__stack_chk_fail              FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__stack_chk_guard             OBJECT    GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__strncpy_chk2                FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
strncpy                       FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
strncat                       FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_self                  FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
malloc                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token function">free</span>                          FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
posix_memalign                FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
abort                         FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
vfprintf                      FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fputc                         FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
vasprintf                     FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__assert2                     FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__sF                          OBJECT    GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
strlen                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
realloc                       FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__strlen_chk                  FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
memchr                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
__vsnprintf_chk               FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_mutex_lock            FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
calloc                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_mutex_unlock          FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
strcmp                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_getspecific           FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
memset                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_once                  FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_setspecific           FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
memcpy                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_key_delete            FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
pthread_key_create            FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
memmove                       FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fprintf                       FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
fflush                        FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
dl_unwind_find_exidx          FUNC      GLOBAL    <span class="token number">0</span>         <span class="token number">0</span>         LIBC      <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
.datadiv_decode8345671930506918460FUNC      GLOBAL    28ec9     <span class="token number">2384</span>      * Global *
.datadiv_decode17898716361002246085FUNC      GLOBAL    69a59     eee       * Global *
<span class="token punctuation">..</span>.
.datadiv_decode18430821605022316503FUNC      GLOBAL    9c47d     <span class="token number">1044</span>      * Global *
JNI_OnLoad                    FUNC      GLOBAL    b2bcd     48c       * Global *
.datadiv_decode9810505568447265400FUNC      GLOBAL    18c81     33e8      * Global *
<span class="token punctuation">..</span>.
.datadiv_decode3623259086264565478FUNC      GLOBAL    <span class="token number">89201</span>     8e6       * Global *

Static symbols
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

Symbol versions
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
* Local *
LIBC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
LIBC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
* Global *
LIBC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
LIBC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">..</span>.
LIBC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
LIBC<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
* Global *
<span class="token punctuation">..</span>.
* Global *

Symbol versions definition
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

Symbol version requirement
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token number">1</span> libdl.so
<span class="token number">1</span> libc.so

Dynamic relocations
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
c3ef0     RELATIVE  <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">0</span>         DYNAMIC
c3ef4     RELATIVE  <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">0</span>         DYNAMIC
c3ef8     RELATIVE  <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">0</span>         DYNAMIC
<span class="token punctuation">..</span>.
c8d9c     RELATIVE  <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">0</span>         DYNAMIC
c5884     GLOB_DAT  <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">5</span>         DYNAMIC   __stack_chk_guard
c58a8     GLOB_DAT  <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">12</span>        DYNAMIC   __sF
c56ac     ABS32     <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">27</span>        DYNAMIC   .datadiv_decode8345671930506918460
c56fc     ABS32     <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">28</span>        DYNAMIC   .datadiv_decode17898716361002246085
c573c     ABS32     <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">29</span>        DYNAMIC   .datadiv_decode1857239248186750646
<span class="token punctuation">..</span>.
c5738     ABS32     <span class="token number">32</span>  <span class="token number">0</span>         6c        DYNAMIC   .datadiv_decode3623259086264565478

.plt.got relocations
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
c5900     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">1</span>         PLTGOT    __cxa_finalize
c5904     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">2</span>         PLTGOT    __cxa_atexit
c5908     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">3</span>         PLTGOT    __android_log_print
c590c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">4</span>         PLTGOT    __stack_chk_fail
c5910     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">6</span>         PLTGOT    __strncpy_chk2
c5914     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">7</span>         PLTGOT    strncpy
c5918     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">8</span>         PLTGOT    strncat
c591c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">9</span>         PLTGOT    pthread_self
c5920     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         a         PLTGOT    malloc
c5924     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         b         PLTGOT    <span class="token function">free</span>
c5928     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         c         PLTGOT    posix_memalign
c592c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         d         PLTGOT    abort
c5930     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         e         PLTGOT    vfprintf
c5934     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         f         PLTGOT    fputc
c5938     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">10</span>        PLTGOT    vasprintf
c593c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">11</span>        PLTGOT    __assert2
c5940     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">13</span>        PLTGOT    strlen
c5944     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">14</span>        PLTGOT    realloc
c5948     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">15</span>        PLTGOT    __strlen_chk
c594c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">16</span>        PLTGOT    memchr
c5950     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">17</span>        PLTGOT    __vsnprintf_chk
c5954     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">18</span>        PLTGOT    pthread_mutex_lock
c5958     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">19</span>        PLTGOT    calloc
c595c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         1a        PLTGOT    pthread_mutex_unlock
c5960     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         1b        PLTGOT    strcmp
c5964     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         1c        PLTGOT    pthread_getspecific
c5968     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         1d        PLTGOT    memset
c596c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         1e        PLTGOT    pthread_once
c5970     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         1f        PLTGOT    pthread_setspecific
c5974     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">20</span>        PLTGOT    memcpy
c5978     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">21</span>        PLTGOT    pthread_key_delete
c597c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">22</span>        PLTGOT    pthread_key_create
c5980     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">23</span>        PLTGOT    memmove
c5984     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">24</span>        PLTGOT    fprintf
c5988     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">25</span>        PLTGOT    fflush
c598c     JUMP_SLOT <span class="token number">32</span>  <span class="token number">0</span>         <span class="token number">26</span>        PLTGOT    dl_unwind_find_exidx

Notes
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
Note <span class="token comment">#0</span>
-------
Name:                            Android
Type:                            ABI_TAG
Description:                     <span class="token punctuation">[</span><span class="token number">15</span> 00 00 00 <span class="token number">72</span> <span class="token number">32</span> <span class="token number">34</span> 00 00 00 00 00 00 00 00 00 <span class="token punctuation">..</span>.<span class="token punctuation">]</span>

Note <span class="token comment">#1</span>
-------
Name:                            GNU
Type:                            BUILD_ID
Description:                     <span class="token punctuation">[</span>fa 8a <span class="token number">30</span> <span class="token number">55</span> 6b db <span class="token number">44</span> 9a 4a 2f 1f <span class="token number">83</span> <span class="token number">46</span> 6d <span class="token number">93</span> <span class="token number">44</span> <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
ID Hash:                         fa8a30556bdb449a4a2f1f83466d9344fdef3fb5



GNU Hash Table
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
0x6000022d2e80

SYSV Hash Table
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
0x600001381b40
</code></pre>
<h2 id="复杂用法：修改comment内容为随机乱码"><a name="复杂用法：修改comment内容为随机乱码" class="plugin-anchor" href="#复杂用法：修改comment内容为随机乱码"><i class="fa fa-link" aria-hidden="true"></i></a>复杂用法：修改<code>.comment</code>内容为随机乱码</h2>
<p>代码：</p>
<ul>
<li><code>modifyElf/modifyLibtackerSo.py</code></li>
</ul>
<pre class="language-"><code class="lang-py"><span class="token comment"># Function: mofidy libtacker so (arm64_v8a, armeabi_v7a) comments section content the output to new one</span>
<span class="token comment"># Author: Crifan Li</span>
<span class="token comment"># Update: 20230912</span>

<span class="token keyword">import</span> os
<span class="token keyword">import</span> random
<span class="token keyword">import</span> string
<span class="token keyword">import</span> lief

<span class="token comment">################################################################################</span>
<span class="token comment"># input &amp; config</span>
<span class="token comment">################################################################################</span>

<span class="token comment"># intputElfFile = &quot;modifyElf/input/libtacker_arm64_v8a.so&quot;</span>
intputElfFile <span class="token operator">=</span> <span class="token string">&quot;modifyElf/input/libtacker_armeabi_v7a.so&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;intputElfFile=&quot;</span><span class="token punctuation">,</span> intputElfFile<span class="token punctuation">)</span>

outputFoler <span class="token operator">=</span> <span class="token string">&quot;modifyElf/output&quot;</span>

TotalRandomTime <span class="token operator">=</span> <span class="token number">40</span>
OutputSuffixStartNum <span class="token operator">=</span> <span class="token number">20</span>

<span class="token comment">################################################################################</span>
<span class="token comment"># generate output file name</span>
<span class="token comment">################################################################################</span>

inputFileName <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>intputElfFile<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;inputFileName=&quot;</span><span class="token punctuation">,</span> inputFileName<span class="token punctuation">)</span>
pureFileName<span class="token punctuation">,</span> fileExt <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>inputFileName<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;pureFileName=%s, fileExt=%s&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>pureFileName<span class="token punctuation">,</span> fileExt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># pureFileName=%s, fileExt=%s (&apos;libtacker_arm64_v8a&apos;, &apos;.so&apos;)</span>

<span class="token comment">################################################################################</span>
<span class="token comment"># Main</span>
<span class="token comment">################################################################################</span>

libtackerElf <span class="token operator">=</span> lief<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>intputElfFile<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Loaded file: &quot;</span><span class="token punctuation">,</span> intputElfFile<span class="token punctuation">)</span>
<span class="token comment"># print(&quot;libtackerElf=&quot;, libtackerElf)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;header=&quot;</span><span class="token punctuation">,</span> libtackerElf<span class="token punctuation">.</span>header<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;imported_functions=&quot;</span><span class="token punctuation">,</span> libtackerElf<span class="token punctuation">.</span>imported_functions<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;exported_functions=&quot;</span><span class="token punctuation">,</span> libtackerElf<span class="token punctuation">.</span>exported_functions<span class="token punctuation">)</span>

<span class="token keyword">for</span> section <span class="token keyword">in</span> libtackerElf<span class="token punctuation">.</span>sections<span class="token punctuation">:</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment"># section&apos;s name</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;name=&quot;</span><span class="token punctuation">,</span> section<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment"># section&apos;s name</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;size=&quot;</span><span class="token punctuation">,</span> section<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token comment"># section&apos;s size</span>
  contentLen <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>section<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;contentLen=&quot;</span><span class="token punctuation">,</span> contentLen<span class="token punctuation">)</span> <span class="token comment"># Should match the previous print</span>

commentSection <span class="token operator">=</span> libtackerElf<span class="token punctuation">.</span>get_section<span class="token punctuation">(</span><span class="token string">&quot;.comment&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n\n&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;+++ Start total %d round overwrite .comment section content with random char&quot;</span> <span class="token operator">%</span> TotalRandomTime<span class="token punctuation">)</span>

ContentCharNum <span class="token operator">=</span> commentSection<span class="token punctuation">.</span>size
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ContentCharNum=&quot;</span><span class="token punctuation">,</span> ContentCharNum<span class="token punctuation">)</span>

RamdonCharRange <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;RamdonCharRange=&quot;</span><span class="token punctuation">,</span> RamdonCharRange<span class="token punctuation">)</span>

<span class="token keyword">for</span> curRandomTimeIdx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>TotalRandomTime<span class="token punctuation">)</span><span class="token punctuation">:</span>
  curRandomTime <span class="token operator">=</span> curRandomTimeIdx <span class="token operator">+</span> <span class="token number">1</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;%s Random Time [%d] %s&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">,</span> curRandomTime<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token operator">*</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment"># randomCharList = random.sample(RamdonCharRange, 198)</span>

  randomCharList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> randomCharIdx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>ContentCharNum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    curRandomChar <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>RamdonCharRange<span class="token punctuation">)</span>
    randomCharList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>curRandomChar<span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;randomCharList=&quot;</span><span class="token punctuation">,</span> randomCharList<span class="token punctuation">)</span>

  <span class="token comment"># randomCharBytes = bytes(randomCharList)</span>
  randomStr <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>randomCharList<span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;randomStr=&quot;</span><span class="token punctuation">,</span> randomStr<span class="token punctuation">)</span>
  randomCharBytes <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>randomStr<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;randomCharBytes=&quot;</span><span class="token punctuation">,</span> randomCharBytes<span class="token punctuation">)</span>
  newContentBytes <span class="token operator">=</span> randomCharBytes

  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;before: commentSection.content=&quot;</span><span class="token punctuation">,</span> commentSection<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

  <span class="token comment"># num0 = 0x30</span>
  <span class="token comment"># print(&quot;commentSection contentType=&quot;, type(commentSection.content))</span>
  <span class="token comment"># newContentBytes = bytes([num0] * commentSection.size)</span>

  newContentMemoryView <span class="token operator">=</span> <span class="token builtin">memoryview</span><span class="token punctuation">(</span>newContentBytes<span class="token punctuation">)</span>
  <span class="token comment"># print(&quot;newContentMemoryView type=&quot;, type(newContentMemoryView))</span>
  commentSection<span class="token punctuation">.</span>content <span class="token operator">=</span> newContentMemoryView
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;after: commentSection.content=&quot;</span><span class="token punctuation">,</span> commentSection<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

  <span class="token comment"># outputElfFile = &quot;modifyElf/output/libtacker_arm64_v8a_changedComment.so&quot;</span>
  <span class="token comment"># outputElfFile = &quot;modifyElf/output/libtacker_arm64_v8a_changedComment_%d.so&quot; % curRandomTime</span>
  suffixNum <span class="token operator">=</span> OutputSuffixStartNum <span class="token operator">+</span> curRandomTime
  outputFileName <span class="token operator">=</span> <span class="token string">&quot;%s_changedComment_%d%s&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>pureFileName<span class="token punctuation">,</span> suffixNum<span class="token punctuation">,</span> fileExt<span class="token punctuation">)</span>
  outputElfFile <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>outputFoler<span class="token punctuation">,</span> outputFileName<span class="token punctuation">)</span>

  libtackerElf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>outputElfFile<span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Saved to&quot;</span><span class="token punctuation">,</span> outputElfFile<span class="token punctuation">)</span>
</code></pre>
<ul>
<li>输出log日志</li>
</ul>
<pre class="language-"><code class="lang-bash">Loaded file:  modifyElf/input/libtacker_arm64_v8a.so
<span class="token assign-left variable">header</span><span class="token operator">=</span> Magic:                           7f <span class="token number">45</span> 4c <span class="token number">46</span> 
Class:                           CLASS64
Endianness:                      LSB
Version:                         CURRENT
OS/ABI:                          SYSTEMV
ABI Version:                     <span class="token number">0</span>
Machine type:                    AARCH64
File type:                       DYNAMIC
Object <span class="token function">file</span> version:             CURRENT
Entry Point:                     0x1a5c0
Program header offset:           0x40
Section header offset:           <span class="token number">848344</span>
Processor Flag:                  <span class="token number">0</span> 
Header size:                     <span class="token number">64</span>
Size of program header:          <span class="token number">56</span>
Number of program header:        <span class="token number">9</span>
Size of section header:          <span class="token number">64</span>
Number of section headers:       <span class="token number">27</span>
Section Name Table idx:          <span class="token number">26</span>


<span class="token assign-left variable">imported_functions</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>lief._lief.Function object at 0x104876f7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487723<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487737<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048772f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048a99b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10496723<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049668f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487cc3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487cbb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487cc7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487ccf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487ccb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10497a7f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a45bf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a47c3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a474b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a4447<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049fd8b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049fcab<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7d6f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7ffb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7fbf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7fb7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7ebb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7f5b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7efb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7c7f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048e16b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048e21f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10492bd7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104929cf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a1443<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a166f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049d86f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049db6f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10495c6f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10495f1f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10495ebb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a218b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a211f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048f98f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049c20b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048cfeb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10489037<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104890f7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a0f03<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token punctuation">]</span>
<span class="token assign-left variable">exported_functions</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>lief._lief.Function object at 0x104876f7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487723<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487737<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048772f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048a99b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10496723<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049668f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487cc3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487cbb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487cc7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487ccf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10487ccb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10497a7f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a45bf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a47c3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a474b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a4447<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049fd8b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049fcab<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7d6f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7ffb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7fbf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7fb7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7ebb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7f5b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7efb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a7c7f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048e16b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048e21f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10492bd7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104929cf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a1443<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a166f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049d86f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049db6f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10495c6f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10495f1f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10495ebb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a218b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a211f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048f98f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049c20b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048cfeb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10489037<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104890f7<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a0f03<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a0db3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10489677<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049144b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048e553<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1048ac73<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049a4ef<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x1049a567<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10488b1b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x10499357<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104993fb<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104992f3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a900f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a9013<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a9017<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a901b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a901f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a9023<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a9027<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a902b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a902f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a9033<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a9037<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a903b<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>lief._lief.Function object at 0x104a903f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token punctuation">]</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> 
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">0</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">0</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .note.android.ident
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">152</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">152</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .note.gnu.build-id
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">36</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">36</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .dynsym
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">2832</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">2832</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .gnu.version
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">236</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">236</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .gnu.version_r
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">64</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">64</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .gnu.hash
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">492</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">492</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .hash
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">952</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">952</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .dynstr
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">3097</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">3097</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .rela.dyn
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">34896</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">34896</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .rela.plt
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">1104</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">1104</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .gcc_except_table
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">6496</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">6496</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .rodata
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">13364</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">13364</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .eh_frame_hdr
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">7612</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">7612</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .eh_frame
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">36052</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">36052</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .text
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">715872</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">715872</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .plt
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">768</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">768</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .data.rel.ro
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">11960</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">11960</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .fini_array
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">16</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">16</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .init_array
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">560</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">560</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .dynamic
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">464</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">464</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .got
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">192</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">192</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .got.plt
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">392</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">392</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .data
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">9688</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">9688</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .bss
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">2768</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">0</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .comment
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">198</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">198</span>
--------------------
<span class="token assign-left variable">name</span><span class="token operator">=</span> .shstrtab
<span class="token assign-left variable">size</span><span class="token operator">=</span> <span class="token number">260</span>
<span class="token assign-left variable">contentLen</span><span class="token operator">=</span> <span class="token number">260</span>
before: <span class="token assign-left variable">commentSection.content</span><span class="token operator">=</span> <span class="token operator">&lt;</span>memory at 0x1049b548<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
commentSection <span class="token assign-left variable">contentType</span><span class="token operator">=</span> <span class="token operator">&lt;</span>class <span class="token string">&apos;memoryview&apos;</span><span class="token operator">&gt;</span>
newContentMemoryView <span class="token assign-left variable">type</span><span class="token operator">=</span> <span class="token operator">&lt;</span>class <span class="token string">&apos;memoryview&apos;</span><span class="token operator">&gt;</span>
after: <span class="token assign-left variable">commentSection.content</span><span class="token operator">=</span> <span class="token operator">&lt;</span>memory at 0x1049b554<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
Saved to modifyElf/output/libtacker_arm64_v8a_changedComment.so
</code></pre>
<ul>
<li>输出文件：（一次性的批量的多个）修改后的ELF文件：</li>
</ul>
<p><img src="../../../../assets/img/elf_lief_changed_output_multi.jpg" alt="elf_lief_changed_output_multi"></p>
<h3 id="修改前后的内容对比"><a name="修改前后的内容对比" class="plugin-anchor" href="#修改前后的内容对比"><i class="fa fa-link" aria-hidden="true"></i></a>修改前后的内容对比</h3>
<p><img src="../../../../assets/img/elf_lief_changed_diff.jpg" alt="elf_lief_changed_diff"></p>
<ul>
<li><code>.comment</code>修改前：<pre class="language-"><code class="lang-bash">Contents of section .comment:
0000 4c696e6b 65723a20 4c4c4420 31342e30  Linker: LLD <span class="token number">14.0</span>
0010 2e310063 6c616e67 <span class="token number">20766572</span> 73696f6e  .1.clang version
0020 2031342e 302e3000 416e6472 6f696420   <span class="token number">14.0</span>.0.Android 
0030 <span class="token number">28383037</span> <span class="token number">35313738</span> 2c206261 <span class="token number">73656420</span>  <span class="token punctuation">(</span><span class="token number">8075178</span>, based 
0040 6f6e2072 <span class="token number">34333731</span> <span class="token number">31326229</span> 20636c61  on r437112b<span class="token punctuation">)</span> cla
0050 6e672076 <span class="token number">65727369</span> 6f6e2031 342e302e  ng version <span class="token number">14.0</span>.
0060 <span class="token number">31202868</span> <span class="token number">74747073</span> 3a2f2f61 6e64726f  <span class="token number">1</span> <span class="token punctuation">(</span>https://andro
0070 69642e67 6f6f676c 65736f75 7263652e  id.googlesource.
0080 636f6d2f 746f6f6c <span class="token number">63686169</span> 6e2f6c6c  com/toolchain/ll
0090 766d2d70 726f6a65 <span class="token number">63742038</span> <span class="token number">36373133</span>  vm-project <span class="token number">86713</span>
00a0 <span class="token number">34386238</span> <span class="token number">31623935</span> <span class="token number">66633630</span> <span class="token number">33353035</span>  48b81b95fc603505
00b0 <span class="token number">64666338</span> <span class="token number">38316234</span> <span class="token number">35313033</span> <span class="token number">62656531</span>  dfc881b45103bee1
00c0 <span class="token number">37333129</span> 0000                        <span class="token number">731</span><span class="token punctuation">)</span><span class="token punctuation">..</span>
</code></pre>
</li>
<li><code>.comment</code>修改后：<pre class="language-"><code class="lang-bash">Contents of section .comment:
0000 62464a30 <span class="token number">35487661</span> 384a3768 <span class="token number">42435237</span>  bFJ05Hva8J7hBCR7
0010 <span class="token number">76426449</span> <span class="token number">59784743</span> 524e4d54 33744c42  vBdIYxGCRNMT3tLB
0020 304d664d <span class="token number">36615353</span> <span class="token number">39493555</span> 7943464d  0MfM6aSS9I5UyCFM
0030 <span class="token number">63566348</span> 41376b76 <span class="token number">67427050</span> 4b4d4f35  cVcHA7kvgBpPKMO5
0040 <span class="token number">38503143</span> 72734d73 636e476b 6f684932  8P1CrsMscnGkohI2
0050 4561616e 72376c30 6861466c <span class="token number">53667858</span>  Eaanr7l0haFlSfxX
0060 6f66684b 3646594a <span class="token number">43656154</span> <span class="token number">77656849</span>  ofhK6FYJCeaTwehI
0070 <span class="token number">71766167</span> <span class="token number">67653570</span> <span class="token number">45627946</span> 576b4c45  qvagge5pEbyFWkLE
0080 4a747759 4c6f474a 38554d74 <span class="token number">71717749</span>  JtwYLoGJ8UMtqqwI
0090 37534a4b 7a526547 396d687a 3464544a  7SJKzReG9mhz4dTJ
00a0 <span class="token number">67787276</span> 6843555a <span class="token number">59596332</span> <span class="token number">50336836</span>  gxrvhCUZYYc2P3h6
00b0 615a3362 786c4444 526e7370 66556f54  aZ3bxlDDRnspfUoT
00c0 746e4573 <span class="token number">3152</span>                        tnEs1R
</code></pre>
</li>
</ul>
<footer class="page-footer"><span class="copyright">crifan.org，使用<a href="https://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank">署名4.0国际(CC BY 4.0)协议</a>发布 all right reserved，powered by Gitbook</span><span class="footer-modification">最后更新：
2023-10-04 17:00:10
</span></footer></body></html>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: ELF">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../../../../sub_books/" class="navigation navigation-next " aria-label="Next page: 子教程">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"libtacker.so","level":"1.5.2.1.3.1","depth":5,"next":{"title":"子教程","level":"1.6","depth":1,"path":"sub_books/README.md","ref":"sub_books/README.md","articles":[]},"previous":{"title":"ELF","level":"1.5.2.1.3","depth":4,"path":"related_tool/lief/usage_examples/parse_elf/README.md","ref":"related_tool/lief/usage_examples/parse_elf/README.md","articles":[{"title":"libtacker.so","level":"1.5.2.1.3.1","depth":5,"path":"related_tool/lief/usage_examples/parse_elf/libtacker_so.md","ref":"related_tool/lief/usage_examples/parse_elf/libtacker_so.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["theme-comscore","anchors","expandable-menu","-lunr","-search","search-plus","disqus","-highlight","prism","prism-themes","github-buttons","-splitter","splitter-nosessionbutcookie","-sharing","sharing-plus","tbfed-pagefooter","donate","sitemap-general","copy-code-button","callouts","toolbar-button"],"root":"./src","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"crifan.org，使用<a href='https://creativecommons.org/licenses/by/4.0/deed.zh'>署名4.0国际(CC BY 4.0)协议</a>发布","modify_label":"最后更新：","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"css":["prism-themes/themes/prism-atom-dark.css"]},"disqus":{"useIdentifier":false,"shortName":"crifan"},"callouts":{"showTypeInHeader":false},"toolbar-button":{"label":"下载PDF","url":"https://book.crifan.org/books/executable_file_format/pdf/executable_file_format.pdf","icon":"fa-file-pdf-o"},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"donate":{"title":"","button":"打赏","wechat":"https://www.crifan.org/files/res/crifan_com/crifan_wechat_pay.jpg","alipay":"https://www.crifan.org/files/res/crifan_com/crifan_alipay_pay.jpg","wechatText":"微信打赏给Crifan","alipayText":"支付宝打赏给Crifan"},"sitemap-general":{"prefix":"https://book.crifan.org/books/executable_file_format/website/"},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-comscore":{},"splitter-nosessionbutcookie":{},"prism-themes":{},"github-buttons":{"buttons":[{"repo":"executable_file_format","user":"crifan","type":"star","count":true,"size":"small"},{"user":"crifan","type":"follow","width":"120","count":false,"size":"small"}]},"expandable-menu":{},"copy-code-button":{},"sharing":{"qq":true,"all":["douban","facebook","google","instapaper","line","linkedin","messenger","pocket","qq","qzone","stumbleupon","twitter","viber","vk","weibo","whatsapp"],"douban":false,"facebook":true,"weibo":true,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":false,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"anchors":{},"search-plus":{}},"theme":"default","author":"Crifan Li <admin@crifan.com>","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"可执行文件格式","language":"zh-hans","links":{"sidebar":{"主页":"http://www.crifan.org"}},"gitbook":"*","description":"介绍常用的可执行文件格式，先是概览；然后是通用内容；接着介绍常见格式，包括早期通用的COFF、Windows的PE、Linux/Android的ELF、macOS/iOS的Mach-O，以及相关的工具，比如查看格式的file，和解析格式的LIEF，且给出具体用法实例，包括解析Mach-O、解析Android的OAT、解析ELF；以及相关子教程。"},"file":{"path":"related_tool/lief/usage_examples/parse_elf/libtacker_so.md","mtime":"2023-10-04T09:00:10.588Z","type":"markdown"},"gitbook":{"version":"4.0.7","time":"2023-10-07T15:42:14.817Z"},"basePath":"../../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../../../../gitbook/gitbook.js"></script>
    <script src="../../../../gitbook/theme.js"></script>
    
        
        <script src="../../../../gitbook/gitbook-plugin-expandable-menu/expandable-chapters.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-splitter-nosessionbutcookie/splitter.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-toolbar-button/plugin.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../../../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

